; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\bsp_periph.o --depend=.\rvmdk\bsp_periph.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\bsp_periph.crf ..\BSP\bsp_periph.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  BSP_PeriphClkFreqGet PROC
;;;109    
;;;110    CPU_INT32U  BSP_PeriphClkFreqGet (CPU_DATA  pwr_clk_id)
000000  b510              PUSH     {r4,lr}
;;;111    {
000002  4604              MOV      r4,r0
;;;112        CPU_INT32U  clk_freq;
;;;113        CPU_INT32U  clk_div;
;;;114    
;;;115    
;;;116        clk_freq = BSP_CPU_ClkFreq();
000004  f7fffffe          BL       BSP_CPU_ClkFreq
000008  4601              MOV      r1,r0
;;;117    
;;;118        switch (pwr_clk_id) {
;;;119            case BSP_PERIPH_ID_DMA1:
;;;120            case BSP_PERIPH_ID_DMA2:
;;;121            case BSP_PERIPH_ID_SRAM:
;;;122            case BSP_PERIPH_ID_FLITF:
;;;123            case BSP_PERIPH_ID_CRC:
;;;124            case BSP_PERIPH_ID_FSMC:
;;;125            case BSP_PERIPH_ID_SDIO:
;;;126                 return (clk_freq);
;;;127    
;;;128            case BSP_PERIPH_ID_AFIO:
;;;129            case BSP_PERIPH_ID_IOPA:
;;;130            case BSP_PERIPH_ID_IOPB:
;;;131            case BSP_PERIPH_ID_IOPC:
;;;132            case BSP_PERIPH_ID_IOPD:
;;;133            case BSP_PERIPH_ID_IOPE:
;;;134            case BSP_PERIPH_ID_IOPF:
;;;135            case BSP_PERIPH_ID_IOPG:
;;;136            case BSP_PERIPH_ID_ADC1:
;;;137            case BSP_PERIPH_ID_ADC2:
;;;138            case BSP_PERIPH_ID_TIM1:
;;;139            case BSP_PERIPH_ID_SPI1:
;;;140            case BSP_PERIPH_ID_TIM8:
;;;141            case BSP_PERIPH_ID_USART1:
;;;142            case BSP_PERIPH_ID_ADC3:
;;;143                 clk_div = (BSP_PERIPH_REG_RCC_CFGR & 0x00003800) >> 11;
00000a  4871              LDR      r0,|L1.464|
00000c  2c2f              CMP      r4,#0x2f              ;118
00000e  d01b              BEQ      |L1.72|
000010  dc21              BGT      |L1.86|
000012  2c24              CMP      r4,#0x24              ;118
000014  d018              BEQ      |L1.72|
000016  dc13              BGT      |L1.64|
000018  2c08              CMP      r4,#8                 ;118
00001a  d031              BEQ      |L1.128|
00001c  dc07              BGT      |L1.46|
00001e  2c07              CMP      r4,#7                 ;118
000020  d241              BCS      |L1.166|
000022  e8dff004          TBB      [pc,r4]               ;118
000026  2d2d              DCB      0x2d,0x2d
000028  2d402d40          DCB      0x2d,0x40,0x2d,0x40
00002c  2d00              DCB      0x2d,0x00
                  |L1.46|
00002e  2c0a              CMP      r4,#0xa               ;118
000030  d026              BEQ      |L1.128|
000032  2c20              CMP      r4,#0x20              ;118
000034  d008              BEQ      |L1.72|
000036  2c22              CMP      r4,#0x22              ;118
000038  d006              BEQ      |L1.72|
00003a  2c23              CMP      r4,#0x23              ;118
00003c  d133              BNE      |L1.166|
00003e  e003              B        |L1.72|
                  |L1.64|
000040  f1a40225          SUB      r2,r4,#0x25           ;118
000044  2a09              CMP      r2,#9                 ;118
000046  d82e              BHI      |L1.166|
                  |L1.72|
000048  6840              LDR      r0,[r0,#4]
00004a  f3c020c2          UBFX     r0,r0,#11,#3
;;;144                 if (clk_div < 4) {
00004e  2804              CMP      r0,#4
000050  d218              BCS      |L1.132|
;;;145                     return (clk_freq);
000052  4608              MOV      r0,r1
;;;146                 }
;;;147                 clk_div   = (clk_div - 3) << 1;
;;;148                 clk_freq /= clk_div;
;;;149                 return (clk_freq);
;;;150    
;;;151            case BSP_PERIPH_ID_TIM2:
;;;152            case BSP_PERIPH_ID_TIM3:
;;;153            case BSP_PERIPH_ID_TIM4:
;;;154            case BSP_PERIPH_ID_TIM5:
;;;155            case BSP_PERIPH_ID_TIM6:
;;;156            case BSP_PERIPH_ID_TIM7:
;;;157            case BSP_PERIPH_ID_WWDG:
;;;158            case BSP_PERIPH_ID_SPI2:
;;;159            case BSP_PERIPH_ID_SPI3:
;;;160            case BSP_PERIPH_ID_USART2:
;;;161            case BSP_PERIPH_ID_USART3:
;;;162            case BSP_PERIPH_ID_USART4:
;;;163            case BSP_PERIPH_ID_USART5:
;;;164            case BSP_PERIPH_ID_I2C1:
;;;165            case BSP_PERIPH_ID_I2C2:
;;;166            case BSP_PERIPH_ID_USB:
;;;167            case BSP_PERIPH_ID_CAN:
;;;168            case BSP_PERIPH_ID_BKP:
;;;169            case BSP_PERIPH_ID_PWR:
;;;170            case BSP_PERIPH_ID_DAC:
;;;171                 clk_div = (BSP_PERIPH_REG_RCC_CFGR & 0x00000700) >> 8;
;;;172                 if (clk_div < 4) {
;;;173                     return (clk_freq);
;;;174                 }
;;;175                 clk_div   = (clk_div - 3) << 1;
;;;176                 clk_freq /= clk_div;
;;;177                 return (clk_freq);
;;;178        }
;;;179    
;;;180        return ((CPU_INT32U)0);
;;;181    }
000054  bd10              POP      {r4,pc}
                  |L1.86|
000056  f1a40240          SUB      r2,r4,#0x40           ;118
00005a  2a1e              CMP      r2,#0x1e              ;118
00005c  d223              BCS      |L1.166|
00005e  e8dff002          TBB      [pc,r2]               ;118
000062  1616              DCB      0x16,0x16
000064  16161616          DCB      0x16,0x16,0x16,0x16
000068  22222222          DCB      0x22,0x22,0x22,0x22
00006c  22162222          DCB      0x22,0x16,0x22,0x22
000070  16162216          DCB      0x16,0x16,0x22,0x16
000074  16161616          DCB      0x16,0x16,0x16,0x16
000078  16162216          DCB      0x16,0x16,0x22,0x16
00007c  22161616          DCB      0x22,0x16,0x16,0x16
                  |L1.128|
000080  4608              MOV      r0,r1                 ;126
000082  bd10              POP      {r4,pc}
                  |L1.132|
000084  1ec0              SUBS     r0,r0,#3              ;147
000086  0040              LSLS     r0,r0,#1              ;147
000088  fbb1f0f0          UDIV     r0,r1,r0              ;148
00008c  bd10              POP      {r4,pc}
00008e  6840              LDR      r0,[r0,#4]            ;171
000090  f3c02002          UBFX     r0,r0,#8,#3           ;171
000094  2804              CMP      r0,#4                 ;172
000096  d201              BCS      |L1.156|
000098  4608              MOV      r0,r1                 ;173
00009a  bd10              POP      {r4,pc}
                  |L1.156|
00009c  1ec0              SUBS     r0,r0,#3              ;175
00009e  0040              LSLS     r0,r0,#1              ;175
0000a0  fbb1f0f0          UDIV     r0,r1,r0              ;176
0000a4  bd10              POP      {r4,pc}
                  |L1.166|
0000a6  2000              MOVS     r0,#0                 ;180
0000a8  bd10              POP      {r4,pc}
;;;182    
                          ENDP

                  BSP_PeriphEn PROC
;;;199    
;;;200    void  BSP_PeriphEn (CPU_DATA  pwr_clk_id)
0000aa  4949              LDR      r1,|L1.464|
;;;201    {
;;;202        switch (pwr_clk_id) {
;;;203            case BSP_PERIPH_ID_DMA1:
;;;204            case BSP_PERIPH_ID_DMA2:
;;;205            case BSP_PERIPH_ID_SRAM:
;;;206            case BSP_PERIPH_ID_FLITF:
;;;207            case BSP_PERIPH_ID_CRC:
;;;208            case BSP_PERIPH_ID_FSMC:
;;;209            case BSP_PERIPH_ID_SDIO:
;;;210                 BSP_PERIPH_REG_RCC_AHBENR |= DEF_BIT(pwr_clk_id);
0000ac  2301              MOVS     r3,#1
0000ae  282f              CMP      r0,#0x2f              ;202
0000b0  d01b              BEQ      |L1.234|
0000b2  dc21              BGT      |L1.248|
0000b4  2824              CMP      r0,#0x24              ;202
0000b6  d018              BEQ      |L1.234|
0000b8  dc13              BGT      |L1.226|
0000ba  2808              CMP      r0,#8                 ;202
0000bc  d031              BEQ      |L1.290|
0000be  dc07              BGT      |L1.208|
0000c0  2807              CMP      r0,#7                 ;202
0000c2  d218              BCS      |L1.246|
0000c4  e8dff000          TBB      [pc,r0]               ;202
0000c8  2d2d2d17          DCB      0x2d,0x2d,0x2d,0x17
0000cc  2d172d00          DCB      0x2d,0x17,0x2d,0x00
                  |L1.208|
0000d0  280a              CMP      r0,#0xa               ;202
0000d2  d026              BEQ      |L1.290|
0000d4  2820              CMP      r0,#0x20              ;202
0000d6  d008              BEQ      |L1.234|
0000d8  2822              CMP      r0,#0x22              ;202
0000da  d006              BEQ      |L1.234|
0000dc  2823              CMP      r0,#0x23              ;202
0000de  d10a              BNE      |L1.246|
0000e0  e003              B        |L1.234|
                  |L1.226|
0000e2  f1a00225          SUB      r2,r0,#0x25           ;202
0000e6  2a09              CMP      r2,#9                 ;202
0000e8  d805              BHI      |L1.246|
                  |L1.234|
;;;211                 break;
;;;212    
;;;213            case BSP_PERIPH_ID_AFIO:
;;;214            case BSP_PERIPH_ID_IOPA:
;;;215            case BSP_PERIPH_ID_IOPB:
;;;216            case BSP_PERIPH_ID_IOPC:
;;;217            case BSP_PERIPH_ID_IOPD:
;;;218            case BSP_PERIPH_ID_IOPE:
;;;219            case BSP_PERIPH_ID_IOPF:
;;;220            case BSP_PERIPH_ID_IOPG:
;;;221            case BSP_PERIPH_ID_ADC1:
;;;222            case BSP_PERIPH_ID_ADC2:
;;;223            case BSP_PERIPH_ID_TIM1:
;;;224            case BSP_PERIPH_ID_SPI1:
;;;225            case BSP_PERIPH_ID_TIM8:
;;;226            case BSP_PERIPH_ID_USART1:
;;;227            case BSP_PERIPH_ID_ADC3:
;;;228                 BSP_PERIPH_REG_RCC_APB2ENR |= DEF_BIT(pwr_clk_id - 32);
0000ea  698a              LDR      r2,[r1,#0x18]
0000ec  3820              SUBS     r0,r0,#0x20
0000ee  fa03f000          LSL      r0,r3,r0
0000f2  4310              ORRS     r0,r0,r2
0000f4  6188              STR      r0,[r1,#0x18]
                  |L1.246|
;;;229                 break;
;;;230    
;;;231            case BSP_PERIPH_ID_TIM2:
;;;232            case BSP_PERIPH_ID_TIM3:
;;;233            case BSP_PERIPH_ID_TIM4:
;;;234            case BSP_PERIPH_ID_TIM5:
;;;235            case BSP_PERIPH_ID_TIM6:
;;;236            case BSP_PERIPH_ID_TIM7:
;;;237            case BSP_PERIPH_ID_WWDG:
;;;238            case BSP_PERIPH_ID_SPI2:
;;;239            case BSP_PERIPH_ID_SPI3:
;;;240            case BSP_PERIPH_ID_USART2:
;;;241            case BSP_PERIPH_ID_USART3:
;;;242            case BSP_PERIPH_ID_USART4:
;;;243            case BSP_PERIPH_ID_USART5:
;;;244            case BSP_PERIPH_ID_I2C1:
;;;245            case BSP_PERIPH_ID_I2C2:
;;;246            case BSP_PERIPH_ID_USB:
;;;247            case BSP_PERIPH_ID_CAN:
;;;248            case BSP_PERIPH_ID_BKP:
;;;249            case BSP_PERIPH_ID_PWR:
;;;250            case BSP_PERIPH_ID_DAC:
;;;251                 BSP_PERIPH_REG_RCC_APB1ENR |= DEF_BIT(pwr_clk_id - 64);
;;;252                 break;
;;;253        }
;;;254    }
0000f6  4770              BX       lr
                  |L1.248|
0000f8  3840              SUBS     r0,r0,#0x40           ;202
0000fa  281e              CMP      r0,#0x1e              ;202
0000fc  d2fb              BCS      |L1.246|
0000fe  e8dff000          TBB      [pc,r0]               ;202
000102  1616              DCB      0x16,0x16
000104  16161616          DCB      0x16,0x16,0x16,0x16
000108  0f0f0f0f          DCB      0x0f,0x0f,0x0f,0x0f
00010c  0f160f0f          DCB      0x0f,0x16,0x0f,0x0f
000110  16160f16          DCB      0x16,0x16,0x0f,0x16
000114  16161616          DCB      0x16,0x16,0x16,0x16
000118  16160f16          DCB      0x16,0x16,0x0f,0x16
00011c  0f161616          DCB      0x0f,0x16,0x16,0x16
000120  e7e9              B        |L1.246|
                  |L1.290|
000122  694a              LDR      r2,[r1,#0x14]         ;210
000124  fa03f000          LSL      r0,r3,r0              ;210
000128  4310              ORRS     r0,r0,r2              ;210
00012a  6148              STR      r0,[r1,#0x14]         ;210
00012c  4770              BX       lr
00012e  69ca              LDR      r2,[r1,#0x1c]         ;251
000130  fa03f000          LSL      r0,r3,r0              ;251
000134  4310              ORRS     r0,r0,r2              ;251
000136  61c8              STR      r0,[r1,#0x1c]         ;251
000138  4770              BX       lr
;;;255    
                          ENDP

                  BSP_PeriphDis PROC
;;;272    
;;;273    void  BSP_PeriphDis (CPU_DATA  pwr_clk_id)
00013a  4925              LDR      r1,|L1.464|
;;;274    {
;;;275        switch (pwr_clk_id) {
;;;276            case BSP_PERIPH_ID_DMA1:
;;;277            case BSP_PERIPH_ID_DMA2:
;;;278            case BSP_PERIPH_ID_SRAM:
;;;279            case BSP_PERIPH_ID_FLITF:
;;;280            case BSP_PERIPH_ID_CRC:
;;;281            case BSP_PERIPH_ID_FSMC:
;;;282            case BSP_PERIPH_ID_SDIO:
;;;283                 BSP_PERIPH_REG_RCC_AHBENR &= ~DEF_BIT(pwr_clk_id);
00013c  2301              MOVS     r3,#1
00013e  282f              CMP      r0,#0x2f              ;275
000140  d01b              BEQ      |L1.378|
000142  dc22              BGT      |L1.394|
000144  2824              CMP      r0,#0x24              ;275
000146  d018              BEQ      |L1.378|
000148  dc13              BGT      |L1.370|
00014a  2808              CMP      r0,#8                 ;275
00014c  d032              BEQ      |L1.436|
00014e  dc07              BGT      |L1.352|
000150  2807              CMP      r0,#7                 ;275
000152  d219              BCS      |L1.392|
000154  e8dff000          TBB      [pc,r0]               ;275
000158  2e2e2e18          DCB      0x2e,0x2e,0x2e,0x18
00015c  2e182e00          DCB      0x2e,0x18,0x2e,0x00
                  |L1.352|
000160  280a              CMP      r0,#0xa               ;275
000162  d027              BEQ      |L1.436|
000164  2820              CMP      r0,#0x20              ;275
000166  d008              BEQ      |L1.378|
000168  2822              CMP      r0,#0x22              ;275
00016a  d006              BEQ      |L1.378|
00016c  2823              CMP      r0,#0x23              ;275
00016e  d10b              BNE      |L1.392|
000170  e003              B        |L1.378|
                  |L1.370|
000172  f1a00225          SUB      r2,r0,#0x25           ;275
000176  2a09              CMP      r2,#9                 ;275
000178  d806              BHI      |L1.392|
                  |L1.378|
;;;284                 break;
;;;285    
;;;286            case BSP_PERIPH_ID_AFIO:
;;;287            case BSP_PERIPH_ID_IOPA:
;;;288            case BSP_PERIPH_ID_IOPB:
;;;289            case BSP_PERIPH_ID_IOPC:
;;;290            case BSP_PERIPH_ID_IOPD:
;;;291            case BSP_PERIPH_ID_IOPE:
;;;292            case BSP_PERIPH_ID_IOPF:
;;;293            case BSP_PERIPH_ID_IOPG:
;;;294            case BSP_PERIPH_ID_ADC1:
;;;295            case BSP_PERIPH_ID_ADC2:
;;;296            case BSP_PERIPH_ID_TIM1:
;;;297            case BSP_PERIPH_ID_SPI1:
;;;298            case BSP_PERIPH_ID_TIM8:
;;;299            case BSP_PERIPH_ID_USART1:
;;;300            case BSP_PERIPH_ID_ADC3:
;;;301                 BSP_PERIPH_REG_RCC_APB2ENR &= ~DEF_BIT(pwr_clk_id - 32);
00017a  698a              LDR      r2,[r1,#0x18]
00017c  3820              SUBS     r0,r0,#0x20
00017e  fa03f000          LSL      r0,r3,r0
000182  ea220000          BIC      r0,r2,r0
000186  6188              STR      r0,[r1,#0x18]
                  |L1.392|
;;;302                 break;
;;;303    
;;;304            case BSP_PERIPH_ID_TIM2:
;;;305            case BSP_PERIPH_ID_TIM3:
;;;306            case BSP_PERIPH_ID_TIM4:
;;;307            case BSP_PERIPH_ID_TIM5:
;;;308            case BSP_PERIPH_ID_TIM6:
;;;309            case BSP_PERIPH_ID_TIM7:
;;;310            case BSP_PERIPH_ID_WWDG:
;;;311            case BSP_PERIPH_ID_SPI2:
;;;312            case BSP_PERIPH_ID_SPI3:
;;;313            case BSP_PERIPH_ID_USART2:
;;;314            case BSP_PERIPH_ID_USART3:
;;;315            case BSP_PERIPH_ID_USART4:
;;;316            case BSP_PERIPH_ID_USART5:
;;;317            case BSP_PERIPH_ID_I2C1:
;;;318            case BSP_PERIPH_ID_I2C2:
;;;319            case BSP_PERIPH_ID_USB:
;;;320            case BSP_PERIPH_ID_CAN:
;;;321            case BSP_PERIPH_ID_BKP:
;;;322            case BSP_PERIPH_ID_PWR:
;;;323            case BSP_PERIPH_ID_DAC:
;;;324                 BSP_PERIPH_REG_RCC_APB1ENR &= ~DEF_BIT(pwr_clk_id - 64);
;;;325                 break;
;;;326        }
;;;327    }
000188  4770              BX       lr
                  |L1.394|
00018a  3840              SUBS     r0,r0,#0x40           ;275
00018c  281e              CMP      r0,#0x1e              ;275
00018e  d2fb              BCS      |L1.392|
000190  e8dff000          TBB      [pc,r0]               ;275
000194  17171717          DCB      0x17,0x17,0x17,0x17
000198  17170f0f          DCB      0x17,0x17,0x0f,0x0f
00019c  0f0f0f17          DCB      0x0f,0x0f,0x0f,0x17
0001a0  0f0f1717          DCB      0x0f,0x0f,0x17,0x17
0001a4  0f171717          DCB      0x0f,0x17,0x17,0x17
0001a8  17171717          DCB      0x17,0x17,0x17,0x17
0001ac  0f170f17          DCB      0x0f,0x17,0x0f,0x17
0001b0  1717              DCB      0x17,0x17
0001b2  e7e9              B        |L1.392|
                  |L1.436|
0001b4  694a              LDR      r2,[r1,#0x14]         ;283
0001b6  fa03f000          LSL      r0,r3,r0              ;283
0001ba  ea220000          BIC      r0,r2,r0              ;283
0001be  6148              STR      r0,[r1,#0x14]         ;283
0001c0  4770              BX       lr
0001c2  69ca              LDR      r2,[r1,#0x1c]         ;324
0001c4  fa03f000          LSL      r0,r3,r0              ;324
0001c8  ea220000          BIC      r0,r2,r0              ;324
0001cc  61c8              STR      r0,[r1,#0x1c]         ;324
0001ce  4770              BX       lr
                          ENDP

                  |L1.464|
                          DCD      0x40021000
