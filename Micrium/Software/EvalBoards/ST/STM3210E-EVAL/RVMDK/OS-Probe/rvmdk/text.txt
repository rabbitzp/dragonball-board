; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\text.o --depend=.\rvmdk\text.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\text.crf ..\..\..\..\..\uCGUI\GUI\Widget\TEXT.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  _FreeAttached PROC
;;;79     */
;;;80     static void _FreeAttached(TEXT_Obj* pObj) {
000000  3038              ADDS     r0,r0,#0x38
;;;81       GUI_ALLOC_FreePtr(&pObj->hpText);
000002  f7ffbffe          B.W      GUI_ALLOC_FreePtr
;;;82     }
;;;83     
                          ENDP

                  _Paint PROC
;;;87     */
;;;88     static void _Paint(TEXT_Handle hObj, TEXT_Obj* pObj) {
000006  b530              PUSH     {r4,r5,lr}
000008  b083              SUB      sp,sp,#0xc
00000a  4605              MOV      r5,r0
00000c  460c              MOV      r4,r1
;;;89       const char * s;
;;;90       GUI_RECT Rect;
;;;91       GUI_USE_PARA(hObj);
;;;92       LCD_SetColor(pObj->Props.TextColor);
00000e  6ae0              LDR      r0,[r4,#0x2c]
000010  f7fffffe          BL       LCD_SetColor
;;;93       GUI_SetFont    (pObj->Props.pFont);
000014  6aa0              LDR      r0,[r4,#0x28]
000016  f7fffffe          BL       GUI_SetFont
;;;94       /* Fill with parents background color */
;;;95       #if !TEXT_SUPPORT_TRANSPARENCY   /* Not needed any more, since window is transparent*/
;;;96         if (pObj->Props.BkColor == GUI_INVALID_COLOR) {
;;;97           LCD_SetBkColor(WIDGET__GetBkColor(hObj));
;;;98         } else {
;;;99           LCD_SetBkColor(pObj->Props.BkColor);
;;;100        }
;;;101        GUI_Clear();
;;;102      #else
;;;103        if (!WM_GetHasTrans(hObj)) {
00001a  4628              MOV      r0,r5
00001c  f7fffffe          BL       WM_GetHasTrans
000020  b920              CBNZ     r0,|L1.44|
;;;104          LCD_SetBkColor(pObj->Props.BkColor);
000022  6b20              LDR      r0,[r4,#0x30]
000024  f7fffffe          BL       LCD_SetBkColor
;;;105          GUI_Clear();
000028  f7fffffe          BL       GUI_Clear
                  |L1.44|
;;;106        }
;;;107      #endif
;;;108      /* Show the text */
;;;109      if (pObj->hpText) {
00002c  f9b40038          LDRSH    r0,[r4,#0x38]
000030  2800              CMP      r0,#0
000032  d010              BEQ      |L1.86|
;;;110        s = (const char*) GUI_ALLOC_h2p(pObj->hpText);
000034  f7fffffe          BL       GUI_ALLOC_h2p
000038  4605              MOV      r5,r0
;;;111        GUI_SetTextMode(GUI_TM_TRANS);
00003a  2002              MOVS     r0,#2
00003c  f7fffffe          BL       GUI_SetTextMode
;;;112        WM_GetClientRect(&Rect);
000040  4668              MOV      r0,sp
000042  f7fffffe          BL       WM_GetClientRect
;;;113        GUI_DispStringInRectWrap(s, &Rect, pObj->Align, pObj->Props.WrapMode);
000046  f8943034          LDRB     r3,[r4,#0x34]
00004a  f9b4203a          LDRSH    r2,[r4,#0x3a]
00004e  4669              MOV      r1,sp
000050  4628              MOV      r0,r5
000052  f7fffffe          BL       GUI_DispStringInRectWrap
                  |L1.86|
;;;114      }
;;;115    }
000056  b003              ADD      sp,sp,#0xc
000058  bd30              POP      {r4,r5,pc}
;;;116    
                          ENDP

                  _Delete PROC
;;;120    */
;;;121    static void _Delete(TEXT_Obj* pObj) {
00005a  e7fe              B        _FreeAttached
;;;122      /* Delete attached objects (if any) */
;;;123      GUI_DEBUG_LOG("TEXT: Delete() Deleting attached items");
;;;124      _FreeAttached(pObj);
;;;125    }
;;;126    
                          ENDP

                  TEXT_Callback PROC
;;;159    */
;;;160    void TEXT_Callback (WM_MESSAGE*pMsg) {
00005c  b570              PUSH     {r4-r6,lr}
00005e  4604              MOV      r4,r0
;;;161      TEXT_Handle hObj;
;;;162      TEXT_Obj * pObj;
;;;163      hObj = pMsg->hWin;
000060  f9b45004          LDRSH    r5,[r4,#4]
;;;164      pObj = (TEXT_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
000064  4628              MOV      r0,r5
000066  f7fffffe          BL       GUI_ALLOC_h2p
00006a  4606              MOV      r6,r0
;;;165      /* Let widget handle the standard messages */
;;;166      if (WIDGET_HandleActive(hObj, pMsg) == 0) {
00006c  4621              MOV      r1,r4
00006e  4628              MOV      r0,r5
000070  f7fffffe          BL       WIDGET_HandleActive
000074  2800              CMP      r0,#0
000076  d011              BEQ      |L1.156|
;;;167        return;
;;;168      }
;;;169      switch (pMsg->MsgId) {
000078  6820              LDR      r0,[r4,#0]
00007a  280b              CMP      r0,#0xb
00007c  d006              BEQ      |L1.140|
00007e  280f              CMP      r0,#0xf
000080  d107              BNE      |L1.146|
;;;170      case WM_PAINT:
;;;171        GUI_DEBUG_LOG("TEXT: _Callback(WM_PAINT)\n");
;;;172        _Paint(hObj, pObj);
000082  4631              MOV      r1,r6
000084  4628              MOV      r0,r5
000086  e8bd4070          POP      {r4-r6,lr}
00008a  e7fe              B        _Paint
                  |L1.140|
;;;173        return;
;;;174      case WM_DELETE:
;;;175        GUI_DEBUG_LOG("TEXT: _Callback(WM_DELETE)\n");
;;;176        _Delete(pObj);
00008c  4630              MOV      r0,r6
00008e  f7fffffe          BL       _Delete
                  |L1.146|
;;;177        break;       /* No return here ... WM_DefaultProc needs to be called */
;;;178      }
;;;179      WM_DefaultProc(pMsg);
000092  4620              MOV      r0,r4
000094  e8bd4070          POP      {r4-r6,lr}
000098  f7ffbffe          B.W      WM_DefaultProc
                  |L1.156|
;;;180    }
00009c  bd70              POP      {r4-r6,pc}
;;;181    
                          ENDP

                  TEXT_CreateEx PROC
;;;195    */
;;;196    TEXT_Handle TEXT_CreateEx(int x0, int y0, int xsize, int ysize, WM_HWIN hParent,
00009e  e92d4fff          PUSH     {r0-r11,lr}
;;;197                              int WinFlags, int ExFlags, int Id, const char* pText)
;;;198    {
0000a2  b085              SUB      sp,sp,#0x14
0000a4  4606              MOV      r6,r0
0000a6  f8dd9054          LDR      r9,[sp,#0x54]
0000aa  f8dd8050          LDR      r8,[sp,#0x50]
0000ae  9f16              LDR      r7,[sp,#0x58]
0000b0  9d12              LDR      r5,[sp,#0x48]
0000b2  9813              LDR      r0,[sp,#0x4c]
0000b4  468a              MOV      r10,r1
0000b6  4693              MOV      r11,r2
;;;199      TEXT_Handle hObj;
;;;200      /* Create the window */
;;;201      #if TEXT_SUPPORT_TRANSPARENCY
;;;202        WinFlags |= WM_CF_HASTRANS;
0000b8  f0400401          ORR      r4,r0,#1
;;;203      #endif
;;;204      WM_LOCK();
0000bc  f7fffffe          BL       GUI_Lock
;;;205      hObj = WM_CreateWindowAsChild(x0, y0, xsize, ysize, hParent, WinFlags, TEXT_Callback,
0000c0  231c              MOVS     r3,#0x1c
0000c2  f2af0267          ADR      r2,TEXT_Callback + 1
0000c6  b2a1              UXTH     r1,r4
0000c8  9303              STR      r3,[sp,#0xc]
0000ca  9202              STR      r2,[sp,#8]
0000cc  9101              STR      r1,[sp,#4]
0000ce  9500              STR      r5,[sp,#0]
0000d0  465a              MOV      r2,r11
0000d2  4651              MOV      r1,r10
0000d4  4630              MOV      r0,r6
0000d6  9b08              LDR      r3,[sp,#0x20]
0000d8  f7fffffe          BL       WM_CreateWindowAsChild
0000dc  4606              MOV      r6,r0
;;;206                                    sizeof(TEXT_Obj) - sizeof(WM_Obj));
;;;207      if (hObj) {
0000de  b32e              CBZ      r6,|L1.300|
;;;208        TEXT_Obj* pObj;
;;;209        WM_HMEM hMem = 0;
0000e0  2500              MOVS     r5,#0
;;;210        pObj = (TEXT_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
0000e2  4630              MOV      r0,r6
0000e4  f7fffffe          BL       GUI_ALLOC_h2p
0000e8  4604              MOV      r4,r0
;;;211        /* init widget specific variables */
;;;212        WIDGET__Init(&pObj->Widget, Id, 0);
0000ea  2200              MOVS     r2,#0
0000ec  4649              MOV      r1,r9
0000ee  4620              MOV      r0,r4
0000f0  f7fffffe          BL       WIDGET__Init
;;;213        /* init member variables */
;;;214        TEXT_INIT_ID(pObj);
;;;215        if (pText) {
0000f4  b177              CBZ      r7,|L1.276|
;;;216          hMem = GUI_ALLOC_AllocZero(strlen(pText) + 1);
0000f6  4638              MOV      r0,r7
0000f8  f7fffffe          BL       strlen
0000fc  1c40              ADDS     r0,r0,#1
0000fe  b200              SXTH     r0,r0
000100  f7fffffe          BL       GUI_ALLOC_AllocZero
000104  4605              MOV      r5,r0
;;;217          if (hMem) {
000106  b12d              CBZ      r5,|L1.276|
;;;218            strcpy((char*) GUI_ALLOC_h2p(hMem), pText);
000108  4628              MOV      r0,r5
00010a  f7fffffe          BL       GUI_ALLOC_h2p
00010e  4639              MOV      r1,r7
000110  f7fffffe          BL       strcpy
                  |L1.276|
;;;219          }
;;;220        }
;;;221        pObj->hpText = hMem;
000114  8725              STRH     r5,[r4,#0x38]
;;;222        pObj->Align  = ExFlags;
000116  f8a4803a          STRH     r8,[r4,#0x3a]
;;;223        pObj->Props  = TEXT__DefaultProps;
00011a  4807              LDR      r0,|L1.312|
00011c  6883              LDR      r3,[r0,#8]  ; TEXT__DefaultProps
00011e  6842              LDR      r2,[r0,#4]  ; TEXT__DefaultProps
000120  6801              LDR      r1,[r0,#0]  ; TEXT__DefaultProps
000122  68c0              LDR      r0,[r0,#0xc]  ; TEXT__DefaultProps
000124  6323              STR      r3,[r4,#0x30]
000126  62e2              STR      r2,[r4,#0x2c]
000128  62a1              STR      r1,[r4,#0x28]
00012a  6360              STR      r0,[r4,#0x34]
                  |L1.300|
;;;224      } else {
;;;225        GUI_DEBUG_ERROROUT_IF(hObj==0, "TEXT_Create failed")
;;;226      }
;;;227      WM_UNLOCK();
00012c  f7fffffe          BL       GUI_Unlock
;;;228      return hObj;
;;;229    }
000130  b009              ADD      sp,sp,#0x24
000132  4630              MOV      r0,r6                 ;228
000134  e8bd8ff0          POP      {r4-r11,pc}
;;;230    
                          ENDP

                  |L1.312|
                          DCD      ||.data||

                          AREA ||.data||, DATA, ALIGN=2

                  TEXT__DefaultProps
                          DCD      GUI_Font13_1
                          DCD      0x00000000
                          DCD      0x0fffffff
00000c  00000000          DCB      0x00,0x00,0x00,0x00
