; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\wm_setcapturemove.o --depend=.\rvmdk\wm_setcapturemove.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\wm_setcapturemove.crf ..\..\..\..\..\uCGUI\GUI\WM\WM_SetCaptureMove.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  WM_SetCaptureMove PROC
;;;41     */
;;;42     void WM_SetCaptureMove(WM_HWIN hWin, const GUI_PID_STATE* pState, int MinVisibility, int LimitTop) {
000000  e92d43f0          PUSH     {r4-r9,lr}
000004  b085              SUB      sp,sp,#0x14
000006  4681              MOV      r9,r0
000008  460c              MOV      r4,r1
00000a  4617              MOV      r7,r2
00000c  461d              MOV      r5,r3
;;;43       if (!WM_HasCaptured(hWin)) {
00000e  4648              MOV      r0,r9
000010  f7fffffe          BL       WM_HasCaptured
;;;44         WM_SetCapture(hWin, 1);        /* Set capture with auto release */
;;;45         WM__CapturePoint.x = pState->x;
000014  4e25              LDR      r6,|L1.172|
000016  b3a0              CBZ      r0,|L1.130|
;;;46         WM__CapturePoint.y = pState->y;
;;;47       } else {                         /* Moving ... let the window move ! */
;;;48         int dx, dy;
;;;49         dx = pState->x - WM__CapturePoint.x;
000018  f9b61000          LDRSH    r1,[r6,#0]  ; WM__CapturePoint
00001c  6820              LDR      r0,[r4,#0]
00001e  eba00801          SUB      r8,r0,r1
;;;50         dy = pState->y - WM__CapturePoint.y;
000022  f9b61002          LDRSH    r1,[r6,#2]  ; WM__CapturePoint
000026  6860              LDR      r0,[r4,#4]
000028  1a44              SUBS     r4,r0,r1
;;;51         /* Make sure at least a part of the windows stays inside of its parent */
;;;52         if ((MinVisibility == 0) && (LimitTop == 0)) {
00002a  ea570005          ORRS     r0,r7,r5
00002e  d034              BEQ      |L1.154|
;;;53           WM_MoveWindow(hWin, dx, dy);
;;;54         } else {
;;;55           GUI_RECT Rect, RectParent;
;;;56           WM_GetWindowRectEx(hWin, &Rect);
000030  a902              ADD      r1,sp,#8
000032  4648              MOV      r0,r9
000034  f7fffffe          BL       WM_GetWindowRectEx
;;;57           /* Check if the top region of the window should be limited */
;;;58           if (LimitTop) {
000038  b12d              CBZ      r5,|L1.70|
;;;59             Rect.y1 = Rect.y0 + LimitTop - 1;
00003a  f8bd000a          LDRH     r0,[sp,#0xa]
00003e  1e69              SUBS     r1,r5,#1
000040  4408              ADD      r0,r0,r1
000042  f8ad000e          STRH     r0,[sp,#0xe]
                  |L1.70|
;;;60           }
;;;61           WM_GetWindowRectEx(WM_GetParent(hWin), &RectParent);
000046  4648              MOV      r0,r9
000048  f7fffffe          BL       WM_GetParent
00004c  4669              MOV      r1,sp
00004e  f7fffffe          BL       WM_GetWindowRectEx
;;;62           GUI_MoveRect(&Rect, dx, dy);
000052  4622              MOV      r2,r4
000054  4641              MOV      r1,r8
000056  a802              ADD      r0,sp,#8
000058  f7fffffe          BL       GUI_MoveRect
;;;63           GUI__ReduceRect(&RectParent, &RectParent, MinVisibility);
00005c  463a              MOV      r2,r7
00005e  4669              MOV      r1,sp
000060  4668              MOV      r0,sp
000062  f7fffffe          BL       GUI__ReduceRect
;;;64           if (GUI_RectsIntersect(&Rect, &RectParent)) {
000066  4669              MOV      r1,sp
000068  a802              ADD      r0,sp,#8
00006a  f7fffffe          BL       GUI_RectsIntersect
00006e  2800              CMP      r0,#0
000070  d004              BEQ      |L1.124|
;;;65             WM_MoveWindow(hWin, dx, dy);
000072  4622              MOV      r2,r4
000074  4641              MOV      r1,r8
000076  4648              MOV      r0,r9
000078  f7fffffe          BL       WM_MoveWindow
                  |L1.124|
;;;66           }
;;;67         }
;;;68       }
;;;69     }
00007c  b005              ADD      sp,sp,#0x14
00007e  e8bd83f0          POP      {r4-r9,pc}
                  |L1.130|
000082  e7ff              B        |L1.132|
                  |L1.132|
000084  2101              MOVS     r1,#1                 ;44
000086  4648              MOV      r0,r9                 ;44
000088  f7fffffe          BL       WM_SetCapture
00008c  6820              LDR      r0,[r4,#0]            ;45
00008e  8030              STRH     r0,[r6,#0]            ;45
000090  6860              LDR      r0,[r4,#4]            ;46
000092  8070              STRH     r0,[r6,#2]            ;46
000094  b005              ADD      sp,sp,#0x14
000096  e8bd83f0          POP      {r4-r9,pc}
                  |L1.154|
00009a  b005              ADD      sp,sp,#0x14           ;53
00009c  4622              MOV      r2,r4                 ;53
00009e  4641              MOV      r1,r8                 ;53
0000a0  4648              MOV      r0,r9                 ;53
0000a2  e8bd43f0          POP      {r4-r9,lr}            ;53
0000a6  f7ffbffe          B.W      WM_MoveWindow
;;;70     
                          ENDP

0000aa  0000              DCW      0x0000
                  |L1.172|
                          DCD      ||.data||

                          AREA ||.data||, DATA, ALIGN=1

                  WM__CapturePoint
                          DCDU     0x00000000
