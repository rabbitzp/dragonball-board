; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\dropdown.o --depend=.\rvmdk\dropdown.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\dropdown.crf ..\..\..\..\..\uCGUI\GUI\Widget\DROPDOWN.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  DROPDOWN__GetNumItems PROC
;;;137    */
;;;138    int DROPDOWN__GetNumItems(DROPDOWN_Obj* pObj) {
000000  8dc0              LDRH     r0,[r0,#0x2e]
;;;139      return pObj->Handles.NumItems;
;;;140    }
000002  4770              BX       lr
;;;141    
                          ENDP

                  _GethItem PROC
;;;148    */
;;;149    static WM_HMEM _GethItem(DROPDOWN_Obj* pObj, int Index) {
000004  302e              ADDS     r0,r0,#0x2e
;;;150      return GUI_ARRAY_GethItem(&pObj->Handles, Index);
000006  f7ffbffe          B.W      GUI_ARRAY_GethItem
;;;151    }
;;;152    
                          ENDP

                  _DrawTriangleDown PROC
;;;156    */
;;;157    static void _DrawTriangleDown(int x, int y, int Size) {
00000a  b570              PUSH     {r4-r6,lr}
00000c  4606              MOV      r6,r0
00000e  460d              MOV      r5,r1
000010  4614              MOV      r4,r2
;;;158      for (; Size >= 0; Size--, y++ ) {
000012  2c00              CMP      r4,#0
000014  db08              BLT      |L1.40|
                  |L1.22|
;;;159        GUI_DrawHLine(y, x - Size, x + Size);
000016  1932              ADDS     r2,r6,r4
000018  1b31              SUBS     r1,r6,r4
00001a  4628              MOV      r0,r5
00001c  f7fffffe          BL       GUI_DrawHLine
000020  1e64              SUBS     r4,r4,#1              ;158
000022  1c6d              ADDS     r5,r5,#1              ;158
000024  2c00              CMP      r4,#0                 ;158
000026  daf6              BGE      |L1.22|
                  |L1.40|
;;;160      }
;;;161    }
000028  bd70              POP      {r4-r6,pc}
;;;162    /*********************************************************************
                          ENDP

                  _GetpItem PROC
;;;168    */
;;;169    static const char* _GetpItem(DROPDOWN_Obj* pObj, int Index) {
00002a  b510              PUSH     {r4,lr}
;;;170      const char* s = NULL;
00002c  2400              MOVS     r4,#0
;;;171      WM_HMEM h = _GethItem(pObj, Index);
00002e  f7fffffe          BL       _GethItem
;;;172      if (h) {
000032  b110              CBZ      r0,|L1.58|
;;;173        s = (const char*) GUI_ALLOC_h2p(h);
000034  f7fffffe          BL       GUI_ALLOC_h2p
000038  4604              MOV      r4,r0
                  |L1.58|
;;;174      }
;;;175      return s;
00003a  4620              MOV      r0,r4
;;;176    }
00003c  bd10              POP      {r4,pc}
;;;177    
                          ENDP

                  _Tolower PROC
;;;181    */
;;;182    static int _Tolower(int Key) {
00003e  f1a00141          SUB      r1,r0,#0x41
;;;183      if ((Key >= 0x41) && (Key <= 0x5a)) {
000042  2919              CMP      r1,#0x19
000044  d800              BHI      |L1.72|
;;;184        Key += 0x20;
000046  3020              ADDS     r0,r0,#0x20
                  |L1.72|
;;;185      }
;;;186      return Key;
;;;187    }
000048  4770              BX       lr
;;;188    
                          ENDP

                  DROPDOWN_SetSel PROC
;;;552    */
;;;553    void DROPDOWN_SetSel(DROPDOWN_Handle hObj, int Sel) {
00004a  b570              PUSH     {r4-r6,lr}
00004c  4605              MOV      r5,r0
00004e  460c              MOV      r4,r1
;;;554      int NumItems, MaxSel;
;;;555      DROPDOWN_Obj* pObj;
;;;556      if (hObj) {
000050  2d00              CMP      r5,#0
000052  d01f              BEQ      |L1.148|
;;;557        WM_LOCK();
000054  f7fffffe          BL       GUI_Lock
;;;558        pObj = DROPDOWN_H2P(hObj);
000058  4628              MOV      r0,r5
00005a  f7fffffe          BL       GUI_ALLOC_h2p
00005e  4602              MOV      r2,r0
;;;559        NumItems = DROPDOWN__GetNumItems(pObj);
000060  4610              MOV      r0,r2
000062  f7fffffe          BL       DROPDOWN__GetNumItems
;;;560        MaxSel = NumItems ? NumItems-1 : 0;
000066  b108              CBZ      r0,|L1.108|
000068  1e41              SUBS     r1,r0,#1
00006a  e000              B        |L1.110|
                  |L1.108|
00006c  2100              MOVS     r1,#0
                  |L1.110|
;;;561        if (Sel > MaxSel) {
00006e  428c              CMP      r4,r1
000070  dd00              BLE      |L1.116|
;;;562          Sel = MaxSel;
000072  460c              MOV      r4,r1
                  |L1.116|
;;;563        }
;;;564        if (Sel != pObj->Sel) {
000074  f9b20028          LDRSH    r0,[r2,#0x28]
000078  42a0              CMP      r0,r4
00007a  d007              BEQ      |L1.140|
;;;565          pObj->Sel = Sel;
00007c  8514              STRH     r4,[r2,#0x28]
;;;566          DROPDOWN_Invalidate(hObj);
00007e  4628              MOV      r0,r5
000080  f7fffffe          BL       WM_InvalidateWindow
;;;567          WM_NotifyParent(hObj, WM_NOTIFICATION_SEL_CHANGED);
000084  2104              MOVS     r1,#4
000086  4628              MOV      r0,r5
000088  f7fffffe          BL       WM_NotifyParent
                  |L1.140|
;;;568        }
;;;569        WM_UNLOCK();
00008c  e8bd4070          POP      {r4-r6,lr}
000090  f7ffbffe          B.W      GUI_Unlock
                  |L1.148|
;;;570      }
;;;571    }
000094  bd70              POP      {r4-r6,pc}
;;;572    
                          ENDP

                  _SelectByKey PROC
;;;192    */
;;;193    static void _SelectByKey(DROPDOWN_Handle hObj, int Key) {
000096  e92d41f0          PUSH     {r4-r8,lr}
00009a  4606              MOV      r6,r0
00009c  460c              MOV      r4,r1
;;;194      int i;
;;;195      DROPDOWN_Obj* pObj;
;;;196      pObj = DROPDOWN_H2P(hObj);
00009e  4630              MOV      r0,r6
0000a0  f7fffffe          BL       GUI_ALLOC_h2p
0000a4  4607              MOV      r7,r0
;;;197      Key = _Tolower(Key);
0000a6  4620              MOV      r0,r4
0000a8  f7fffffe          BL       _Tolower
0000ac  4605              MOV      r5,r0
;;;198      for (i = 0; i < DROPDOWN__GetNumItems(pObj); i++) {
0000ae  2400              MOVS     r4,#0
0000b0  4638              MOV      r0,r7
0000b2  f7fffffe          BL       DROPDOWN__GetNumItems
0000b6  2800              CMP      r0,#0
0000b8  dd14              BLE      |L1.228|
                  |L1.186|
;;;199        char c = _Tolower(*_GetpItem(pObj, i));
0000ba  4621              MOV      r1,r4
0000bc  4638              MOV      r0,r7
0000be  f7fffffe          BL       _GetpItem
0000c2  7800              LDRB     r0,[r0,#0]
0000c4  f7fffffe          BL       _Tolower
0000c8  b2c0              UXTB     r0,r0
;;;200        if (c == Key) {
0000ca  42a8              CMP      r0,r5
0000cc  d104              BNE      |L1.216|
;;;201          DROPDOWN_SetSel(hObj, i);
0000ce  4621              MOV      r1,r4
0000d0  4630              MOV      r0,r6
0000d2  e8bd41f0          POP      {r4-r8,lr}
0000d6  e7fe              B        DROPDOWN_SetSel
                  |L1.216|
0000d8  1c64              ADDS     r4,r4,#1              ;198
0000da  4638              MOV      r0,r7                 ;198
0000dc  f7fffffe          BL       DROPDOWN__GetNumItems
0000e0  42a0              CMP      r0,r4                 ;198
0000e2  dcea              BGT      |L1.186|
                  |L1.228|
;;;202          break;
;;;203        }
;;;204      }
;;;205    }
0000e4  e8bd81f0          POP      {r4-r8,pc}
;;;206    
                          ENDP

                  _FreeAttached PROC
;;;210    */
;;;211    static void _FreeAttached(DROPDOWN_Obj* pObj) {
0000e8  b510              PUSH     {r4,lr}
0000ea  4604              MOV      r4,r0
;;;212      GUI_ARRAY_Delete(&pObj->Handles);
0000ec  f104002e          ADD      r0,r4,#0x2e
0000f0  f7fffffe          BL       GUI_ARRAY_Delete
;;;213      WM_DeleteWindow(pObj->hListWin);
0000f4  f9b40074          LDRSH    r0,[r4,#0x74]
0000f8  e8bd4010          POP      {r4,lr}
0000fc  f7ffbffe          B.W      WM_DeleteWindow
;;;214    }
;;;215    
                          ENDP

                  _Paint PROC
;;;219    */
;;;220    static void _Paint(DROPDOWN_Handle hObj) {
000100  e92d43f0          PUSH     {r4-r9,lr}
000104  b083              SUB      sp,sp,#0xc
;;;221      int Border;
;;;222      GUI_RECT r;
;;;223      const char* s;
;;;224      int InnerSize, ColorIndex;
;;;225      DROPDOWN_Obj* pObj;
;;;226      int TextBorderSize;
;;;227      /* Do some initial calculations */
;;;228      pObj = DROPDOWN_H2P(hObj);
000106  f7fffffe          BL       GUI_ALLOC_h2p
00010a  4604              MOV      r4,r0
;;;229      Border = pObj->Widget.pEffect->EffectSize;
00010c  6a20              LDR      r0,[r4,#0x20]
00010e  f8d08014          LDR      r8,[r0,#0x14]
;;;230      TextBorderSize = pObj->Props.TextBorderSize;
000112  f9b46070          LDRSH    r6,[r4,#0x70]
;;;231      GUI_SetFont(pObj->Props.pFont);
000116  6c20              LDR      r0,[r4,#0x40]
000118  f7fffffe          BL       GUI_SetFont
;;;232      ColorIndex = (pObj->Widget.State & WIDGET_STATE_FOCUS) ? 2 : 1;
00011c  8ce0              LDRH     r0,[r4,#0x26]
00011e  f0100f01          TST      r0,#1
000122  d001              BEQ      |L1.296|
000124  2702              MOVS     r7,#2
000126  e000              B        |L1.298|
                  |L1.296|
000128  2701              MOVS     r7,#1
                  |L1.298|
;;;233      s = _GetpItem(pObj, pObj->Sel);
00012a  f9b41028          LDRSH    r1,[r4,#0x28]
00012e  4620              MOV      r0,r4
000130  f7fffffe          BL       _GetpItem
000134  4681              MOV      r9,r0
;;;234      WM_GetClientRect(&r);
000136  4668              MOV      r0,sp
000138  f7fffffe          BL       WM_GetClientRect
;;;235      GUI__ReduceRect(&r, &r, Border);
00013c  4642              MOV      r2,r8
00013e  4669              MOV      r1,sp
000140  4668              MOV      r0,sp
000142  f7fffffe          BL       GUI__ReduceRect
;;;236      InnerSize = r.y1 - r.y0 + 1;
000146  f8bd0006          LDRH     r0,[sp,#6]
00014a  f8bd1002          LDRH     r1,[sp,#2]
00014e  1a40              SUBS     r0,r0,r1
000150  1c45              ADDS     r5,r0,#1
;;;237      /* Draw the 3D effect (if configured) */
;;;238      WIDGET__EFFECT_DrawDown(&pObj->Widget);
000152  4620              MOV      r0,r4
000154  f7fffffe          BL       WIDGET__EFFECT_DrawDown
;;;239      /* Draw the outer text frames */
;;;240      r.x1 -= InnerSize;     /* Spare square area to the right */
000158  f8bd0004          LDRH     r0,[sp,#4]
00015c  1b40              SUBS     r0,r0,r5
00015e  f8ad0004          STRH     r0,[sp,#4]
;;;241      LCD_SetColor(pObj->Props.aBackColor[ColorIndex]);
000162  eb040787          ADD      r7,r4,r7,LSL #2
000166  6c78              LDR      r0,[r7,#0x44]
000168  f7fffffe          BL       LCD_SetColor
;;;242      /* Draw the text */
;;;243      LCD_SetBkColor(pObj->Props.aBackColor[ColorIndex]);
00016c  6c78              LDR      r0,[r7,#0x44]
00016e  f7fffffe          BL       LCD_SetBkColor
;;;244      GUI_FillRectEx(&r);
000172  4668              MOV      r0,sp
000174  f7fffffe          BL       GUI_FillRectEx
;;;245      r.x0 += TextBorderSize;
000178  f8bd0000          LDRH     r0,[sp,#0]
00017c  4430              ADD      r0,r0,r6
00017e  f8ad0000          STRH     r0,[sp,#0]
;;;246      r.x1 -= TextBorderSize;
000182  f8bd0004          LDRH     r0,[sp,#4]
000186  1b80              SUBS     r0,r0,r6
000188  f8ad0004          STRH     r0,[sp,#4]
;;;247      LCD_SetColor  (pObj->Props.aTextColor[ColorIndex]);
00018c  6d38              LDR      r0,[r7,#0x50]
00018e  f7fffffe          BL       LCD_SetColor
;;;248      GUI_DispStringInRect(s, &r, pObj->Props.Align);
000192  f9b42072          LDRSH    r2,[r4,#0x72]
000196  4669              MOV      r1,sp
000198  4648              MOV      r0,r9
00019a  f7fffffe          BL       GUI_DispStringInRect
;;;249      /* Draw arrow */
;;;250      WM_GetClientRect(&r);
00019e  4668              MOV      r0,sp
0001a0  f7fffffe          BL       WM_GetClientRect
;;;251      GUI__ReduceRect(&r, &r, Border);
0001a4  4642              MOV      r2,r8
0001a6  4669              MOV      r1,sp
0001a8  4668              MOV      r0,sp
0001aa  f7fffffe          BL       GUI__ReduceRect
;;;252      r.x0 = r.x1 + 1 - InnerSize;
0001ae  f8bd0004          LDRH     r0,[sp,#4]
0001b2  1b40              SUBS     r0,r0,r5
0001b4  1c40              ADDS     r0,r0,#1
0001b6  f8ad0000          STRH     r0,[sp,#0]
;;;253      LCD_SetColor(pObj->Props.aColor[DROPDOWN_CI_BUTTON]);
0001ba  6e20              LDR      r0,[r4,#0x60]
0001bc  f7fffffe          BL       LCD_SetColor
;;;254      GUI_FillRectEx(&r);
0001c0  4668              MOV      r0,sp
0001c2  f7fffffe          BL       GUI_FillRectEx
;;;255      LCD_SetColor(pObj->Props.aColor[DROPDOWN_CI_ARROW]);
0001c6  6de0              LDR      r0,[r4,#0x5c]
0001c8  f7fffffe          BL       LCD_SetColor
;;;256      _DrawTriangleDown((r.x1 + r.x0) / 2, r.y0 + 5, (r.y1 - r.y0 - 8) / 2);
0001cc  f9bd0004          LDRSH    r0,[sp,#4]
0001d0  f9bd1000          LDRSH    r1,[sp,#0]
0001d4  f9bd2006          LDRSH    r2,[sp,#6]
0001d8  4408              ADD      r0,r0,r1
0001da  f9bd1002          LDRSH    r1,[sp,#2]
0001de  eb0070d0          ADD      r0,r0,r0,LSR #31
0001e2  1a52              SUBS     r2,r2,r1
0001e4  3a08              SUBS     r2,r2,#8
0001e6  eb0272d2          ADD      r2,r2,r2,LSR #31
0001ea  1052              ASRS     r2,r2,#1
0001ec  1d49              ADDS     r1,r1,#5
0001ee  1040              ASRS     r0,r0,#1
0001f0  f7fffffe          BL       _DrawTriangleDown
;;;257      WIDGET__EFFECT_DrawUpRect(&pObj->Widget, &r);
0001f4  4669              MOV      r1,sp
0001f6  4620              MOV      r0,r4
0001f8  f7fffffe          BL       WIDGET__EFFECT_DrawUpRect
;;;258    }
0001fc  b003              ADD      sp,sp,#0xc
0001fe  e8bd83f0          POP      {r4-r9,pc}
;;;259    
                          ENDP

                  _OnTouch PROC
;;;263    */
;;;264    static int _OnTouch(DROPDOWN_Handle hObj, WM_MESSAGE*pMsg) {
000202  b510              PUSH     {r4,lr}
;;;265      const GUI_PID_STATE* pState = (const GUI_PID_STATE*)pMsg->Data.p;
000204  6889              LDR      r1,[r1,#8]
;;;266      if (pMsg->Data.p) {  /* Something happened in our area (pressed or released) */
000206  b149              CBZ      r1,|L1.540|
;;;267        if (pState->Pressed) {
000208  7a09              LDRB     r1,[r1,#8]
00020a  b119              CBZ      r1,|L1.532|
;;;268          WM_NotifyParent(hObj, WM_NOTIFICATION_CLICKED);
00020c  2101              MOVS     r1,#1
00020e  f7fffffe          BL       WM_NotifyParent
000212  e006              B        |L1.546|
                  |L1.532|
;;;269        } else {
;;;270          WM_NotifyParent(hObj, WM_NOTIFICATION_RELEASED);
000214  2102              MOVS     r1,#2
000216  f7fffffe          BL       WM_NotifyParent
00021a  e002              B        |L1.546|
                  |L1.540|
;;;271        }
;;;272      } else {     /* Mouse moved out */
;;;273        WM_NotifyParent(hObj, WM_NOTIFICATION_MOVED_OUT);
00021c  2103              MOVS     r1,#3
00021e  f7fffffe          BL       WM_NotifyParent
                  |L1.546|
;;;274      }
;;;275      return 0; /* Message handled */
000222  2000              MOVS     r0,#0
;;;276    }
000224  bd10              POP      {r4,pc}
;;;277    
                          ENDP

                  DROPDOWN__AdjustHeight PROC
;;;304    */
;;;305    void DROPDOWN__AdjustHeight(DROPDOWN_Handle hObj, DROPDOWN_Obj* pObj) {
000226  b570              PUSH     {r4-r6,lr}
000228  4606              MOV      r6,r0
00022a  460c              MOV      r4,r1
;;;306      int Height;
;;;307      Height = pObj->TextHeight;
00022c  f9b4002c          LDRSH    r0,[r4,#0x2c]
;;;308      if (!Height) {
000230  b910              CBNZ     r0,|L1.568|
;;;309        Height = GUI_GetYDistOfFont(pObj->Props.pFont);
000232  6c20              LDR      r0,[r4,#0x40]
000234  f7fffffe          BL       GUI_GetYDistOfFont
                  |L1.568|
;;;310      }
;;;311      Height += pObj->Widget.pEffect->EffectSize + 2 *  pObj->Props.TextBorderSize;
000238  6a21              LDR      r1,[r4,#0x20]
00023a  f9b42070          LDRSH    r2,[r4,#0x70]
00023e  6949              LDR      r1,[r1,#0x14]
000240  eb000042          ADD      r0,r0,r2,LSL #1
000244  180d              ADDS     r5,r1,r0
;;;312      WM_SetSize(hObj, WM__GetWindowSizeX(&pObj->Widget.Win), Height);
000246  4620              MOV      r0,r4
000248  f7fffffe          BL       WM__GetWindowSizeX
00024c  4601              MOV      r1,r0
00024e  462a              MOV      r2,r5
000250  4630              MOV      r0,r6
000252  e8bd4070          POP      {r4-r6,lr}
000256  f7ffbffe          B.W      WM_SetSize
;;;313    }
;;;314    
                          ENDP

                  DROPDOWN_GetSel PROC
;;;596    */
;;;597    int  DROPDOWN_GetSel (DROPDOWN_Handle hObj) {
00025a  b570              PUSH     {r4-r6,lr}
00025c  4605              MOV      r5,r0
;;;598      int r = 0;
00025e  2400              MOVS     r4,#0
;;;599      DROPDOWN_Obj* pObj;
;;;600      if (hObj) {
000260  b145              CBZ      r5,|L1.628|
;;;601        WM_LOCK();
000262  f7fffffe          BL       GUI_Lock
;;;602        pObj = DROPDOWN_H2P(hObj);
000266  4628              MOV      r0,r5
000268  f7fffffe          BL       GUI_ALLOC_h2p
;;;603        r = pObj->Sel;
00026c  f9b04028          LDRSH    r4,[r0,#0x28]
;;;604        WM_UNLOCK();
000270  f7fffffe          BL       GUI_Unlock
                  |L1.628|
;;;605      }
;;;606      return r;
000274  4620              MOV      r0,r4
;;;607    }
000276  bd70              POP      {r4-r6,pc}
;;;608    
                          ENDP

                  DROPDOWN_DecSel PROC
;;;585    */
;;;586    void DROPDOWN_DecSel(DROPDOWN_Handle hObj) {
000278  b510              PUSH     {r4,lr}
00027a  4604              MOV      r4,r0
;;;587      int Sel = DROPDOWN_GetSel(hObj);
00027c  4620              MOV      r0,r4
00027e  f7fffffe          BL       DROPDOWN_GetSel
000282  4601              MOV      r1,r0
;;;588      if (Sel)
000284  b101              CBZ      r1,|L1.648|
;;;589    	  Sel--;
000286  1e49              SUBS     r1,r1,#1
                  |L1.648|
;;;590      DROPDOWN_SetSel(hObj, Sel);
000288  4620              MOV      r0,r4
00028a  e8bd4010          POP      {r4,lr}
00028e  e7fe              B        DROPDOWN_SetSel
;;;591    }
;;;592    
                          ENDP

                  DROPDOWN_IncSel PROC
;;;576    */
;;;577    void DROPDOWN_IncSel(DROPDOWN_Handle hObj) {
000290  b510              PUSH     {r4,lr}
000292  4604              MOV      r4,r0
;;;578      int Sel = DROPDOWN_GetSel(hObj);
000294  4620              MOV      r0,r4
000296  f7fffffe          BL       DROPDOWN_GetSel
;;;579      DROPDOWN_SetSel(hObj, Sel+1);
00029a  1c41              ADDS     r1,r0,#1
00029c  4620              MOV      r0,r4
00029e  e8bd4010          POP      {r4,lr}
0002a2  e7fe              B        DROPDOWN_SetSel
;;;580    }
;;;581    
                          ENDP

                  DROPDOWN_AddKey PROC
;;;530    */
;;;531    void DROPDOWN_AddKey(DROPDOWN_Handle hObj, int Key) {
0002a4  b570              PUSH     {r4-r6,lr}
0002a6  4605              MOV      r5,r0
0002a8  460c              MOV      r4,r1
;;;532      if (hObj) {
0002aa  2d00              CMP      r5,#0
0002ac  d015              BEQ      |L1.730|
;;;533        WM_LOCK();
0002ae  f7fffffe          BL       GUI_Lock
;;;534        switch (Key) {
0002b2  2c11              CMP      r4,#0x11
0002b4  d00d              BEQ      |L1.722|
0002b6  2c13              CMP      r4,#0x13
0002b8  d007              BEQ      |L1.714|
;;;535          case GUI_KEY_DOWN:
;;;536            DROPDOWN_IncSel(hObj);
;;;537            break;
;;;538          case GUI_KEY_UP:
;;;539            DROPDOWN_DecSel(hObj);
;;;540            break;
;;;541          default:
;;;542            _SelectByKey(hObj, Key);
0002ba  4621              MOV      r1,r4
0002bc  4628              MOV      r0,r5
0002be  f7fffffe          BL       _SelectByKey
                  |L1.706|
;;;543            break;
;;;544        }
;;;545        WM_UNLOCK();
0002c2  e8bd4070          POP      {r4-r6,lr}
0002c6  f7ffbffe          B.W      GUI_Unlock
                  |L1.714|
0002ca  4628              MOV      r0,r5                 ;536
0002cc  f7fffffe          BL       DROPDOWN_IncSel
0002d0  e7f7              B        |L1.706|
                  |L1.722|
0002d2  4628              MOV      r0,r5                 ;539
0002d4  f7fffffe          BL       DROPDOWN_DecSel
0002d8  e7f3              B        |L1.706|
                  |L1.730|
;;;546      }
;;;547    }
0002da  bd70              POP      {r4-r6,pc}
;;;548    
                          ENDP

                  DROPDOWN_Expand PROC
;;;468    */
;;;469    void DROPDOWN_Expand(DROPDOWN_Handle hObj) {
0002dc  e92d43f0          PUSH     {r4-r9,lr}
0002e0  b087              SUB      sp,sp,#0x1c
0002e2  4607              MOV      r7,r0
;;;470      int xSize, ySize, i, NumItems;
;;;471      WM_HWIN hLst;
;;;472      GUI_RECT r;
;;;473      WM_HWIN hParent;
;;;474      WM_Obj* pParent;
;;;475      DROPDOWN_Obj* pObj;
;;;476      if (hObj) {
0002e4  2f00              CMP      r7,#0
0002e6  d07e              BEQ      |L1.998|
;;;477        WM_LOCK();
0002e8  f7fffffe          BL       GUI_Lock
;;;478        pObj = DROPDOWN_H2P(hObj);
0002ec  4638              MOV      r0,r7
0002ee  f7fffffe          BL       GUI_ALLOC_h2p
0002f2  4604              MOV      r4,r0
;;;479        if  (pObj->hListWin == 0) {
0002f4  f8b40074          LDRH     r0,[r4,#0x74]
0002f8  bbe8              CBNZ     r0,|L1.886|
;;;480          hParent = WM_GetParent(hObj);
0002fa  4638              MOV      r0,r7
0002fc  f7fffffe          BL       WM_GetParent
;;;481          pParent = WM_H2P(hParent);
000300  f7fffffe          BL       GUI_ALLOC_h2p
000304  4605              MOV      r5,r0
;;;482          xSize = WM__GetWindowSizeX(&pObj->Widget.Win);
000306  4620              MOV      r0,r4
000308  f7fffffe          BL       WM__GetWindowSizeX
00030c  4681              MOV      r9,r0
;;;483          ySize = pObj->ySizeEx;
00030e  f9b4602a          LDRSH    r6,[r4,#0x2a]
;;;484          NumItems = DROPDOWN__GetNumItems(pObj);
000312  4620              MOV      r0,r4
000314  f7fffffe          BL       DROPDOWN__GetNumItems
000318  4680              MOV      r8,r0
;;;485          /* Get coordinates of window in client coordiantes of parent */
;;;486          r = pObj->Widget.Win.Rect;
00031a  6861              LDR      r1,[r4,#4]
00031c  6820              LDR      r0,[r4,#0]
00031e  9105              STR      r1,[sp,#0x14]
000320  9004              STR      r0,[sp,#0x10]
;;;487          GUI_MoveRect(&r, -pParent->Rect.x0, -pParent->Rect.y0);
000322  f9b50002          LDRSH    r0,[r5,#2]
000326  4242              RSBS     r2,r0,#0
000328  f9b50000          LDRSH    r0,[r5,#0]
00032c  4241              RSBS     r1,r0,#0
00032e  a804              ADD      r0,sp,#0x10
000330  f7fffffe          BL       GUI_MoveRect
;;;488          if (pObj->Flags & DROPDOWN_CF_UP) {
000334  f8940076          LDRB     r0,[r4,#0x76]
000338  f0100f02          TST      r0,#2
00033c  d005              BEQ      |L1.842|
;;;489            r.y0 -= ySize;
00033e  f8bd0012          LDRH     r0,[sp,#0x12]
000342  1b80              SUBS     r0,r0,r6
000344  f8ad0012          STRH     r0,[sp,#0x12]
000348  e003              B        |L1.850|
                  |L1.842|
;;;490          } else {
;;;491            r.y0 = r.y1;
00034a  f8bd0016          LDRH     r0,[sp,#0x16]
00034e  f8ad0012          STRH     r0,[sp,#0x12]
                  |L1.850|
;;;492          }
;;;493          hLst = LISTBOX_CreateAsChild(NULL, WM_GetParent(hObj), r.x0, r.y0
000352  4638              MOV      r0,r7
000354  f7fffffe          BL       WM_GetParent
000358  2302              MOVS     r3,#2
00035a  9302              STR      r3,[sp,#8]
00035c  4601              MOV      r1,r0
00035e  f8cd9000          STR      r9,[sp,#0]
000362  9601              STR      r6,[sp,#4]
000364  f9bd3012          LDRSH    r3,[sp,#0x12]
000368  f9bd2010          LDRSH    r2,[sp,#0x10]
00036c  2000              MOVS     r0,#0
00036e  f7fffffe          BL       LISTBOX_CreateAsChild
000372  4606              MOV      r6,r0
;;;494                             , xSize, ySize, WM_CF_SHOW);
;;;495          #if WIDGET_USE_PARENT_EFFECT
;;;496            WIDGET_SetEffect(hLst, pObj->Widget.pEffect);
;;;497          #endif
;;;498          if (pObj->Flags & DROPDOWN_SF_AUTOSCROLLBAR) {
000374  e000              B        |L1.888|
                  |L1.886|
000376  e05f              B        |L1.1080|
                  |L1.888|
000378  f8940076          LDRB     r0,[r4,#0x76]
00037c  f0100f01          TST      r0,#1
000380  d008              BEQ      |L1.916|
;;;499            LISTBOX_SetScrollbarWidth(hLst, pObj->ScrollbarWidth);
000382  f894107a          LDRB     r1,[r4,#0x7a]
000386  4630              MOV      r0,r6
000388  f7fffffe          BL       LISTBOX_SetScrollbarWidth
;;;500            LISTBOX_SetAutoScrollV(hLst, 1);
00038c  2101              MOVS     r1,#1
00038e  4630              MOV      r0,r6
000390  f7fffffe          BL       LISTBOX_SetAutoScrollV
                  |L1.916|
;;;501          }
;;;502          for (i = 0; i< NumItems; i++) {
000394  2500              MOVS     r5,#0
000396  f1b80f00          CMP      r8,#0
00039a  dd0a              BLE      |L1.946|
                  |L1.924|
;;;503            LISTBOX_AddString(hLst, _GetpItem(pObj, i));
00039c  4629              MOV      r1,r5
00039e  4620              MOV      r0,r4
0003a0  f7fffffe          BL       _GetpItem
0003a4  4601              MOV      r1,r0
0003a6  4630              MOV      r0,r6
0003a8  f7fffffe          BL       LISTBOX_AddString
0003ac  1c6d              ADDS     r5,r5,#1              ;502
0003ae  4545              CMP      r5,r8                 ;502
0003b0  dbf4              BLT      |L1.924|
                  |L1.946|
;;;504          }
;;;505          for (i = 0; i < GUI_COUNTOF(pObj->Props.aBackColor); i++) {
0003b2  2500              MOVS     r5,#0
                  |L1.948|
;;;506            LISTBOX_SetBkColor(hLst, i, pObj->Props.aBackColor[i]);
0003b4  eb040085          ADD      r0,r4,r5,LSL #2
0003b8  4629              MOV      r1,r5
0003ba  6c42              LDR      r2,[r0,#0x44]
0003bc  4630              MOV      r0,r6
0003be  f7fffffe          BL       LISTBOX_SetBkColor
0003c2  1c6d              ADDS     r5,r5,#1              ;505
0003c4  2d03              CMP      r5,#3                 ;505
0003c6  d3f5              BCC      |L1.948|
;;;507          }
;;;508          for (i = 0; i < GUI_COUNTOF(pObj->Props.aTextColor); i++) {
0003c8  2500              MOVS     r5,#0
                  |L1.970|
;;;509            LISTBOX_SetTextColor(hLst, i, pObj->Props.aTextColor[i]);
0003ca  eb040085          ADD      r0,r4,r5,LSL #2
0003ce  4629              MOV      r1,r5
0003d0  6d02              LDR      r2,[r0,#0x50]
0003d2  4630              MOV      r0,r6
0003d4  f7fffffe          BL       LISTBOX_SetTextColor
0003d8  1c6d              ADDS     r5,r5,#1              ;508
0003da  2d03              CMP      r5,#3                 ;508
0003dc  d3f5              BCC      |L1.970|
;;;510          }
;;;511          for (i = 0; i < GUI_COUNTOF(pObj->Props.aScrollbarColor); i++) {
0003de  2500              MOVS     r5,#0
                  |L1.992|
;;;512            LISTBOX_SetScrollbarColor(hLst, i, pObj->Props.aScrollbarColor[i]);
0003e0  eb040085          ADD      r0,r4,r5,LSL #2
0003e4  e000              B        |L1.1000|
                  |L1.998|
0003e6  e029              B        |L1.1084|
                  |L1.1000|
0003e8  6e42              LDR      r2,[r0,#0x64]
0003ea  4629              MOV      r1,r5
0003ec  4630              MOV      r0,r6
0003ee  f7fffffe          BL       LISTBOX_SetScrollbarColor
0003f2  1c6d              ADDS     r5,r5,#1              ;511
0003f4  2d03              CMP      r5,#3                 ;511
0003f6  d3f3              BCC      |L1.992|
;;;513          }
;;;514          LISTBOX_SetItemSpacing(hLst, pObj->ItemSpacing);
0003f8  f8b41078          LDRH     r1,[r4,#0x78]
0003fc  4630              MOV      r0,r6
0003fe  f7fffffe          BL       LISTBOX_SetItemSpacing
;;;515          LISTBOX_SetFont(hLst, pObj->Props.pFont);
000402  4630              MOV      r0,r6
000404  6c21              LDR      r1,[r4,#0x40]
000406  f7fffffe          BL       LISTBOX_SetFont
;;;516          LISTBOX_SetTextAlign(hLst, pObj->Props.Align);
00040a  f9b41072          LDRSH    r1,[r4,#0x72]
00040e  4630              MOV      r0,r6
000410  f7fffffe          BL       LISTBOX_SetTextAlign
;;;517          WM_SetFocus(hLst);
000414  4630              MOV      r0,r6
000416  f7fffffe          BL       WM_SetFocus
;;;518          pObj->hListWin = hLst;
00041a  f8a46074          STRH     r6,[r4,#0x74]
;;;519          LISTBOX_SetOwner(hLst, hObj);
00041e  4639              MOV      r1,r7
000420  4630              MOV      r0,r6
000422  f7fffffe          BL       LISTBOX_SetOwner
;;;520          LISTBOX_SetSel(hLst, pObj->Sel);
000426  f9b41028          LDRSH    r1,[r4,#0x28]
00042a  4630              MOV      r0,r6
00042c  f7fffffe          BL       LISTBOX_SetSel
;;;521          WM_NotifyParent(hObj, WM_NOTIFICATION_CLICKED);
000430  2101              MOVS     r1,#1
000432  4638              MOV      r0,r7
000434  f7fffffe          BL       WM_NotifyParent
                  |L1.1080|
;;;522        }
;;;523        WM_UNLOCK();
000438  f7fffffe          BL       GUI_Unlock
                  |L1.1084|
;;;524      }
;;;525    }
00043c  b007              ADD      sp,sp,#0x1c
00043e  e8bd83f0          POP      {r4-r9,pc}
;;;526    
                          ENDP

                  DROPDOWN_Collapse PROC
;;;451    */
;;;452    void DROPDOWN_Collapse(DROPDOWN_Handle hObj) {
000442  b510              PUSH     {r4,lr}
000444  4604              MOV      r4,r0
;;;453      DROPDOWN_Obj* pObj;
;;;454      if (hObj) {
000446  2c00              CMP      r4,#0
000448  d011              BEQ      |L1.1134|
;;;455        WM_LOCK();
00044a  f7fffffe          BL       GUI_Lock
;;;456        pObj = DROPDOWN_H2P(hObj);
00044e  4620              MOV      r0,r4
000450  f7fffffe          BL       GUI_ALLOC_h2p
000454  4604              MOV      r4,r0
;;;457        if (pObj->hListWin) {
000456  f9b40074          LDRSH    r0,[r4,#0x74]
00045a  b120              CBZ      r0,|L1.1126|
;;;458          WM_DeleteWindow(pObj->hListWin);
00045c  f7fffffe          BL       WM_DeleteWindow
;;;459          pObj->hListWin = 0;
000460  2000              MOVS     r0,#0
000462  f8a40074          STRH     r0,[r4,#0x74]
                  |L1.1126|
;;;460        }
;;;461        WM_UNLOCK();
000466  e8bd4010          POP      {r4,lr}
00046a  f7ffbffe          B.W      GUI_Unlock
                  |L1.1134|
;;;462      }
;;;463    }
00046e  bd10              POP      {r4,pc}
;;;464    
                          ENDP

                  DROPDOWN_Callback PROC
;;;324    */
;;;325    void DROPDOWN_Callback (WM_MESSAGE*pMsg) {
000470  e92d41f0          PUSH     {r4-r8,lr}
000474  4604              MOV      r4,r0
;;;326      DROPDOWN_Handle hObj;
;;;327      DROPDOWN_Obj* pObj;
;;;328      char IsExpandedBeforeMsg;
;;;329      hObj = pMsg->hWin;
000476  f9b47004          LDRSH    r7,[r4,#4]
;;;330      pObj = (DROPDOWN_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
00047a  4638              MOV      r0,r7
00047c  f7fffffe          BL       GUI_ALLOC_h2p
000480  4605              MOV      r5,r0
;;;331      IsExpandedBeforeMsg = pObj->hListWin ? 1 : 0;
000482  f8b50074          LDRH     r0,[r5,#0x74]
000486  b108              CBZ      r0,|L1.1164|
000488  2601              MOVS     r6,#1
00048a  e000              B        |L1.1166|
                  |L1.1164|
00048c  2600              MOVS     r6,#0
                  |L1.1166|
;;;332      /* Let widget handle the standard messages */
;;;333      if (WIDGET_HandleActive(hObj, pMsg) == 0) {
00048e  4621              MOV      r1,r4
000490  4638              MOV      r0,r7
000492  f7fffffe          BL       WIDGET_HandleActive
000496  2800              CMP      r0,#0
000498  d07c              BEQ      |L1.1428|
;;;334        return;
;;;335      }
;;;336      switch (pMsg->MsgId) {
00049a  6820              LDR      r0,[r4,#0]
00049c  280f              CMP      r0,#0xf
00049e  d050              BEQ      |L1.1346|
0004a0  dc06              BGT      |L1.1200|
0004a2  280b              CMP      r0,#0xb
0004a4  d051              BEQ      |L1.1354|
0004a6  280c              CMP      r0,#0xc
0004a8  d044              BEQ      |L1.1332|
0004aa  280e              CMP      r0,#0xe
0004ac  d16d              BNE      |L1.1418|
0004ae  e050              B        |L1.1362|
                  |L1.1200|
0004b0  2811              CMP      r0,#0x11
0004b2  d037              BEQ      |L1.1316|
0004b4  2821              CMP      r0,#0x21
0004b6  d002              BEQ      |L1.1214|
0004b8  2826              CMP      r0,#0x26
0004ba  d166              BNE      |L1.1418|
0004bc  e015              B        |L1.1258|
                  |L1.1214|
;;;337      case WM_NOTIFY_OWNER_KEY:
;;;338        /* Close the listbox if DROPDOWN_KEY_SELECT has been pressed */
;;;339        if (((const WM_KEY_INFO*)(pMsg->Data.p))->PressedCnt > 0) {
0004be  68a0              LDR      r0,[r4,#8]
0004c0  6841              LDR      r1,[r0,#4]
0004c2  2900              CMP      r1,#0
0004c4  dd61              BLE      |L1.1418|
;;;340          int Key;
;;;341          Key = ((const WM_KEY_INFO*)(pMsg->Data.p))->Key;
0004c6  6800              LDR      r0,[r0,#0]
;;;342          if (Key == DROPDOWN_KEY_SELECT) {
0004c8  280d              CMP      r0,#0xd
0004ca  d15e              BNE      |L1.1418|
;;;343            DROPDOWN_SetSel(hObj, LISTBOX_GetSel(pObj->hListWin));
0004cc  f9b50074          LDRSH    r0,[r5,#0x74]
0004d0  f7fffffe          BL       LISTBOX_GetSel
0004d4  4601              MOV      r1,r0
0004d6  4638              MOV      r0,r7
0004d8  f7fffffe          BL       DROPDOWN_SetSel
;;;344            DROPDOWN_Collapse(hObj);
0004dc  4638              MOV      r0,r7
0004de  f7fffffe          BL       DROPDOWN_Collapse
;;;345            WM_SetFocus(hObj);
0004e2  4638              MOV      r0,r7
0004e4  f7fffffe          BL       WM_SetFocus
0004e8  e04f              B        |L1.1418|
                  |L1.1258|
;;;346          }
;;;347        }
;;;348        break;
;;;349      case WM_NOTIFY_PARENT:
;;;350        switch (pMsg->Data.v) {
0004ea  68a0              LDR      r0,[r4,#8]
0004ec  2801              CMP      r0,#1
0004ee  d009              BEQ      |L1.1284|
0004f0  280a              CMP      r0,#0xa
0004f2  d002              BEQ      |L1.1274|
0004f4  280b              CMP      r0,#0xb
0004f6  d148              BNE      |L1.1418|
0004f8  e010              B        |L1.1308|
                  |L1.1274|
;;;351        case WM_NOTIFICATION_SCROLL_CHANGED:
;;;352          WM_NotifyParent(hObj, WM_NOTIFICATION_SCROLL_CHANGED);
0004fa  210a              MOVS     r1,#0xa
0004fc  4638              MOV      r0,r7
0004fe  f7fffffe          BL       WM_NotifyParent
;;;353          break;
000502  e042              B        |L1.1418|
                  |L1.1284|
;;;354        case WM_NOTIFICATION_CLICKED:
;;;355          DROPDOWN_SetSel(hObj, LISTBOX_GetSel(pObj->hListWin));
000504  f9b50074          LDRSH    r0,[r5,#0x74]
000508  f7fffffe          BL       LISTBOX_GetSel
00050c  4601              MOV      r1,r0
00050e  4638              MOV      r0,r7
000510  f7fffffe          BL       DROPDOWN_SetSel
;;;356          WM_SetFocus(hObj);
000514  4638              MOV      r0,r7
000516  f7fffffe          BL       WM_SetFocus
;;;357          break;
00051a  e036              B        |L1.1418|
                  |L1.1308|
;;;358        case LISTBOX_NOTIFICATION_LOST_FOCUS:
;;;359          DROPDOWN_Collapse(hObj);
00051c  4638              MOV      r0,r7
00051e  f7fffffe          BL       DROPDOWN_Collapse
;;;360          break;
000522  e032              B        |L1.1418|
                  |L1.1316|
;;;361        }
;;;362        break;
;;;363      case WM_PID_STATE_CHANGED:
;;;364        if (IsExpandedBeforeMsg == 0) {    /* Make sure we do not react a second time */
000524  bb3e              CBNZ     r6,|L1.1398|
;;;365          const WM_PID_STATE_CHANGED_INFO * pInfo = (const WM_PID_STATE_CHANGED_INFO*)pMsg->Data.p;
000526  68a0              LDR      r0,[r4,#8]
;;;366          if (pInfo->State) {
000528  7a00              LDRB     r0,[r0,#8]
00052a  b320              CBZ      r0,|L1.1398|
;;;367            DROPDOWN_Expand(hObj);
00052c  4638              MOV      r0,r7
00052e  f7fffffe          BL       DROPDOWN_Expand
000532  e02a              B        |L1.1418|
                  |L1.1332|
;;;368          }
;;;369        }
;;;370        break;
;;;371      case WM_TOUCH:
;;;372        if (_OnTouch(hObj, pMsg) == 0) {
000534  4621              MOV      r1,r4
000536  4638              MOV      r0,r7
000538  f7fffffe          BL       _OnTouch
00053c  2800              CMP      r0,#0
00053e  d029              BEQ      |L1.1428|
000540  e023              B        |L1.1418|
                  |L1.1346|
;;;373          return;
;;;374        }
;;;375        break;
;;;376      case WM_PAINT:
;;;377        _Paint(hObj);
000542  4638              MOV      r0,r7
000544  f7fffffe          BL       _Paint
;;;378        break;
000548  e01f              B        |L1.1418|
                  |L1.1354|
;;;379      case WM_DELETE:
;;;380        _FreeAttached(pObj);
00054a  4628              MOV      r0,r5
00054c  f7fffffe          BL       _FreeAttached
;;;381        break;       /* No return here ... WM_DefaultProc needs to be called */
000550  e01b              B        |L1.1418|
                  |L1.1362|
;;;382      case WM_KEY:
;;;383        if ( ((const WM_KEY_INFO*)(pMsg->Data.p))->PressedCnt >0) {
000552  68a0              LDR      r0,[r4,#8]
000554  6841              LDR      r1,[r0,#4]
000556  2900              CMP      r1,#0
000558  dd17              BLE      |L1.1418|
;;;384          int Key = ((const WM_KEY_INFO*)(pMsg->Data.p))->Key;
00055a  6801              LDR      r1,[r0,#0]
;;;385          switch (Key) {
00055c  2909              CMP      r1,#9
00055e  d00b              BEQ      |L1.1400|
000560  290a              CMP      r1,#0xa
000562  d012              BEQ      |L1.1418|
000564  2920              CMP      r1,#0x20
000566  d003              BEQ      |L1.1392|
;;;386            case DROPDOWN_KEY_EXPAND:
;;;387              DROPDOWN_Expand(hObj);
;;;388              break;
;;;389            case GUI_KEY_BACKTAB:
;;;390              break;
;;;391            case GUI_KEY_TAB:
;;;392              if (WM_GetFocussedWindow() == pObj->hListWin) {
;;;393                WM_SetFocus(hObj);      /* Make sure, WM_SetFocusOnNextChild() works right when calling WM_DefaultProc() */
;;;394              }
;;;395              break;                    /* Send to parent by not doing anything */
;;;396            default:
;;;397              DROPDOWN_AddKey(hObj, Key);
000568  4638              MOV      r0,r7
00056a  e8bd41f0          POP      {r4-r8,lr}
00056e  e7fe              B        DROPDOWN_AddKey
                  |L1.1392|
000570  4638              MOV      r0,r7                 ;387
000572  f7fffffe          BL       DROPDOWN_Expand
                  |L1.1398|
000576  e008              B        |L1.1418|
                  |L1.1400|
000578  f7fffffe          BL       WM_GetFocussedWindow
00057c  f9b51074          LDRSH    r1,[r5,#0x74]         ;392
000580  4288              CMP      r0,r1                 ;392
000582  d102              BNE      |L1.1418|
000584  4638              MOV      r0,r7                 ;393
000586  f7fffffe          BL       WM_SetFocus
                  |L1.1418|
;;;398              return;
;;;399          }
;;;400        }
;;;401        break;
;;;402      }
;;;403      WM_DefaultProc(pMsg);
00058a  4620              MOV      r0,r4
00058c  e8bd41f0          POP      {r4-r8,lr}
000590  f7ffbffe          B.W      WM_DefaultProc
                  |L1.1428|
;;;404    }
000594  e8bd81f0          POP      {r4-r8,pc}
;;;405    
                          ENDP

                  DROPDOWN_CreateEx PROC
;;;415    */
;;;416    DROPDOWN_Handle DROPDOWN_CreateEx(int x0, int y0, int xsize, int ysize, WM_HWIN hParent,
000598  e92d4ff0          PUSH     {r4-r11,lr}
;;;417                                      int WinFlags, int ExFlags, int Id)
;;;418    {
00059c  b085              SUB      sp,sp,#0x14
00059e  4681              MOV      r9,r0
0005a0  468a              MOV      r10,r1
0005a2  4693              MOV      r11,r2
0005a4  461f              MOV      r7,r3
0005a6  f8dd8044          LDR      r8,[sp,#0x44]
0005aa  9e10              LDR      r6,[sp,#0x40]
0005ac  9d0e              LDR      r5,[sp,#0x38]
0005ae  9c0f              LDR      r4,[sp,#0x3c]
;;;419      DROPDOWN_Handle hObj;
;;;420      WM_LOCK();
0005b0  f7fffffe          BL       GUI_Lock
;;;421      hObj = WM_CreateWindowAsChild(x0, y0, xsize, -1, hParent, WinFlags, DROPDOWN_Callback,
0005b4  235c              MOVS     r3,#0x5c
0005b6  f2af1247          ADR      r2,DROPDOWN_Callback + 1
0005ba  b2a1              UXTH     r1,r4
0005bc  9303              STR      r3,[sp,#0xc]
0005be  9202              STR      r2,[sp,#8]
0005c0  9101              STR      r1,[sp,#4]
0005c2  9500              STR      r5,[sp,#0]
0005c4  f04f33ff          MOV      r3,#0xffffffff
0005c8  465a              MOV      r2,r11
0005ca  4651              MOV      r1,r10
0005cc  4648              MOV      r0,r9
0005ce  f7fffffe          BL       WM_CreateWindowAsChild
0005d2  4605              MOV      r5,r0
;;;422                                    sizeof(DROPDOWN_Obj) - sizeof(WM_Obj));
;;;423      if (hObj) {
0005d4  b3a5              CBZ      r5,|L1.1600|
;;;424        DROPDOWN_Obj* pObj;
;;;425        pObj = (DROPDOWN_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
0005d6  4628              MOV      r0,r5
0005d8  f7fffffe          BL       GUI_ALLOC_h2p
0005dc  4604              MOV      r4,r0
;;;426        /* Init sub-classes */
;;;427        GUI_ARRAY_CREATE(&pObj->Handles);
;;;428        /* init widget specific variables */
;;;429        WIDGET__Init(&pObj->Widget, Id, WIDGET_STATE_FOCUSSABLE);
0005de  2210              MOVS     r2,#0x10
0005e0  4641              MOV      r1,r8
0005e2  4620              MOV      r0,r4
0005e4  f7fffffe          BL       WIDGET__Init
;;;430        pObj->Flags          = ExFlags;
0005e8  f8846076          STRB     r6,[r4,#0x76]
;;;431        pObj->Props          = DROPDOWN__DefaultProps;
0005ec  4a17              LDR      r2,|L1.1612|
0005ee  4620              MOV      r0,r4
0005f0  f8d2c008          LDR      r12,[r2,#8]  ; DROPDOWN__DefaultProps
0005f4  68d6              LDR      r6,[r2,#0xc]  ; DROPDOWN__DefaultProps
0005f6  6853              LDR      r3,[r2,#4]  ; DROPDOWN__DefaultProps
0005f8  6811              LDR      r1,[r2,#0]  ; DROPDOWN__DefaultProps
0005fa  f8c4c048          STR      r12,[r4,#0x48]
0005fe  64e6              STR      r6,[r4,#0x4c]
000600  6463              STR      r3,[r4,#0x44]
000602  6421              STR      r1,[r4,#0x40]
000604  f8d2c018          LDR      r12,[r2,#0x18]  ; DROPDOWN__DefaultProps
000608  69d6              LDR      r6,[r2,#0x1c]  ; DROPDOWN__DefaultProps
00060a  6953              LDR      r3,[r2,#0x14]  ; DROPDOWN__DefaultProps
00060c  6911              LDR      r1,[r2,#0x10]  ; DROPDOWN__DefaultProps
00060e  f8c4c058          STR      r12,[r4,#0x58]
000612  6563              STR      r3,[r4,#0x54]
000614  6521              STR      r1,[r4,#0x50]
000616  65c6              STR      r6,[r0,#0x5c]
000618  f8d2c028          LDR      r12,[r2,#0x28]  ; DROPDOWN__DefaultProps
00061c  6ad6              LDR      r6,[r2,#0x2c]  ; DROPDOWN__DefaultProps
00061e  6a53              LDR      r3,[r2,#0x24]  ; DROPDOWN__DefaultProps
000620  6a11              LDR      r1,[r2,#0x20]  ; DROPDOWN__DefaultProps
000622  f8c0c068          STR      r12,[r0,#0x68]
000626  66c6              STR      r6,[r0,#0x6c]
000628  6643              STR      r3,[r0,#0x64]
00062a  6601              STR      r1,[r0,#0x60]
00062c  6b11              LDR      r1,[r2,#0x30]  ; DROPDOWN__DefaultProps
00062e  6701              STR      r1,[r0,#0x70]
;;;432        pObj->ScrollbarWidth = 0;
000630  2000              MOVS     r0,#0
000632  f884007a          STRB     r0,[r4,#0x7a]
;;;433        DROPDOWN_INIT_ID(pObj);
;;;434        pObj->ySizeEx = ysize;
000636  8567              STRH     r7,[r4,#0x2a]
;;;435        DROPDOWN__AdjustHeight(hObj, pObj);
000638  4621              MOV      r1,r4
00063a  4628              MOV      r0,r5
00063c  f7fffffe          BL       DROPDOWN__AdjustHeight
                  |L1.1600|
;;;436      }
;;;437      WM_UNLOCK();
000640  f7fffffe          BL       GUI_Unlock
;;;438      return hObj;
;;;439    }
000644  b005              ADD      sp,sp,#0x14
000646  4628              MOV      r0,r5                 ;438
000648  e8bd8ff0          POP      {r4-r11,pc}
;;;440    
                          ENDP

                  |L1.1612|
                          DCD      ||.data||

                          AREA ||.data||, DATA, ALIGN=2

                  DROPDOWN__DefaultProps
                          DCD      GUI_Font13_1
                          DCD      0x00ffffff
                          DCD      0x00808080
                          DCD      0x00ff0000
                          DCD      0x00000000
                          DCD      0x00ffffff
                          DCD      0x00ffffff
                          DCD      0x00000000
                          DCD      0x00c0c0c0
                          DCD      0x0fffffff
                          DCD      0x0fffffff
                          DCD      0x0fffffff
000030  00020000          DCW      0x0002,0x0000
