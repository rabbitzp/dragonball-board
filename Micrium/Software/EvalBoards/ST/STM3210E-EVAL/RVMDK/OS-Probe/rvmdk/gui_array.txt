; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\gui_array.o --depend=.\rvmdk\gui_array.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\gui_array.crf ..\..\..\..\..\uCGUI\GUI\Widget\GUI_ARRAY.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=1

                  GUI_ARRAY_GetNumItems PROC
;;;34     */
;;;35     unsigned int GUI_ARRAY_GetNumItems(const GUI_ARRAY* pThis) {
000000  8800              LDRH     r0,[r0,#0]
;;;36       GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;37     
;;;38       return pThis->NumItems;
;;;39     }
000002  4770              BX       lr
;;;40     
                          ENDP

                  GUI_ARRAY_AddItem PROC
;;;55     */
;;;56     int GUI_ARRAY_AddItem(GUI_ARRAY* pThis, const void *pNew, int Len) {
000004  e92d41f0          PUSH     {r4-r8,lr}
000008  4604              MOV      r4,r0
00000a  4688              MOV      r8,r1
00000c  4616              MOV      r6,r2
;;;57       WM_HMEM hNewItem = 0;
00000e  2700              MOVS     r7,#0
;;;58       WM_HMEM hNewBuffer;
;;;59       WM_HMEM *pNewBuffer;
;;;60       int r = 0;
000010  2500              MOVS     r5,#0
;;;61     
;;;62       GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;63     
;;;64       WM_LOCK();
000012  f7fffffe          BL       GUI_Lock
;;;65       /* Alloc memory for new item */
;;;66       if (Len) {
000016  b136              CBZ      r6,|L1.38|
;;;67         if ((hNewItem = GUI_ALLOC_AllocInit(pNew, Len)) == 0) {
000018  b231              SXTH     r1,r6
00001a  4640              MOV      r0,r8
00001c  f7fffffe          BL       GUI_ALLOC_AllocInit
000020  0007              MOVS     r7,r0
000022  d100              BNE      |L1.38|
;;;68           GUI_DEBUG_ERROROUT("GUI_ARRAY_AddItem failed to alloc buffer");
;;;69           r = 1;            /* Error */
000024  2501              MOVS     r5,#1
                  |L1.38|
;;;70         }
;;;71       }
;;;72       /* Put handle of new item into the array */
;;;73       if (r == 0) {
000026  b9a5              CBNZ     r5,|L1.82|
;;;74         int NumItems;
;;;75         NumItems = pThis->NumItems;
000028  8826              LDRH     r6,[r4,#0]
;;;76         /* Add the handle to new item to the buffer */
;;;77         hNewBuffer = GUI_ALLOC_Realloc(pThis->haHandle, (NumItems + 1) * sizeof(WM_HMEM));
00002a  1c70              ADDS     r0,r6,#1
00002c  0041              LSLS     r1,r0,#1
00002e  f9b40002          LDRSH    r0,[r4,#2]
000032  f7fffffe          BL       GUI_ALLOC_Realloc
000036  4680              MOV      r8,r0
;;;78         if (hNewBuffer == 0) {
000038  f1b80f00          CMP      r8,#0
00003c  d00e              BEQ      |L1.92|
;;;79           GUI_DEBUG_ERROROUT("GUI_ARRAY_AddItem failed to alloc buffer");
;;;80           GUI_ALLOC_Free(hNewItem);
;;;81           r = 1;            /* Error */
;;;82         } else {
;;;83           pNewBuffer = (WM_HMEM*) GUI_ALLOC_h2p(hNewBuffer);
00003e  4640              MOV      r0,r8
000040  f7fffffe          BL       GUI_ALLOC_h2p
;;;84           *(pNewBuffer + NumItems) = hNewItem;
000044  f8207016          STRH     r7,[r0,r6,LSL #1]
;;;85           pThis->haHandle = hNewBuffer;
000048  f8a48002          STRH     r8,[r4,#2]
;;;86           pThis->NumItems++;
00004c  8820              LDRH     r0,[r4,#0]
00004e  1c40              ADDS     r0,r0,#1
000050  8020              STRH     r0,[r4,#0]
                  |L1.82|
;;;87         }
;;;88       }
;;;89       WM_UNLOCK();
000052  f7fffffe          BL       GUI_Unlock
;;;90       return r;
000056  4628              MOV      r0,r5
;;;91     }
000058  e8bd81f0          POP      {r4-r8,pc}
                  |L1.92|
00005c  4638              MOV      r0,r7                 ;80
00005e  f7fffffe          BL       GUI_ALLOC_Free
000062  2501              MOVS     r5,#1                 ;81
000064  e7f5              B        |L1.82|
;;;92     
                          ENDP

                  GUI_ARRAY_Delete PROC
;;;103    */
;;;104    void GUI_ARRAY_Delete(GUI_ARRAY* pThis) {
000066  b570              PUSH     {r4-r6,lr}
000068  4605              MOV      r5,r0
;;;105      int i;
;;;106      WM_HMEM ha;
;;;107      WM_HMEM* pa;
;;;108    
;;;109      GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;110    
;;;111      ha = pThis->haHandle;
00006a  f9b50002          LDRSH    r0,[r5,#2]
;;;112      if (ha) {
00006e  2800              CMP      r0,#0
000070  d013              BEQ      |L1.154|
;;;113        pa = (WM_HMEM*) GUI_ALLOC_h2p(ha);
000072  f7fffffe          BL       GUI_ALLOC_h2p
000076  4606              MOV      r6,r0
;;;114        /* Free the attached items, one at a time */
;;;115        for (i = 0; i < pThis->NumItems; i++) {
000078  2400              MOVS     r4,#0
00007a  8828              LDRH     r0,[r5,#0]
00007c  2800              CMP      r0,#0
00007e  dd07              BLE      |L1.144|
                  |L1.128|
;;;116          GUI_ALLOC_FreePtr(pa+i);
000080  eb060044          ADD      r0,r6,r4,LSL #1
000084  f7fffffe          BL       GUI_ALLOC_FreePtr
000088  1c64              ADDS     r4,r4,#1              ;115
00008a  8828              LDRH     r0,[r5,#0]            ;115
00008c  42a0              CMP      r0,r4                 ;115
00008e  dcf7              BGT      |L1.128|
                  |L1.144|
;;;117        }
;;;118        /* Free the handle buffer */
;;;119        GUI_ALLOC_FreePtr(&pThis->haHandle);
000090  1ca8              ADDS     r0,r5,#2
000092  f7fffffe          BL       GUI_ALLOC_FreePtr
;;;120        pThis->NumItems = 0;                    /* For safety, in case the array is used after it has been deleted */
000096  2000              MOVS     r0,#0
000098  8028              STRH     r0,[r5,#0]
                  |L1.154|
;;;121      }
;;;122      #if GUI_DEBUG_LEVEL >= GUI_DEBUG_LEVEL_CHECK_ALL
;;;123        pThis->InitState = GUI_ARRAY_STATE_DELETED;
;;;124      #endif
;;;125    }
00009a  bd70              POP      {r4-r6,pc}
;;;126    
                          ENDP

                  GUI_ARRAY_SethItem PROC
;;;145    */
;;;146    int GUI_ARRAY_SethItem(GUI_ARRAY* pThis, unsigned int Index, WM_HMEM hItem) {
00009c  b570              PUSH     {r4-r6,lr}
00009e  460c              MOV      r4,r1
0000a0  4615              MOV      r5,r2
;;;147      WM_HMEM ha;
;;;148      WM_HMEM* pa;
;;;149      int r = 1;
0000a2  2101              MOVS     r1,#1
;;;150    
;;;151      GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;152    
;;;153      if (Index < (unsigned)pThis->NumItems) {
0000a4  8802              LDRH     r2,[r0,#0]
0000a6  42a2              CMP      r2,r4
0000a8  d90b              BLS      |L1.194|
;;;154        ha = pThis->haHandle;
0000aa  f9b00002          LDRSH    r0,[r0,#2]
;;;155        if (ha) {
0000ae  b140              CBZ      r0,|L1.194|
;;;156          pa = (WM_HMEM*) GUI_ALLOC_h2p(ha);
0000b0  f7fffffe          BL       GUI_ALLOC_h2p
;;;157          pa += Index;
0000b4  eb000444          ADD      r4,r0,r4,LSL #1
;;;158          GUI_ALLOC_FreePtr(pa);
0000b8  4620              MOV      r0,r4
0000ba  f7fffffe          BL       GUI_ALLOC_FreePtr
;;;159          *pa = hItem;
0000be  8025              STRH     r5,[r4,#0]
;;;160          r = 0;
0000c0  2100              MOVS     r1,#0
                  |L1.194|
;;;161        }
;;;162      }
;;;163      return r;
0000c2  4608              MOV      r0,r1
;;;164    }
0000c4  bd70              POP      {r4-r6,pc}
;;;165    
                          ENDP

                  GUI_ARRAY_SetItem PROC
;;;184    */
;;;185    WM_HMEM  GUI_ARRAY_SetItem(GUI_ARRAY* pThis, unsigned int Index, const void* pData, int Len) {
0000c6  e92d41f0          PUSH     {r4-r8,lr}
0000ca  460d              MOV      r5,r1
0000cc  4617              MOV      r7,r2
0000ce  461e              MOV      r6,r3
;;;186      WM_HMEM hItem = 0;
0000d0  2400              MOVS     r4,#0
;;;187    
;;;188      GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;189    
;;;190      if (Index < (unsigned)pThis->NumItems) {
0000d2  8801              LDRH     r1,[r0,#0]
0000d4  42a9              CMP      r1,r5
0000d6  d922              BLS      |L1.286|
;;;191        WM_HMEM ha;
;;;192        ha = pThis->haHandle;
0000d8  f9b00002          LDRSH    r0,[r0,#2]
;;;193        if (ha) {
0000dc  b1f8              CBZ      r0,|L1.286|
;;;194          WM_HMEM* pa;
;;;195          pa = (WM_HMEM*) GUI_ALLOC_h2p(ha);
0000de  f7fffffe          BL       GUI_ALLOC_h2p
;;;196          pa += Index;
0000e2  eb000545          ADD      r5,r0,r5,LSL #1
;;;197          hItem = *pa;
0000e6  f9b54000          LDRSH    r4,[r5,#0]
;;;198          /*
;;;199           * If a buffer is already available, a new buffer is only needed when the
;;;200           * new item has a different size.
;;;201           */
;;;202          if (hItem) {
0000ea  b12c              CBZ      r4,|L1.248|
;;;203            if (GUI_ALLOC_GetSize(hItem) != Len) {
0000ec  4620              MOV      r0,r4
0000ee  f7fffffe          BL       GUI_ALLOC_GetSize
0000f2  42b0              CMP      r0,r6
0000f4  d000              BEQ      |L1.248|
;;;204              hItem = 0;
0000f6  2400              MOVS     r4,#0
                  |L1.248|
;;;205            }
;;;206          }
;;;207          /*
;;;208           * Allocate a new buffer and free the old one (if needed). 
;;;209           */
;;;210          if (!hItem) {
0000f8  b944              CBNZ     r4,|L1.268|
;;;211            hItem = GUI_ALLOC_AllocZero(Len);
0000fa  b230              SXTH     r0,r6
0000fc  f7fffffe          BL       GUI_ALLOC_AllocZero
000100  4604              MOV      r4,r0
;;;212            if (hItem) {
000102  b11c              CBZ      r4,|L1.268|
;;;213              GUI_ALLOC_FreePtr(pa);
000104  4628              MOV      r0,r5
000106  f7fffffe          BL       GUI_ALLOC_FreePtr
;;;214              *pa = hItem;
00010a  802c              STRH     r4,[r5,#0]
                  |L1.268|
;;;215            }
;;;216          }
;;;217          /*
;;;218           * Set the item (if needed)
;;;219           */
;;;220          if (pData && hItem) {
00010c  b13f              CBZ      r7,|L1.286|
00010e  b134              CBZ      r4,|L1.286|
;;;221            char* pItem = (char*) GUI_ALLOC_h2p(hItem);
000110  4620              MOV      r0,r4
000112  f7fffffe          BL       GUI_ALLOC_h2p
;;;222            memcpy(pItem, pData, Len);
000116  4632              MOV      r2,r6
000118  4639              MOV      r1,r7
00011a  f7fffffe          BL       __aeabi_memcpy
                  |L1.286|
;;;223          }
;;;224        }
;;;225      }
;;;226      return hItem;
00011e  4620              MOV      r0,r4
;;;227    }
000120  e8bd81f0          POP      {r4-r8,pc}
;;;228    
                          ENDP

                  GUI_ARRAY_GethItem PROC
;;;240    */
;;;241    WM_HMEM GUI_ARRAY_GethItem(const GUI_ARRAY* pThis, unsigned int Index) {
000124  b510              PUSH     {r4,lr}
000126  460c              MOV      r4,r1
;;;242      WM_HMEM h = 0;
000128  2100              MOVS     r1,#0
;;;243    
;;;244      GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;245    
;;;246      if (Index < (unsigned)pThis->NumItems) {
00012a  8802              LDRH     r2,[r0,#0]
00012c  42a2              CMP      r2,r4
00012e  d906              BLS      |L1.318|
;;;247        WM_HMEM  ha;
;;;248        WM_HMEM* pa;
;;;249        ha = pThis->haHandle;
000130  f9b00002          LDRSH    r0,[r0,#2]
;;;250        if (ha) {
000134  b118              CBZ      r0,|L1.318|
;;;251          pa = (WM_HMEM*) GUI_ALLOC_h2p(ha);
000136  f7fffffe          BL       GUI_ALLOC_h2p
;;;252          h = *(pa + Index);
00013a  f9301014          LDRSH    r1,[r0,r4,LSL #1]
                  |L1.318|
;;;253        }
;;;254      }
;;;255      return h;
00013e  4608              MOV      r0,r1
;;;256    }
000140  bd10              POP      {r4,pc}
;;;257    
                          ENDP

                  GUI_ARRAY_GetpItem PROC
;;;272    */
;;;273    void* GUI_ARRAY_GetpItem(const GUI_ARRAY* pThis, unsigned int Index) {
000142  b510              PUSH     {r4,lr}
;;;274      void* p = NULL;
000144  2400              MOVS     r4,#0
;;;275      WM_HMEM h;
;;;276    
;;;277      GUI_ARRAY_CHECK(pThis);    /* Sanity checks at higher debug levels only */
;;;278    
;;;279      h = GUI_ARRAY_GethItem(pThis, Index);
000146  f7fffffe          BL       GUI_ARRAY_GethItem
;;;280      if (h) {
00014a  b110              CBZ      r0,|L1.338|
;;;281        p = WM_H2P(h);
00014c  f7fffffe          BL       GUI_ALLOC_h2p
000150  4604              MOV      r4,r0
                  |L1.338|
;;;282      }
;;;283      return p;
000152  4620              MOV      r0,r4
;;;284    }
000154  bd10              POP      {r4,pc}
;;;285    
                          ENDP

