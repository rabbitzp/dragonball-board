; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\guitask.o --depend=.\rvmdk\guitask.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\guitask.crf ..\..\..\..\..\uCGUI\GUI\Core\GUITask.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  _GetTaskNo PROC
;;;101    */
;;;102    static int _GetTaskNo(void) {
000000  b570              PUSH     {r4-r6,lr}
;;;103      int i;
;;;104      for (i=0; i< GUI_MAXTASK; i++) {
000002  2400              MOVS     r4,#0
;;;105        U32 TaskId = GUI_X_GetTaskId();
;;;106        if (_Save[i].TaskID == TaskId)
000004  4d47              LDR      r5,|L1.292|
                  |L1.6|
000006  f7fffffe          BL       GUI_X_GetTaskId
00000a  4601              MOV      r1,r0                 ;105
00000c  eb040084          ADD      r0,r4,r4,LSL #2
000010  eb0000c4          ADD      r0,r0,r4,LSL #3
000014  f8550030          LDR      r0,[r5,r0,LSL #3]
000018  4288              CMP      r0,r1
00001a  d101              BNE      |L1.32|
;;;107          return i;
00001c  4620              MOV      r0,r4
;;;108        if (_Save[i].TaskID == 0) {
;;;109          _Save[i].TaskID = TaskId;
;;;110          return i;
;;;111        }
;;;112      }
;;;113      GUI_DEBUG_ERROROUT("No Context available for task ... (increase GUI_MAXTASK)");
;;;114      return 0;
;;;115    }
00001e  bd70              POP      {r4-r6,pc}
                  |L1.32|
000020  b120              CBZ      r0,|L1.44|
000022  1c64              ADDS     r4,r4,#1              ;104
000024  2c04              CMP      r4,#4                 ;104
000026  dbee              BLT      |L1.6|
000028  2000              MOVS     r0,#0                 ;114
00002a  bd70              POP      {r4-r6,pc}
                  |L1.44|
00002c  eb040084          ADD      r0,r4,r4,LSL #2       ;109
000030  eb0000c4          ADD      r0,r0,r4,LSL #3       ;109
000034  f8451030          STR      r1,[r5,r0,LSL #3]     ;109
000038  4620              MOV      r0,r4                 ;110
00003a  bd70              POP      {r4-r6,pc}
;;;116    
                          ENDP

                  GUI_Unlock PROC
;;;126    */
;;;127    void GUI_Unlock(void) {
00003c  493a              LDR      r1,|L1.296|
;;;128      if (--GUITASK__EntranceCnt == 0) {
00003e  6888              LDR      r0,[r1,#8]  ; GUITASK__EntranceCnt
000040  1e40              SUBS     r0,r0,#1
000042  6088              STR      r0,[r1,#8]  ; GUITASK__EntranceCnt
000044  d101              BNE      |L1.74|
;;;129        GUI_X_Unlock();
000046  f7ffbffe          B.W      GUI_X_Unlock
                  |L1.74|
;;;130      }
;;;131      /* Test if GUITASK__EntranceCnt is in reasonable range ... Not required in release builds */
;;;132      GUI_DEBUG_ERROROUT_IF((GUITASK__EntranceCnt < 0), "GUITASK.c: GUI_Unlock() GUITASK__EntranceCnt underflow ");
;;;133    }
00004a  4770              BX       lr
;;;134    
                          ENDP

                  GUI_Lock PROC
;;;138    */
;;;139    void GUI_Lock(void) {
00004c  b570              PUSH     {r4-r6,lr}
;;;140      if (GUITASK__EntranceCnt == 0) {
00004e  4d36              LDR      r5,|L1.296|
000050  68a8              LDR      r0,[r5,#8]  ; GUITASK__EntranceCnt
000052  b378              CBZ      r0,|L1.180|
;;;141        GUI_X_Lock();
;;;142        _TaskIDLock = GUI_X_GetTaskId();         /* Save task ID */
;;;143      } else {
;;;144        if (_TaskIDLock != GUI_X_GetTaskId()) {
000054  f7fffffe          BL       GUI_X_GetTaskId
000058  6869              LDR      r1,[r5,#4]  ; _TaskIDLock
00005a  4288              CMP      r0,r1
00005c  d004              BEQ      |L1.104|
;;;145          GUI_X_Lock();
00005e  f7fffffe          BL       GUI_X_Lock
;;;146          _TaskIDLock = GUI_X_GetTaskId();         /* Save task ID */
000062  f7fffffe          BL       GUI_X_GetTaskId
000066  6068              STR      r0,[r5,#4]  ; _TaskIDLock
                  |L1.104|
;;;147        }
;;;148      }
;;;149      if (++GUITASK__EntranceCnt == 1) {
000068  68a8              LDR      r0,[r5,#8]  ; GUITASK__EntranceCnt
00006a  1c40              ADDS     r0,r0,#1
00006c  60a8              STR      r0,[r5,#8]  ; GUITASK__EntranceCnt
00006e  2801              CMP      r0,#1
000070  d11f              BNE      |L1.178|
;;;150        int TaskNo = _GetTaskNo();
000072  f7fffffe          BL       _GetTaskNo
000076  4604              MOV      r4,r0
;;;151        if (TaskNo != _CurrentTaskNo) {
000078  6829              LDR      r1,[r5,#0]  ; _CurrentTaskNo
00007a  428c              CMP      r4,r1
00007c  d019              BEQ      |L1.178|
;;;152          /* Save data of current task */
;;;153          if (_CurrentTaskNo>=0) {  /* Make sure _CurrentTaskNo is valid */
00007e  2900              CMP      r1,#0
000080  db16              BLT      |L1.176|
;;;154            _Save[_CurrentTaskNo].Context = GUI_Context;
000082  eb010081          ADD      r0,r1,r1,LSL #2
000086  eb0000c1          ADD      r0,r0,r1,LSL #3
00008a  4e26              LDR      r6,|L1.292|
00008c  2264              MOVS     r2,#0x64
00008e  eb0600c0          ADD      r0,r6,r0,LSL #3
000092  1d00              ADDS     r0,r0,#4
000094  4925              LDR      r1,|L1.300|
000096  f7fffffe          BL       __aeabi_memcpy4
;;;155            /* Load data of this task */
;;;156            GUI_Context = _Save[TaskNo].Context;
00009a  eb040084          ADD      r0,r4,r4,LSL #2
00009e  eb0000c4          ADD      r0,r0,r4,LSL #3
0000a2  eb0600c0          ADD      r0,r6,r0,LSL #3
0000a6  1d01              ADDS     r1,r0,#4
0000a8  2264              MOVS     r2,#0x64
0000aa  4820              LDR      r0,|L1.300|
0000ac  f7fffffe          BL       __aeabi_memcpy4
                  |L1.176|
;;;157          }
;;;158          _CurrentTaskNo = TaskNo;
0000b0  602c              STR      r4,[r5,#0]  ; _CurrentTaskNo
                  |L1.178|
;;;159        }
;;;160      }
;;;161      /* Test if GUITASK__EntranceCnt is in reasonable range ... Not required in release builds */
;;;162      GUI_DEBUG_ERROROUT_IF((GUITASK__EntranceCnt > GUI_MAX_LOCK_NESTING), "GUITASK.c: GUI_Lock() GUITASK__EntranceCnt overflow ");
;;;163    }
0000b2  bd70              POP      {r4-r6,pc}
                  |L1.180|
0000b4  e7ff              B        |L1.182|
                  |L1.182|
0000b6  f7fffffe          BL       GUI_X_Lock
0000ba  f7fffffe          BL       GUI_X_GetTaskId
0000be  6068              STR      r0,[r5,#4]            ;142  ; _TaskIDLock
0000c0  e7d2              B        |L1.104|
;;;164    
                          ENDP

                  GUITASK_Init PROC
;;;168    */
;;;169    void GUITASK_Init(void) {
0000c2  4919              LDR      r1,|L1.296|
;;;170      _CurrentTaskNo =-1;   /* Invalidate */
0000c4  f04f30ff          MOV      r0,#0xffffffff
0000c8  6008              STR      r0,[r1,#0]  ; _CurrentTaskNo
;;;171      GUI_X_InitOS();
0000ca  f7ffbffe          B.W      GUI_X_InitOS
;;;172    }
;;;173    
                          ENDP

                  GUITASK_CopyContext PROC
;;;178    */
;;;179    void GUITASK_CopyContext(void) {
0000ce  e92d41f0          PUSH     {r4-r8,lr}
;;;180      int i;
;;;181      for (i = 0; i < GUI_MAXTASK; i++) {
0000d2  2400              MOVS     r4,#0
;;;182        _Save[i].Context = GUI_Context;
0000d4  4e13              LDR      r6,|L1.292|
0000d6  2700              MOVS     r7,#0                 ;181
                  |L1.216|
0000d8  eb040084          ADD      r0,r4,r4,LSL #2
0000dc  eb0005c4          ADD      r5,r0,r4,LSL #3
0000e0  eb0600c5          ADD      r0,r6,r5,LSL #3
0000e4  1d00              ADDS     r0,r0,#4
0000e6  2264              MOVS     r2,#0x64
0000e8  4910              LDR      r1,|L1.300|
0000ea  f7fffffe          BL       __aeabi_memcpy4
;;;183        _Save[i].TaskID  = 0;
0000ee  f8467035          STR      r7,[r6,r5,LSL #3]
0000f2  1c64              ADDS     r4,r4,#1              ;181
0000f4  2c04              CMP      r4,#4                 ;181
0000f6  dbef              BLT      |L1.216|
;;;184      }
;;;185    }
0000f8  e8bd81f0          POP      {r4-r8,pc}
;;;186    
                          ENDP

                  GUITASK_GetpContext PROC
;;;191    */
;;;192    GUI_CONTEXT * GUITASK_GetpContext(int Index) {
0000fc  b570              PUSH     {r4-r6,lr}
0000fe  4604              MOV      r4,r0
;;;193      GUI_CONTEXT * pContext;
;;;194      pContext = NULL;
000100  2500              MOVS     r5,#0
;;;195      GUI_Lock();
000102  f7fffffe          BL       GUI_Lock
;;;196      if (Index < GUI_MAXTASK) {
000106  2c04              CMP      r4,#4
000108  da07              BGE      |L1.282|
;;;197        pContext = &_Save[Index].Context;
00010a  eb040084          ADD      r0,r4,r4,LSL #2
00010e  4905              LDR      r1,|L1.292|
000110  eb0000c4          ADD      r0,r0,r4,LSL #3
000114  eb0100c0          ADD      r0,r1,r0,LSL #3
000118  1d05              ADDS     r5,r0,#4
                  |L1.282|
;;;198      }
;;;199      GUI_Unlock();
00011a  f7fffffe          BL       GUI_Unlock
;;;200      return pContext;
00011e  4628              MOV      r0,r5
;;;201    }
000120  bd70              POP      {r4-r6,pc}
;;;202    
                          ENDP

000122  0000              DCW      0x0000
                  |L1.292|
                          DCD      ||.bss||
                  |L1.296|
                          DCD      ||.data||
                  |L1.300|
                          DCD      GUI_Context

                          AREA ||.bss||, DATA, NOINIT, ALIGN=6

                  _Save
                          %        416

                          AREA ||.data||, DATA, ALIGN=2

                  _CurrentTaskNo
                          DCD      0xffffffff
                  _TaskIDLock
                          DCD      0x00000000
                  GUITASK__EntranceCnt
                          DCD      0x00000000
