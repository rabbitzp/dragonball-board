; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\gui_uc_dispstring.o --depend=.\rvmdk\gui_uc_dispstring.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\gui_uc_dispstring.crf ..\..\..\..\..\uCGUI\GUI\Core\GUI_UC_DispString.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  _GetLineDistX PROC
;;;32     */
;;;33     static int _GetLineDistX(const U16 GUI_UNI_PTR *s, int MaxNumChars) {
000000  b570              PUSH     {r4-r6,lr}
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;34       int Dist =0;
000006  2600              MOVS     r6,#0
;;;35       if (s) {
000008  b92c              CBNZ     r4,|L1.22|
00000a  e008              B        |L1.30|
                  |L1.12|
;;;36         U16 Char;
;;;37         while (((Char = *s) != 0) && MaxNumChars >= 0) {
;;;38           s++;
00000c  1ca4              ADDS     r4,r4,#2
;;;39           MaxNumChars--;
00000e  1e6d              SUBS     r5,r5,#1
;;;40           Dist += GUI_GetCharDistX(Char);
000010  f7fffffe          BL       GUI_GetCharDistX
000014  4406              ADD      r6,r6,r0
                  |L1.22|
000016  8820              LDRH     r0,[r4,#0]            ;37
000018  b108              CBZ      r0,|L1.30|
00001a  2d00              CMP      r5,#0                 ;37
00001c  daf6              BGE      |L1.12|
                  |L1.30|
;;;41         }
;;;42       }
;;;43       return Dist;
00001e  4630              MOV      r0,r6
;;;44     }
000020  bd70              POP      {r4-r6,pc}
;;;45     
                          ENDP

                  _GetLineLen PROC
;;;49     */
;;;50     static int _GetLineLen(const U16 GUI_UNI_PTR *s, int MaxLen) {
000022  2200              MOVS     r2,#0
;;;51       int Len =0;
;;;52       if (!s)
000024  b918              CBNZ     r0,|L1.46|
;;;53         return 0;
000026  2000              MOVS     r0,#0
;;;54       {
;;;55         while ((*s !=0) && Len < MaxLen) {
;;;56           Len++; s++;
;;;57         }
;;;58       }
;;;59       return Len;
;;;60     }
000028  4770              BX       lr
                  |L1.42|
00002a  1c52              ADDS     r2,r2,#1              ;56
00002c  1c80              ADDS     r0,r0,#2              ;56
                  |L1.46|
00002e  8803              LDRH     r3,[r0,#0]            ;55
000030  b10b              CBZ      r3,|L1.54|
000032  428a              CMP      r2,r1                 ;55
000034  dbf9              BLT      |L1.42|
                  |L1.54|
000036  4610              MOV      r0,r2                 ;59
000038  4770              BX       lr
;;;61     
                          ENDP

                  _DispLine_UC PROC
;;;65     */
;;;66     static void _DispLine_UC(const U16 GUI_UNI_PTR *s, int Len, const GUI_RECT *pRect) {
00003a  b570              PUSH     {r4-r6,lr}
00003c  460d              MOV      r5,r1
00003e  4604              MOV      r4,r0
000040  4611              MOV      r1,r2
;;;67       if (GUI_Context.pClipRect_HL) {
000042  4863              LDR      r0,|L1.464|
000044  6940              LDR      r0,[r0,#0x14]  ; GUI_Context
000046  b118              CBZ      r0,|L1.80|
;;;68         if (GUI_RectsIntersect(GUI_Context.pClipRect_HL, pRect) == 0)
000048  f7fffffe          BL       GUI_RectsIntersect
00004c  2800              CMP      r0,#0
00004e  d007              BEQ      |L1.96|
                  |L1.80|
;;;69           return;
;;;70       }
;;;71       {
;;;72         U16 c0;
;;;73         while (--Len >=0) {
000050  1e6d              SUBS     r5,r5,#1
000052  d405              BMI      |L1.96|
                  |L1.84|
;;;74           c0=*s++;
000054  f8340b02          LDRH     r0,[r4],#2
;;;75           GL_DispChar(c0);
000058  f7fffffe          BL       GL_DispChar
00005c  1e6d              SUBS     r5,r5,#1              ;73
00005e  d5f9              BPL      |L1.84|
                  |L1.96|
;;;76         }
;;;77       }
;;;78     }
000060  bd70              POP      {r4-r6,pc}
;;;79     
                          ENDP

                  _DispLine PROC
;;;83     */
;;;84     static void _DispLine(const U16 GUI_UNI_PTR *s, int Len, const GUI_RECT* pr) {
000062  b570              PUSH     {r4-r6,lr}
000064  b082              SUB      sp,sp,#8
000066  4605              MOV      r5,r0
000068  460e              MOV      r6,r1
;;;85       GUI_RECT r;
;;;86       r = *pr;
00006a  6810              LDR      r0,[r2,#0]
00006c  9000              STR      r0,[sp,#0]
00006e  6850              LDR      r0,[r2,#4]
000070  9001              STR      r0,[sp,#4]
;;;87       #if GUI_WINSUPPORT
;;;88       WM_ADDORG(r.x0,r.y0);
000072  4c57              LDR      r4,|L1.464|
000074  f8bd1000          LDRH     r1,[sp,#0]
000078  6c60              LDR      r0,[r4,#0x44]  ; GUI_Context
00007a  4401              ADD      r1,r1,r0
00007c  f8ad1000          STRH     r1,[sp,#0]
000080  f8bd2002          LDRH     r2,[sp,#2]
000084  6ca1              LDR      r1,[r4,#0x48]  ; GUI_Context
000086  440a              ADD      r2,r2,r1
000088  f8ad2002          STRH     r2,[sp,#2]
;;;89       WM_ADDORG(r.x1,r.y1);
00008c  f8bd2004          LDRH     r2,[sp,#4]
000090  4410              ADD      r0,r0,r2
000092  f8ad0004          STRH     r0,[sp,#4]
000096  f8bd0006          LDRH     r0,[sp,#6]
00009a  4408              ADD      r0,r0,r1
00009c  f8ad0006          STRH     r0,[sp,#6]
;;;90       WM_ITERATE_START(&r) {
0000a0  4668              MOV      r0,sp
0000a2  f7fffffe          BL       WM__InitIVRSearch
0000a6  b170              CBZ      r0,|L1.198|
                  |L1.168|
;;;91       #endif
;;;92          GUI_Context.DispPosX = r.x0;
0000a8  f8bd0000          LDRH     r0,[sp,#0]
0000ac  84e0              STRH     r0,[r4,#0x26]
;;;93          GUI_Context.DispPosY = r.y0;
0000ae  f8bd0002          LDRH     r0,[sp,#2]
0000b2  8520              STRH     r0,[r4,#0x28]
;;;94          _DispLine_UC(s, Len, &r);    /* Do the actual drawing via routine call. */
0000b4  466a              MOV      r2,sp
0000b6  4631              MOV      r1,r6
0000b8  4628              MOV      r0,r5
0000ba  f7fffffe          BL       _DispLine_UC
;;;95       #if GUI_WINSUPPORT
;;;96       } WM_ITERATE_END();
0000be  f7fffffe          BL       WM__GetNextIVR
0000c2  2800              CMP      r0,#0
0000c4  d1f0              BNE      |L1.168|
                  |L1.198|
;;;97       WM_SUBORG(GUI_Context.DispPosX, GUI_Context.DispPosY);
0000c6  8ce0              LDRH     r0,[r4,#0x26]  ; GUI_Context
0000c8  6c61              LDR      r1,[r4,#0x44]  ; GUI_Context
0000ca  1a40              SUBS     r0,r0,r1
0000cc  84e0              STRH     r0,[r4,#0x26]
0000ce  8d20              LDRH     r0,[r4,#0x28]  ; GUI_Context
0000d0  6ca1              LDR      r1,[r4,#0x48]  ; GUI_Context
0000d2  1a40              SUBS     r0,r0,r1
0000d4  8520              STRH     r0,[r4,#0x28]
;;;98       #endif
;;;99     }
0000d6  b002              ADD      sp,sp,#8
0000d8  bd70              POP      {r4-r6,pc}
;;;100    
                          ENDP

                  GUI_UC_DispString PROC
;;;110    */
;;;111    void GUI_UC_DispString(const U16 GUI_UNI_PTR *s) {
0000da  e92d47f0          PUSH     {r4-r10,lr}
0000de  b082              SUB      sp,sp,#8
0000e0  4604              MOV      r4,r0
;;;112      int xAdjust, yAdjust, xOrg;
;;;113      int FontSizeY;
;;;114      if (!s)
0000e2  2c00              CMP      r4,#0
0000e4  d070              BEQ      |L1.456|
;;;115        return;
;;;116      GUI_LOCK();
0000e6  f7fffffe          BL       GUI_Lock
;;;117      FontSizeY = GUI_Context.pAFont->YSize;
0000ea  4e39              LDR      r6,|L1.464|
0000ec  69f0              LDR      r0,[r6,#0x1c]  ; GUI_Context
0000ee  7d07              LDRB     r7,[r0,#0x14]
;;;118      xOrg = GUI_Context.DispPosX;
0000f0  f9b65026          LDRSH    r5,[r6,#0x26]  ; GUI_Context
;;;119     /* Adjust vertical position */
;;;120      yAdjust = GUI_GetYAdjust();
0000f4  f7fffffe          BL       GUI_GetYAdjust
0000f8  4681              MOV      r9,r0
;;;121      GUI_Context.DispPosY -= yAdjust;
0000fa  8d31              LDRH     r1,[r6,#0x28]  ; GUI_Context
0000fc  eba10009          SUB      r0,r1,r9
000100  8530              STRH     r0,[r6,#0x28]
;;;122      for (; *s; s++) {
000102  8820              LDRH     r0,[r4,#0]
000104  b3d8              CBZ      r0,|L1.382|
;;;123        GUI_RECT r;
;;;124        int LineLen= _GetLineLen(s,0x7fff);
;;;125        int xLineSize = _GetLineDistX(s, LineLen);
;;;126      /* Check if x-position needs to be changed due to h-alignment */
;;;127        switch (GUI_Context.TextAlign & GUI_TA_HORIZONTAL) { 
;;;128        case GUI_TA_CENTER: xAdjust= xLineSize/2; break;
;;;129        case GUI_TA_RIGHT:  xAdjust= xLineSize; break;
;;;130        default:            xAdjust= 0;
;;;131        }
;;;132        r.x0 = GUI_Context.DispPosX -= xAdjust;
;;;133        r.x1 = r.x0 + xLineSize-1;    
;;;134        r.y0 = GUI_Context.DispPosY;
;;;135        r.y1 = r.y0 + FontSizeY-1;    
000106  1e7f              SUBS     r7,r7,#1
;;;136        _DispLine(s, LineLen, &r);
;;;137        GUI_Context.DispPosY = r.y0;
;;;138        s += LineLen;
;;;139        if (*s=='\n') {
;;;140          switch (GUI_Context.TextAlign & GUI_TA_HORIZONTAL) { 
;;;141          case GUI_TA_CENTER:
;;;142          case GUI_TA_RIGHT:
;;;143            GUI_Context.DispPosX = xOrg;
000108  fa0ff885          SXTH     r8,r5
                  |L1.268|
00010c  f64771ff          MOV      r1,#0x7fff            ;124
000110  4620              MOV      r0,r4                 ;124
000112  f7fffffe          BL       _GetLineLen
000116  4682              MOV      r10,r0                ;124
000118  4651              MOV      r1,r10                ;125
00011a  4620              MOV      r0,r4                 ;125
00011c  f7fffffe          BL       _GetLineDistX
000120  4605              MOV      r5,r0                 ;125
000122  8e30              LDRH     r0,[r6,#0x30]         ;127  ; GUI_Context
000124  f0000003          AND      r0,r0,#3              ;127
000128  2801              CMP      r0,#1                 ;127
00012a  d038              BEQ      |L1.414|
00012c  2802              CMP      r0,#2                 ;127
00012e  d032              BEQ      |L1.406|
000130  2000              MOVS     r0,#0                 ;130
                  |L1.306|
000132  8cf1              LDRH     r1,[r6,#0x26]         ;132  ; GUI_Context
000134  1a08              SUBS     r0,r1,r0              ;132
000136  84f0              STRH     r0,[r6,#0x26]         ;132
000138  f8ad0000          STRH     r0,[sp,#0]            ;132
00013c  1e69              SUBS     r1,r5,#1              ;133
00013e  4408              ADD      r0,r0,r1              ;133
000140  f8ad0004          STRH     r0,[sp,#4]            ;133
000144  8d30              LDRH     r0,[r6,#0x28]         ;134  ; GUI_Context
000146  f8ad0002          STRH     r0,[sp,#2]            ;134
00014a  4438              ADD      r0,r0,r7              ;135
00014c  f8ad0006          STRH     r0,[sp,#6]            ;135
000150  466a              MOV      r2,sp                 ;136
000152  4651              MOV      r1,r10                ;136
000154  4620              MOV      r0,r4                 ;136
000156  f7fffffe          BL       _DispLine
00015a  f8bd0002          LDRH     r0,[sp,#2]            ;137
00015e  8530              STRH     r0,[r6,#0x28]         ;137
000160  eb04044a          ADD      r4,r4,r10,LSL #1      ;138
000164  8820              LDRH     r0,[r4,#0]            ;139
000166  280a              CMP      r0,#0xa               ;139
000168  d01b              BEQ      |L1.418|
;;;144            break;
;;;145          default:
;;;146            GUI_Context.DispPosX = GUI_Context.LBorder;
;;;147            break;
;;;148          }
;;;149          GUI_Context.DispPosY += GUI_GetFontDistY();
;;;150        } else {
;;;151          GUI_Context.DispPosX = r.x0+xLineSize;
00016a  f8bd0000          LDRH     r0,[sp,#0]
00016e  4428              ADD      r0,r0,r5
000170  84f0              STRH     r0,[r6,#0x26]
                  |L1.370|
;;;152        }
;;;153        if (*s==0)    /* end of string (last line) reached ? */
000172  8820              LDRH     r0,[r4,#0]
000174  b118              CBZ      r0,|L1.382|
000176  1ca4              ADDS     r4,r4,#2              ;122
000178  8820              LDRH     r0,[r4,#0]            ;122
00017a  2800              CMP      r0,#0                 ;122
00017c  d1c6              BNE      |L1.268|
                  |L1.382|
;;;154          break;
;;;155      }
;;;156      GUI_Context.DispPosY += yAdjust;
00017e  8d30              LDRH     r0,[r6,#0x28]  ; GUI_Context
000180  4448              ADD      r0,r0,r9
000182  8530              STRH     r0,[r6,#0x28]
;;;157      GUI_Context.TextAlign &= ~GUI_TA_HORIZONTAL;
000184  8e30              LDRH     r0,[r6,#0x30]  ; GUI_Context
000186  f0200003          BIC      r0,r0,#3
00018a  8630              STRH     r0,[r6,#0x30]
;;;158      GUI_UNLOCK();
00018c  b002              ADD      sp,sp,#8
00018e  e8bd47f0          POP      {r4-r10,lr}
000192  f7ffbffe          B.W      GUI_Unlock
                  |L1.406|
000196  eb0570d5          ADD      r0,r5,r5,LSR #31      ;128
00019a  1040              ASRS     r0,r0,#1              ;128
00019c  e7c9              B        |L1.306|
                  |L1.414|
00019e  4628              MOV      r0,r5                 ;129
0001a0  e7c7              B        |L1.306|
                  |L1.418|
0001a2  8e30              LDRH     r0,[r6,#0x30]         ;140  ; GUI_Context
0001a4  f0000003          AND      r0,r0,#3              ;140
0001a8  2801              CMP      r0,#1                 ;140
0001aa  d009              BEQ      |L1.448|
0001ac  2802              CMP      r0,#2                 ;140
0001ae  d007              BEQ      |L1.448|
0001b0  8cb0              LDRH     r0,[r6,#0x24]         ;146  ; GUI_Context
0001b2  84f0              STRH     r0,[r6,#0x26]         ;146
                  |L1.436|
0001b4  f7fffffe          BL       GUI_GetFontDistY
0001b8  8d31              LDRH     r1,[r6,#0x28]         ;149  ; GUI_Context
0001ba  4408              ADD      r0,r0,r1              ;149
0001bc  8530              STRH     r0,[r6,#0x28]         ;149
0001be  e7d8              B        |L1.370|
                  |L1.448|
0001c0  f8a68026          STRH     r8,[r6,#0x26]         ;143
0001c4  e7f6              B        |L1.436|
0001c6  e7ff              B        |L1.456|
                  |L1.456|
;;;159    }
0001c8  b002              ADD      sp,sp,#8
0001ca  e8bd87f0          POP      {r4-r10,pc}
;;;160    
                          ENDP

0001ce  0000              DCW      0x0000
                  |L1.464|
                          DCD      GUI_Context
