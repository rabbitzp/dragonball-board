; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\gui_dispstringinrect.o --depend=.\rvmdk\gui_dispstringinrect.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\gui_dispstringinrect.crf ..\..\..\..\..\uCGUI\GUI\Core\GUI_DispStringInRect.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  GUI__DispStringInRect PROC
;;;36     */
;;;37     void GUI__DispStringInRect(const char GUI_UNI_PTR *s, GUI_RECT* pRect, int TextAlign, int MaxNumChars) {
000000  e92d4fff          PUSH     {r0-r11,lr}
000004  b085              SUB      sp,sp,#0x14
000006  460e              MOV      r6,r1
000008  4617              MOV      r7,r2
00000a  469b              MOV      r11,r3
;;;38       GUI_RECT r;
;;;39       GUI_RECT rLine;
;;;40       int y = 0;
00000c  2400              MOVS     r4,#0
;;;41       const char GUI_UNI_PTR *sOrg =s;
00000e  f8dda014          LDR      r10,[sp,#0x14]
;;;42       int FontYSize;
;;;43       int xLine = 0;
000012  2500              MOVS     r5,#0
;;;44       int LineLen;
;;;45       int NumCharsRem;           /* Number of remaining characters */
;;;46       FontYSize = GUI_GetFontDistY();
000014  f7fffffe          BL       GUI_GetFontDistY
000018  4680              MOV      r8,r0
;;;47       if (pRect) {
00001a  b126              CBZ      r6,|L1.38|
;;;48         r = *pRect;
00001c  6830              LDR      r0,[r6,#0]
00001e  9002              STR      r0,[sp,#8]
000020  6870              LDR      r0,[r6,#4]
000022  9003              STR      r0,[sp,#0xc]
000024  e002              B        |L1.44|
                  |L1.38|
;;;49       } else {
;;;50         GUI_GetClientRect(&r);
000026  a802              ADD      r0,sp,#8
000028  f7fffffe          BL       GUI_GetClientRect
                  |L1.44|
;;;51       }
;;;52       /* handle vertical alignment */
;;;53       if ((TextAlign & GUI_TA_VERTICAL) == GUI_TA_TOP) {
00002c  f0170f0c          TST      r7,#0xc
000030  d014              BEQ      |L1.92|
;;;54     		y = r.y0;
;;;55       } else {
;;;56         int NumLines;
;;;57         /* Count the number of lines */
;;;58         for (NumCharsRem = MaxNumChars, NumLines = 1; NumCharsRem ;NumLines++) {
000032  465e              MOV      r6,r11
000034  f04f0901          MOV      r9,#1
000038  b1be              CBZ      r6,|L1.106|
                  |L1.58|
;;;59           LineLen = GUI__GetLineNumChars(s, NumCharsRem);
00003a  4631              MOV      r1,r6
00003c  9805              LDR      r0,[sp,#0x14]
00003e  f7fffffe          BL       GUI__GetLineNumChars
;;;60           NumCharsRem -= LineLen;
000042  1a36              SUBS     r6,r6,r0
;;;61           s += GUI_UC__NumChars2NumBytes(s, LineLen);
000044  4601              MOV      r1,r0
000046  9805              LDR      r0,[sp,#0x14]
000048  f7fffffe          BL       GUI_UC__NumChars2NumBytes
00004c  9905              LDR      r1,[sp,#0x14]
00004e  4408              ADD      r0,r0,r1
000050  9005              STR      r0,[sp,#0x14]
;;;62           if (GUI__HandleEOLine(&s))
000052  a805              ADD      r0,sp,#0x14
000054  f7fffffe          BL       GUI__HandleEOLine
000058  b938              CBNZ     r0,|L1.106|
00005a  e002              B        |L1.98|
                  |L1.92|
00005c  f9bd400a          LDRSH    r4,[sp,#0xa]          ;54
000060  e01e              B        |L1.160|
                  |L1.98|
000062  f1090901          ADD      r9,r9,#1              ;58
000066  2e00              CMP      r6,#0                 ;58
000068  d1e7              BNE      |L1.58|
                  |L1.106|
;;;63             break;
;;;64         }
;;;65         /* Do the vertical alignment */
;;;66         switch (TextAlign & GUI_TA_VERTICAL) {
00006a  f007000c          AND      r0,r7,#0xc
00006e  2804              CMP      r0,#4
000070  d004              BEQ      |L1.124|
000072  2808              CMP      r0,#8
000074  d002              BEQ      |L1.124|
000076  280c              CMP      r0,#0xc
000078  d112              BNE      |L1.160|
00007a  e005              B        |L1.136|
                  |L1.124|
;;;67     	  case GUI_TA_BASELINE:
;;;68     	  case GUI_TA_BOTTOM:
;;;69     	  y = r.y1 -NumLines * FontYSize+1;
00007c  f9bd000e          LDRSH    r0,[sp,#0xe]
000080  fb090018          MLS      r0,r9,r8,r0
000084  1c44              ADDS     r4,r0,#1
;;;70           break;
000086  e00b              B        |L1.160|
                  |L1.136|
;;;71     	  case GUI_TA_VCENTER:
;;;72     		  y = r.y0+(r.y1-r.y0+1 -NumLines * FontYSize) /2;
000088  f9bd100e          LDRSH    r1,[sp,#0xe]
00008c  f9bd000a          LDRSH    r0,[sp,#0xa]
000090  1a09              SUBS     r1,r1,r0
000092  fb091118          MLS      r1,r9,r8,r1
000096  1c49              ADDS     r1,r1,#1
000098  eb0171d1          ADD      r1,r1,r1,LSR #31
00009c  eb000461          ADD      r4,r0,r1,ASR #1
                  |L1.160|
;;;73           break;
;;;74     	  }
;;;75       }
;;;76       /* Output string */
;;;77       for (NumCharsRem = MaxNumChars, s = sOrg; NumCharsRem;) {
0000a0  465e              MOV      r6,r11
0000a2  f8cda014          STR      r10,[sp,#0x14]
0000a6  2e00              CMP      r6,#0
0000a8  d04d              BEQ      |L1.326|
;;;78         int xLineSize;
;;;79         LineLen = GUI__GetLineNumChars(s, NumCharsRem);
;;;80         NumCharsRem -= LineLen;
;;;81         xLineSize = GUI__GetLineDistX(s, LineLen);
;;;82         switch (TextAlign & GUI_TA_HORIZONTAL) {
;;;83         case GUI_TA_HCENTER:
;;;84           xLine = r.x0+(r.x1-r.x0-xLineSize)/2; break;
;;;85         case GUI_TA_LEFT:
;;;86           xLine = r.x0; break;
;;;87         case GUI_TA_RIGHT:
;;;88           xLine = r.x1 -xLineSize + 1;
;;;89         }
;;;90         rLine.x0 = GUI_Context.DispPosX = xLine;
0000aa  f8dfa0f8          LDR      r10,|L1.420|
                  |L1.174|
0000ae  4631              MOV      r1,r6                 ;79
0000b0  9805              LDR      r0,[sp,#0x14]         ;79
0000b2  f7fffffe          BL       GUI__GetLineNumChars
0000b6  4681              MOV      r9,r0                 ;79
0000b8  eba60609          SUB      r6,r6,r9              ;80
0000bc  4649              MOV      r1,r9                 ;81
0000be  9805              LDR      r0,[sp,#0x14]         ;81
0000c0  f7fffffe          BL       GUI__GetLineDistX
0000c4  4601              MOV      r1,r0                 ;81
0000c6  f0170003          ANDS     r0,r7,#3              ;82
0000ca  d00e              BEQ      |L1.234|
0000cc  2801              CMP      r0,#1                 ;82
0000ce  d00f              BEQ      |L1.240|
0000d0  2802              CMP      r0,#2                 ;82
0000d2  d111              BNE      |L1.248|
0000d4  f9bd200c          LDRSH    r2,[sp,#0xc]          ;84
0000d8  f9bd0008          LDRSH    r0,[sp,#8]            ;84
0000dc  1a12              SUBS     r2,r2,r0              ;84
0000de  1a52              SUBS     r2,r2,r1              ;84
0000e0  eb0272d2          ADD      r2,r2,r2,LSR #31      ;84
0000e4  eb000562          ADD      r5,r0,r2,ASR #1       ;84
0000e8  e006              B        |L1.248|
                  |L1.234|
0000ea  f9bd5008          LDRSH    r5,[sp,#8]            ;86
0000ee  e003              B        |L1.248|
                  |L1.240|
0000f0  f9bd000c          LDRSH    r0,[sp,#0xc]          ;88
0000f4  1a40              SUBS     r0,r0,r1              ;88
0000f6  1c45              ADDS     r5,r0,#1              ;88
                  |L1.248|
0000f8  f8aa5026          STRH     r5,[r10,#0x26]
0000fc  f8ad5000          STRH     r5,[sp,#0]
;;;91         rLine.x1 = rLine.x0 + xLineSize-1;
000100  1e48              SUBS     r0,r1,#1
000102  4428              ADD      r0,r0,r5
000104  f8ad0004          STRH     r0,[sp,#4]
;;;92         rLine.y0 = GUI_Context.DispPosY = y;
000108  f8aa4028          STRH     r4,[r10,#0x28]
00010c  f8ad4002          STRH     r4,[sp,#2]
;;;93         rLine.y1 = y + FontYSize-1;
000110  eb040008          ADD      r0,r4,r8
000114  1e40              SUBS     r0,r0,#1
000116  f8ad0006          STRH     r0,[sp,#6]
;;;94         GUI__DispLine(s, LineLen, &rLine);
00011a  466a              MOV      r2,sp
00011c  4649              MOV      r1,r9
00011e  9805              LDR      r0,[sp,#0x14]
000120  f7fffffe          BL       GUI__DispLine
;;;95         s += GUI_UC__NumChars2NumBytes(s, LineLen);
000124  4649              MOV      r1,r9
000126  9805              LDR      r0,[sp,#0x14]
000128  f7fffffe          BL       GUI_UC__NumChars2NumBytes
00012c  9905              LDR      r1,[sp,#0x14]
00012e  4408              ADD      r0,r0,r1
000130  9005              STR      r0,[sp,#0x14]
;;;96         y += GUI_GetFontDistY();
000132  f7fffffe          BL       GUI_GetFontDistY
000136  4404              ADD      r4,r4,r0
;;;97         if (GUI__HandleEOLine(&s))
000138  a805              ADD      r0,sp,#0x14
00013a  f7fffffe          BL       GUI__HandleEOLine
00013e  2800              CMP      r0,#0
000140  d101              BNE      |L1.326|
000142  2e00              CMP      r6,#0                 ;77
000144  d1b3              BNE      |L1.174|
                  |L1.326|
;;;98           break;
;;;99       }
;;;100    }
000146  b009              ADD      sp,sp,#0x24
000148  e8bd8ff0          POP      {r4-r11,pc}
;;;101    
                          ENDP

                  GUI_DispStringInRectMax PROC
;;;106    #if (GUI_WINSUPPORT)
;;;107    void GUI_DispStringInRectMax(const char GUI_UNI_PTR *s, GUI_RECT* pRect, int TextAlign, int MaxLen) {
00014c  e92d41f0          PUSH     {r4-r8,lr}
000150  b082              SUB      sp,sp,#8
000152  4606              MOV      r6,r0
000154  460d              MOV      r5,r1
000156  4617              MOV      r7,r2
000158  4698              MOV      r8,r3
;;;108      if (s) {
00015a  2e00              CMP      r6,#0
00015c  d01b              BEQ      |L1.406|
;;;109        const GUI_RECT *pOldClipRect = NULL;
00015e  2400              MOVS     r4,#0
;;;110        GUI_RECT r;
;;;111        GUI_LOCK();
000160  f7fffffe          BL       GUI_Lock
;;;112        if (pRect) {
000164  b165              CBZ      r5,|L1.384|
;;;113          pOldClipRect = WM_SetUserClipRect(pRect);
000166  4628              MOV      r0,r5
000168  f7fffffe          BL       WM_SetUserClipRect
00016c  4604              MOV      r4,r0
;;;114          if (pOldClipRect) {
00016e  b13c              CBZ      r4,|L1.384|
;;;115            GUI__IntersectRects(&r, pRect, pOldClipRect);
000170  4622              MOV      r2,r4
000172  4629              MOV      r1,r5
000174  4668              MOV      r0,sp
000176  f7fffffe          BL       GUI__IntersectRects
;;;116            WM_SetUserClipRect(&r);
00017a  4668              MOV      r0,sp
00017c  f7fffffe          BL       WM_SetUserClipRect
                  |L1.384|
;;;117          }
;;;118        }
;;;119        GUI__DispStringInRect(s, pRect, TextAlign, MaxLen);
000180  4643              MOV      r3,r8
000182  463a              MOV      r2,r7
000184  4629              MOV      r1,r5
000186  4630              MOV      r0,r6
000188  f7fffffe          BL       GUI__DispStringInRect
;;;120        WM_SetUserClipRect(pOldClipRect);
00018c  4620              MOV      r0,r4
00018e  f7fffffe          BL       WM_SetUserClipRect
;;;121        GUI_UNLOCK();
000192  f7fffffe          BL       GUI_Unlock
                  |L1.406|
;;;122      }
;;;123    }
000196  b002              ADD      sp,sp,#8
000198  e8bd81f0          POP      {r4-r8,pc}
;;;124    
                          ENDP

                  GUI_DispStringInRect PROC
;;;144    */
;;;145    void GUI_DispStringInRect(const char GUI_UNI_PTR *s, GUI_RECT* pRect, int TextAlign) {
00019c  f64773ff          MOV      r3,#0x7fff
;;;146      GUI_DispStringInRectMax(s, pRect, TextAlign, 0x7fff);
0001a0  e7fe              B        GUI_DispStringInRectMax
;;;147    }
;;;148    
                          ENDP

0001a2  0000              DCW      0x0000
                  |L1.420|
                          DCD      GUI_Context
