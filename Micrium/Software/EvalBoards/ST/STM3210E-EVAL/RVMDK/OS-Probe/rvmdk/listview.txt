; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\listview.o --depend=.\rvmdk\listview.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\listview.crf ..\..\..\..\..\uCGUI\GUI\Widget\LISTVIEW.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  LISTVIEW__GetNumRows PROC
;;;126    */
;;;127    unsigned LISTVIEW__GetNumRows(LISTVIEW_Obj* pObj) {
000000  302a              ADDS     r0,r0,#0x2a
;;;128      return GUI_ARRAY_GetNumItems(&pObj->RowArray);
000002  f7ffbffe          B.W      GUI_ARRAY_GetNumItems
;;;129    }
;;;130    
                          ENDP

                  LISTVIEW__GetNumColumns PROC
;;;134    */
;;;135    unsigned LISTVIEW__GetNumColumns(LISTVIEW_Obj* pObj) {
000006  302e              ADDS     r0,r0,#0x2e
;;;136      return GUI_ARRAY_GetNumItems(&pObj->ColumnArray);
000008  f7ffbffe          B.W      GUI_ARRAY_GetNumItems
;;;137    }
;;;138    
                          ENDP

                  LISTVIEW__GetSel PROC
;;;142    */
;;;143    int LISTVIEW__GetSel(LISTVIEW_Obj* pObj) {
00000c  6e00              LDR      r0,[r0,#0x60]
;;;144      return pObj->Sel;
;;;145    }
00000e  4770              BX       lr
;;;146    
                          ENDP

                  LISTVIEW__GetRowDistY PROC
;;;213    */
;;;214    unsigned LISTVIEW__GetRowDistY(const LISTVIEW_Obj* pObj) {
000010  b510              PUSH     {r4,lr}
000012  4604              MOV      r4,r0
;;;215      unsigned RowDistY;
;;;216      if (pObj->RowDistY) {
000014  6ee0              LDR      r0,[r4,#0x6c]
000016  2800              CMP      r0,#0
000018  d106              BNE      |L1.40|
;;;217        RowDistY = pObj->RowDistY;
;;;218      } else {
;;;219        RowDistY = GUI_GetYDistOfFont(pObj->Props.pFont);
00001a  6da0              LDR      r0,[r4,#0x58]
00001c  f7fffffe          BL       GUI_GetYDistOfFont
;;;220        if (pObj->ShowGrid) {
000020  6e61              LDR      r1,[r4,#0x64]
000022  2900              CMP      r1,#0
000024  d000              BEQ      |L1.40|
;;;221          RowDistY++;
000026  1c40              ADDS     r0,r0,#1
                  |L1.40|
;;;222        }
;;;223      }
;;;224      return RowDistY;
;;;225    }
000028  bd10              POP      {r4,pc}
;;;226    
                          ENDP

                  LISTVIEW__InvalidateRow PROC
;;;435    */
;;;436    void LISTVIEW__InvalidateRow(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int Sel) {
00002a  e92d41f0          PUSH     {r4-r8,lr}
00002e  b082              SUB      sp,sp,#8
000030  4607              MOV      r7,r0
000032  460c              MOV      r4,r1
000034  4615              MOV      r5,r2
;;;437      if (Sel >= 0) {
000036  2d00              CMP      r5,#0
000038  db1d              BLT      |L1.118|
;;;438        GUI_RECT Rect;
;;;439        int HeaderHeight, RowDistY;
;;;440        HeaderHeight = HEADER_GetHeight(pObj->hHeader);
00003a  f9b40028          LDRSH    r0,[r4,#0x28]
00003e  f7fffffe          BL       HEADER_GetHeight
000042  4680              MOV      r8,r0
;;;441        RowDistY     = LISTVIEW__GetRowDistY(pObj);
000044  4620              MOV      r0,r4
000046  f7fffffe          BL       LISTVIEW__GetRowDistY
00004a  4606              MOV      r6,r0
;;;442        WM_GetInsideRectExScrollbar(hObj, &Rect);
00004c  4669              MOV      r1,sp
00004e  4638              MOV      r0,r7
000050  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;443        Rect.y0 += HeaderHeight + (Sel - pObj->ScrollStateV.v) * RowDistY;
000054  6fe1              LDR      r1,[r4,#0x7c]
000056  f9bd0002          LDRSH    r0,[sp,#2]
00005a  1a69              SUBS     r1,r5,r1
00005c  fb010006          MLA      r0,r1,r6,r0
000060  4440              ADD      r0,r0,r8
000062  f8ad0002          STRH     r0,[sp,#2]
;;;444        Rect.y1  = Rect.y0 + RowDistY - 1;
000066  1e71              SUBS     r1,r6,#1
000068  4408              ADD      r0,r0,r1
00006a  f8ad0006          STRH     r0,[sp,#6]
;;;445        WM_InvalidateRect(hObj, &Rect);
00006e  4669              MOV      r1,sp
000070  4638              MOV      r0,r7
000072  f7fffffe          BL       WM_InvalidateRect
                  |L1.118|
;;;446      }
;;;447    }
000076  b002              ADD      sp,sp,#8
000078  e8bd81f0          POP      {r4-r8,pc}
;;;448    
                          ENDP

                  LISTVIEW__InvalidateInsideArea PROC
;;;422    */
;;;423    void LISTVIEW__InvalidateInsideArea(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj) {
00007c  b530              PUSH     {r4,r5,lr}
00007e  b083              SUB      sp,sp,#0xc
000080  4605              MOV      r5,r0
;;;424      GUI_RECT Rect;
;;;425      int HeaderHeight;
;;;426      HeaderHeight = HEADER_GetHeight(pObj->hHeader);
000082  f9b10028          LDRSH    r0,[r1,#0x28]
000086  f7fffffe          BL       HEADER_GetHeight
00008a  4604              MOV      r4,r0
;;;427      WM_GetInsideRectExScrollbar(hObj, &Rect);
00008c  4669              MOV      r1,sp
00008e  4628              MOV      r0,r5
000090  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;428      Rect.y0 += HeaderHeight;
000094  f8bd0002          LDRH     r0,[sp,#2]
000098  4420              ADD      r0,r0,r4
00009a  f8ad0002          STRH     r0,[sp,#2]
;;;429      WM_InvalidateRect(hObj, &Rect);
00009e  4669              MOV      r1,sp
0000a0  4628              MOV      r0,r5
0000a2  f7fffffe          BL       WM_InvalidateRect
;;;430    }
0000a6  b003              ADD      sp,sp,#0xc
0000a8  bd30              POP      {r4,r5,pc}
;;;431    
                          ENDP

                  LISTVIEW__UpdateScrollPos PROC
;;;558    */
;;;559    int LISTVIEW__UpdateScrollPos(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj) {
0000aa  b570              PUSH     {r4-r6,lr}
0000ac  4606              MOV      r6,r0
0000ae  460c              MOV      r4,r1
;;;560      int PrevScrollStateV;
;;;561      PrevScrollStateV = pObj->ScrollStateV.v;
0000b0  6fe5              LDR      r5,[r4,#0x7c]
;;;562      if (pObj->Sel >= 0) {
0000b2  6e21              LDR      r1,[r4,#0x60]
0000b4  2900              CMP      r1,#0
0000b6  db06              BLT      |L1.198|
;;;563        WM_CheckScrollPos(&pObj->ScrollStateV, pObj->Sel, 0, 0);
0000b8  2300              MOVS     r3,#0
0000ba  461a              MOV      r2,r3
0000bc  f1040078          ADD      r0,r4,#0x78
0000c0  f7fffffe          BL       WM_CheckScrollPos
0000c4  e003              B        |L1.206|
                  |L1.198|
;;;564      } else {
;;;565        WM_CheckScrollBounds(&pObj->ScrollStateV);
0000c6  f1040078          ADD      r0,r4,#0x78
0000ca  f7fffffe          BL       WM_CheckScrollBounds
                  |L1.206|
;;;566      }
;;;567      WM_CheckScrollBounds(&pObj->ScrollStateH);
0000ce  f1040084          ADD      r0,r4,#0x84
0000d2  f7fffffe          BL       WM_CheckScrollBounds
;;;568      WIDGET__SetScrollState(hObj, &pObj->ScrollStateV, &pObj->ScrollStateH);
0000d6  f1040284          ADD      r2,r4,#0x84
0000da  f1040178          ADD      r1,r4,#0x78
0000de  4630              MOV      r0,r6
0000e0  f7fffffe          BL       WIDGET__SetScrollState
;;;569      return pObj->ScrollStateV.v - PrevScrollStateV;
0000e4  6fe0              LDR      r0,[r4,#0x7c]
0000e6  1b40              SUBS     r0,r0,r5
;;;570    }
0000e8  bd70              POP      {r4-r6,pc}
;;;571    
                          ENDP

                  LISTVIEW__SetSel PROC
;;;150    */
;;;151    void LISTVIEW__SetSel(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int NewSel) {
0000ea  e92d41f0          PUSH     {r4-r8,lr}
0000ee  4606              MOV      r6,r0
0000f0  460d              MOV      r5,r1
0000f2  4614              MOV      r4,r2
;;;152      int NumRows;
;;;153      NumRows = LISTVIEW__GetNumRows(pObj);
0000f4  4628              MOV      r0,r5
0000f6  f7fffffe          BL       LISTVIEW__GetNumRows
;;;154      if (NewSel >= NumRows) {
0000fa  4284              CMP      r4,r0
0000fc  db00              BLT      |L1.256|
;;;155        NewSel = NumRows - 1;
0000fe  1e44              SUBS     r4,r0,#1
                  |L1.256|
;;;156      }
;;;157      if (NewSel < 0) {
000100  2c00              CMP      r4,#0
000102  da01              BGE      |L1.264|
;;;158        NewSel = -1;
000104  f04f34ff          MOV      r4,#0xffffffff
                  |L1.264|
;;;159      }
;;;160      if (NewSel != pObj->Sel) {
000108  6e28              LDR      r0,[r5,#0x60]
00010a  42a0              CMP      r0,r4
00010c  d026              BEQ      |L1.348|
;;;161        char Disabled;
;;;162        LISTVIEW_ROW * pRow;
;;;163        pRow = (LISTVIEW_ROW *)GUI_ARRAY_GetpItem(&pObj->RowArray, NewSel);
00010e  4621              MOV      r1,r4
000110  f105002a          ADD      r0,r5,#0x2a
000114  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;164        if (pRow) {
000118  b108              CBZ      r0,|L1.286|
;;;165          Disabled = pRow->Disabled;
00011a  7900              LDRB     r0,[r0,#4]
00011c  e000              B        |L1.288|
                  |L1.286|
;;;166        } else {
;;;167          Disabled = 0;
00011e  2000              MOVS     r0,#0
                  |L1.288|
;;;168        }
;;;169        if (Disabled == 0) {
000120  2800              CMP      r0,#0
000122  d11b              BNE      |L1.348|
;;;170          int OldSel;
;;;171          OldSel    = pObj->Sel;
000124  6e2f              LDR      r7,[r5,#0x60]
;;;172          pObj->Sel = NewSel;
000126  662c              STR      r4,[r5,#0x60]
;;;173          if (LISTVIEW__UpdateScrollPos(hObj, pObj)) {
000128  4629              MOV      r1,r5
00012a  4630              MOV      r0,r6
00012c  f7fffffe          BL       LISTVIEW__UpdateScrollPos
000130  b120              CBZ      r0,|L1.316|
;;;174            LISTVIEW__InvalidateInsideArea(hObj, pObj);
000132  4629              MOV      r1,r5
000134  4630              MOV      r0,r6
000136  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
00013a  e009              B        |L1.336|
                  |L1.316|
;;;175          } else {
;;;176            LISTVIEW__InvalidateRow(hObj, pObj, OldSel);
00013c  463a              MOV      r2,r7
00013e  4629              MOV      r1,r5
000140  4630              MOV      r0,r6
000142  f7fffffe          BL       LISTVIEW__InvalidateRow
;;;177            LISTVIEW__InvalidateRow(hObj, pObj, NewSel);
000146  4622              MOV      r2,r4
000148  4629              MOV      r1,r5
00014a  4630              MOV      r0,r6
00014c  f7fffffe          BL       LISTVIEW__InvalidateRow
                  |L1.336|
;;;178          }
;;;179          WM_NotifyParent(hObj, WM_NOTIFICATION_SEL_CHANGED);
000150  4630              MOV      r0,r6
000152  e8bd41f0          POP      {r4-r8,lr}
000156  2104              MOVS     r1,#4
000158  f7ffbffe          B.W      WM_NotifyParent
                  |L1.348|
;;;180        }
;;;181      }
;;;182    }
00015c  e8bd81f0          POP      {r4-r8,pc}
;;;183    
                          ENDP

                  LISTVIEW__MoveSel PROC
;;;189    */
;;;190    void LISTVIEW__MoveSel(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int Dir) {
000160  e92d47f0          PUSH     {r4-r10,lr}
000164  4681              MOV      r9,r0
000166  460e              MOV      r6,r1
000168  4617              MOV      r7,r2
;;;191      int Index, NewSel = -1, NumRows;
00016a  f04f35ff          MOV      r5,#0xffffffff
;;;192      Index   = LISTVIEW__GetSel(pObj);
00016e  4630              MOV      r0,r6
000170  f7fffffe          BL       LISTVIEW__GetSel
000174  4604              MOV      r4,r0
;;;193      NumRows = LISTVIEW__GetNumRows(pObj);
000176  4630              MOV      r0,r6
000178  f7fffffe          BL       LISTVIEW__GetNumRows
00017c  4680              MOV      r8,r0
                  |L1.382|
;;;194      do {
;;;195        LISTVIEW_ROW* pRow;
;;;196        Index += Dir;
00017e  443c              ADD      r4,r4,r7
;;;197        if ((Index < 0) || (Index >= NumRows)) {
000180  2c00              CMP      r4,#0
000182  db0b              BLT      |L1.412|
000184  4544              CMP      r4,r8
000186  da09              BGE      |L1.412|
;;;198          break;
;;;199        }
;;;200        pRow = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, Index);
000188  4621              MOV      r1,r4
00018a  f106002a          ADD      r0,r6,#0x2a
00018e  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;201        if (pRow->Disabled == 0) {
000192  7900              LDRB     r0,[r0,#4]
000194  b900              CBNZ     r0,|L1.408|
;;;202          NewSel = Index;
000196  4625              MOV      r5,r4
                  |L1.408|
;;;203        }
;;;204      } while (NewSel < 0);
000198  2d00              CMP      r5,#0
00019a  dbf0              BLT      |L1.382|
                  |L1.412|
;;;205      if (NewSel >= 0) {
00019c  2d00              CMP      r5,#0
00019e  db05              BLT      |L1.428|
;;;206        LISTVIEW__SetSel(hObj, pObj, NewSel);
0001a0  462a              MOV      r2,r5
0001a2  4631              MOV      r1,r6
0001a4  4648              MOV      r0,r9
0001a6  e8bd47f0          POP      {r4-r10,lr}
0001aa  e7fe              B        LISTVIEW__SetSel
                  |L1.428|
;;;207      }
;;;208    }
0001ac  e8bd87f0          POP      {r4-r10,pc}
;;;209    
                          ENDP

                  _GetNumVisibleRows PROC
;;;238    */
;;;239    static unsigned _GetNumVisibleRows(LISTVIEW_Handle hObj, const LISTVIEW_Obj* pObj) {
0001b0  b570              PUSH     {r4-r6,lr}
0001b2  b082              SUB      sp,sp,#8
0001b4  460e              MOV      r6,r1
;;;240      unsigned RowDistY, ySize, r = 1;
0001b6  2401              MOVS     r4,#1
;;;241      GUI_RECT Rect;
;;;242      WM_GetInsideRectExScrollbar(hObj, &Rect);
0001b8  4669              MOV      r1,sp
0001ba  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;243      ySize    = Rect.y1 - Rect.y0 + 1 - HEADER_GetHeight(pObj->hHeader);
0001be  f9b60028          LDRSH    r0,[r6,#0x28]
0001c2  f7fffffe          BL       HEADER_GetHeight
0001c6  f9bd2006          LDRSH    r2,[sp,#6]
0001ca  f9bd1002          LDRSH    r1,[sp,#2]
0001ce  1a51              SUBS     r1,r2,r1
0001d0  1a08              SUBS     r0,r1,r0
0001d2  1c45              ADDS     r5,r0,#1
;;;244      RowDistY = LISTVIEW__GetRowDistY(pObj);
0001d4  4630              MOV      r0,r6
0001d6  f7fffffe          BL       LISTVIEW__GetRowDistY
;;;245      if (RowDistY) {
0001da  b118              CBZ      r0,|L1.484|
;;;246        r = ySize / RowDistY;
0001dc  fbb5f4f0          UDIV     r4,r5,r0
;;;247        r = (r == 0) ? 1 : r;
0001e0  b904              CBNZ     r4,|L1.484|
0001e2  2401              MOVS     r4,#1
                  |L1.484|
;;;248      }
;;;249      return r;
;;;250    }
0001e4  b002              ADD      sp,sp,#8
0001e6  4620              MOV      r0,r4                 ;249
0001e8  bd70              POP      {r4-r6,pc}
;;;251    
                          ENDP

                  _GetpRow PROC
;;;255    */
;;;256    static LISTVIEW_ROW * _GetpRow(LISTVIEW_Obj * pObj, int Index) {
0001ea  b570              PUSH     {r4-r6,lr}
0001ec  4604              MOV      r4,r0
0001ee  460d              MOV      r5,r1
;;;257      if (pObj->hSort && (pObj->SortIndex >= 0)) {
0001f0  f9b40092          LDRSH    r0,[r4,#0x92]
0001f4  b1b8              CBZ      r0,|L1.550|
0001f6  6ea1              LDR      r1,[r4,#0x68]
0001f8  2900              CMP      r1,#0
0001fa  db14              BLT      |L1.550|
;;;258        LISTVIEW_SORT * pSort;
;;;259        SORT_TYPE * pData;
;;;260        pSort = (LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort);
0001fc  f7fffffe          BL       GUI_ALLOC_h2p
000200  4606              MOV      r6,r0
;;;261        pData = (SORT_TYPE *)GUI_ALLOC_h2p(pSort->hSortArray);
000202  f9b60000          LDRSH    r0,[r6,#0]
000206  f7fffffe          BL       GUI_ALLOC_h2p
00020a  4601              MOV      r1,r0
;;;262        if (Index >= pSort->SortArrayNumItems) {
00020c  8870              LDRH     r0,[r6,#2]
00020e  42a8              CMP      r0,r5
000210  dc01              BGT      |L1.534|
;;;263          return NULL;
000212  2000              MOVS     r0,#0
;;;264        }
;;;265        return (LISTVIEW_ROW *)GUI_ARRAY_GetpItem(&pObj->RowArray, *(pData + Index));
;;;266      } else {
;;;267        return (LISTVIEW_ROW *)GUI_ARRAY_GetpItem(&pObj->RowArray, Index);
;;;268      }
;;;269    }
000214  bd70              POP      {r4-r6,pc}
                  |L1.534|
000216  f8311015          LDRH     r1,[r1,r5,LSL #1]     ;265
00021a  f104002a          ADD      r0,r4,#0x2a           ;265
00021e  e8bd4070          POP      {r4-r6,lr}            ;265
000222  f7ffbffe          B.W      GUI_ARRAY_GetpItem
                  |L1.550|
000226  4629              MOV      r1,r5                 ;267
000228  f104002a          ADD      r0,r4,#0x2a           ;267
00022c  e8bd4070          POP      {r4-r6,lr}            ;267
000230  f7ffbffe          B.W      GUI_ARRAY_GetpItem
;;;270    
                          ENDP

                  _Paint PROC
;;;274    */
;;;275    static void _Paint(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, WM_MESSAGE* pMsg) {
000234  e92d4ff0          PUSH     {r4-r11,lr}
000238  b08f              SUB      sp,sp,#0x3c
00023a  4607              MOV      r7,r0
00023c  460c              MOV      r4,r1
00023e  4690              MOV      r8,r2
;;;276      const LISTVIEW_ROW* pRow;
;;;277      GUI_RECT ClipRect, Rect;
;;;278      int NumRows, NumVisRows, NumColumns;
;;;279      int LBorder, RBorder, EffectSize;
;;;280      int xPos, yPos, Width, RowDistY;
;;;281      int Align, i, j, EndRow;
;;;282      /* Init some values */
;;;283      NumColumns = LISTVIEW__GetNumColumns(pObj);
000240  4620              MOV      r0,r4
000242  f7fffffe          BL       LISTVIEW__GetNumColumns
000246  4682              MOV      r10,r0
;;;284      NumRows    = LISTVIEW__GetNumRows(pObj);
000248  4620              MOV      r0,r4
00024a  f7fffffe          BL       LISTVIEW__GetNumRows
00024e  4606              MOV      r6,r0
;;;285      NumVisRows = _GetNumVisibleRows(hObj, pObj);
000250  4621              MOV      r1,r4
000252  4638              MOV      r0,r7
000254  f7fffffe          BL       _GetNumVisibleRows
000258  9007              STR      r0,[sp,#0x1c]
;;;286      RowDistY   = LISTVIEW__GetRowDistY(pObj);
00025a  4620              MOV      r0,r4
00025c  f7fffffe          BL       LISTVIEW__GetRowDistY
000260  9003              STR      r0,[sp,#0xc]
;;;287      LBorder    = pObj->LBorder;
000262  6f20              LDR      r0,[r4,#0x70]
000264  9006              STR      r0,[sp,#0x18]
;;;288      RBorder    = pObj->RBorder;
000266  6f60              LDR      r0,[r4,#0x74]
000268  9005              STR      r0,[sp,#0x14]
;;;289      EffectSize = pObj->Widget.pEffect->EffectSize;
00026a  6a20              LDR      r0,[r4,#0x20]
00026c  6940              LDR      r0,[r0,#0x14]
00026e  9004              STR      r0,[sp,#0x10]
;;;290      yPos       = HEADER_GetHeight(pObj->hHeader) + EffectSize;
000270  f9b40028          LDRSH    r0,[r4,#0x28]
000274  f7fffffe          BL       HEADER_GetHeight
000278  4601              MOV      r1,r0
00027a  9804              LDR      r0,[sp,#0x10]
00027c  180d              ADDS     r5,r1,r0
;;;291      /* Calculate clipping rectangle */
;;;292      ClipRect = *(const GUI_RECT*)pMsg->Data.p;
00027e  f8d80008          LDR      r0,[r8,#8]
000282  6801              LDR      r1,[r0,#0]
000284  910a              STR      r1,[sp,#0x28]
000286  6840              LDR      r0,[r0,#4]
000288  900b              STR      r0,[sp,#0x2c]
;;;293      GUI_MoveRect(&ClipRect, -pObj->Widget.Win.Rect.x0, -pObj->Widget.Win.Rect.y0);
00028a  f9b40002          LDRSH    r0,[r4,#2]
00028e  4242              RSBS     r2,r0,#0
000290  f9b40000          LDRSH    r0,[r4,#0]
000294  4241              RSBS     r1,r0,#0
000296  a80a              ADD      r0,sp,#0x28
000298  f7fffffe          BL       GUI_MoveRect
;;;294      WM_GetInsideRectExScrollbar(hObj, &Rect);
00029c  a908              ADD      r1,sp,#0x20
00029e  4638              MOV      r0,r7
0002a0  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;295      GUI__IntersectRect(&ClipRect, &Rect);
0002a4  a908              ADD      r1,sp,#0x20
0002a6  a80a              ADD      r0,sp,#0x28
0002a8  f7fffffe          BL       GUI__IntersectRect
;;;296      /* Set drawing color, font and text mode */
;;;297      LCD_SetColor(pObj->Props.aTextColor[0]);
0002ac  6c60              LDR      r0,[r4,#0x44]
0002ae  f7fffffe          BL       LCD_SetColor
;;;298      GUI_SetFont(pObj->Props.pFont);
0002b2  6da0              LDR      r0,[r4,#0x58]
0002b4  f7fffffe          BL       GUI_SetFont
;;;299      GUI_SetTextMode(GUI_TM_TRANS);
0002b8  2002              MOVS     r0,#2
0002ba  f7fffffe          BL       GUI_SetTextMode
;;;300      /* Sort before drawing, because scroll position may change */
;;;301      if (pObj->hSort && (pObj->SortIndex >= 0)) {
0002be  f9b40092          LDRSH    r0,[r4,#0x92]
0002c2  b148              CBZ      r0,|L1.728|
0002c4  6ea1              LDR      r1,[r4,#0x68]
0002c6  2900              CMP      r1,#0
0002c8  db06              BLT      |L1.728|
;;;302        LISTVIEW_SORT * pSort;
;;;303        pSort = (LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort);
0002ca  f7fffffe          BL       GUI_ALLOC_h2p
;;;304        if (pSort->fpSort(hObj)) {
0002ce  6841              LDR      r1,[r0,#4]
0002d0  4638              MOV      r0,r7
0002d2  4788              BLX      r1
0002d4  2800              CMP      r0,#0
0002d6  d17e              BNE      |L1.982|
                  |L1.728|
;;;305          return; /* Return on error */
;;;306        }
;;;307      }
;;;308      /* Calculate end row after sorting, because scroll position may have changed */
;;;309      EndRow = pObj->ScrollStateV.v + (((NumVisRows + 1) > NumRows) ? NumRows : NumVisRows + 1);
0002d8  9807              LDR      r0,[sp,#0x1c]
0002da  f8d4807c          LDR      r8,[r4,#0x7c]
0002de  1c40              ADDS     r0,r0,#1
0002e0  42b0              CMP      r0,r6
0002e2  dc01              BGT      |L1.744|
0002e4  9807              LDR      r0,[sp,#0x1c]
0002e6  1c46              ADDS     r6,r0,#1
                  |L1.744|
0002e8  eb080006          ADD      r0,r8,r6
0002ec  9002              STR      r0,[sp,#8]
;;;310      /* Do the drawing */
;;;311      for (i = pObj->ScrollStateV.v; i < EndRow; i++) {
0002ee  9802              LDR      r0,[sp,#8]
0002f0  4580              CMP      r8,r0
0002f2  da71              BGE      |L1.984|
                  |L1.756|
;;;312        pRow = _GetpRow(pObj, i);
0002f4  4641              MOV      r1,r8
0002f6  4620              MOV      r0,r4
0002f8  f7fffffe          BL       _GetpRow
0002fc  900c              STR      r0,[sp,#0x30]
;;;313        if (pRow) {
0002fe  980c              LDR      r0,[sp,#0x30]
000300  b3f0              CBZ      r0,|L1.896|
;;;314          Rect.y0 = yPos;
000302  b228              SXTH     r0,r5
000304  f8ad0022          STRH     r0,[sp,#0x22]
;;;315          /* Break when all other rows are outside the drawing area */
;;;316          if (Rect.y0 > ClipRect.y1) {
000308  f9bd102e          LDRSH    r1,[sp,#0x2e]
00030c  4288              CMP      r0,r1
00030e  dc63              BGT      |L1.984|
;;;317            break;
;;;318          }
;;;319          Rect.y1 = yPos + RowDistY - 1;
000310  9803              LDR      r0,[sp,#0xc]
000312  4428              ADD      r0,r0,r5
000314  900d              STR      r0,[sp,#0x34]
000316  1e40              SUBS     r0,r0,#1
000318  b200              SXTH     r0,r0
00031a  f8ad0026          STRH     r0,[sp,#0x26]
;;;320          /* Make sure that we draw only when row is in drawing area */
;;;321          if (Rect.y1 >= ClipRect.y0) {
00031e  f9bd102a          LDRSH    r1,[sp,#0x2a]
000322  4288              CMP      r0,r1
000324  db7e              BLT      |L1.1060|
;;;322            int ColorIndex;
;;;323            /* Set background color */
;;;324            if (pRow->Disabled) {
000326  980c              LDR      r0,[sp,#0x30]
000328  7900              LDRB     r0,[r0,#4]
00032a  b108              CBZ      r0,|L1.816|
;;;325              ColorIndex = LISTVIEW_CI_DISABLED;
00032c  2603              MOVS     r6,#3
00032e  e00b              B        |L1.840|
                  |L1.816|
;;;326            } else if (i == pObj->Sel) {
000330  6e20              LDR      r0,[r4,#0x60]
000332  4540              CMP      r0,r8
000334  d107              BNE      |L1.838|
;;;327              ColorIndex = (pObj->Widget.State & WIDGET_STATE_FOCUS) ? LISTVIEW_CI_SELFOCUS : LISTVIEW_CI_SEL;
000336  8ce0              LDRH     r0,[r4,#0x26]
000338  f0100f01          TST      r0,#1
00033c  d001              BEQ      |L1.834|
00033e  2602              MOVS     r6,#2
000340  e002              B        |L1.840|
                  |L1.834|
000342  2601              MOVS     r6,#1
000344  e000              B        |L1.840|
                  |L1.838|
;;;328            } else {
;;;329              ColorIndex = LISTVIEW_CI_UNSEL;
000346  2600              MOVS     r6,#0
                  |L1.840|
;;;330            }
;;;331            LCD_SetBkColor(pObj->Props.aBkColor[ColorIndex]);
000348  eb040986          ADD      r9,r4,r6,LSL #2
00034c  f8d90034          LDR      r0,[r9,#0x34]
000350  f7fffffe          BL       LCD_SetBkColor
;;;332            /* Iterate over all columns */
;;;333            if (pObj->ShowGrid) {
000354  6e60              LDR      r0,[r4,#0x64]
000356  b120              CBZ      r0,|L1.866|
;;;334              Rect.y1--;
000358  f8bd0026          LDRH     r0,[sp,#0x26]
00035c  1e40              SUBS     r0,r0,#1
00035e  f8ad0026          STRH     r0,[sp,#0x26]
                  |L1.866|
;;;335            }
;;;336            xPos = EffectSize - pObj->ScrollStateH.v;
000362  f8d41088          LDR      r1,[r4,#0x88]
000366  9804              LDR      r0,[sp,#0x10]
000368  1a45              SUBS     r5,r0,r1
;;;337            for (j = 0; j < NumColumns; j++) {
00036a  2700              MOVS     r7,#0
00036c  f1ba0f00          CMP      r10,#0
000370  dd64              BLE      |L1.1084|
                  |L1.882|
;;;338              Width   = HEADER_GetItemWidth(pObj->hHeader, j);
000372  f9b40028          LDRSH    r0,[r4,#0x28]
000376  4639              MOV      r1,r7
000378  f7fffffe          BL       HEADER_GetItemWidth
00037c  4601              MOV      r1,r0
;;;339              Rect.x0 = xPos;
00037e  e000              B        |L1.898|
                  |L1.896|
000380  e068              B        |L1.1108|
                  |L1.898|
000382  b228              SXTH     r0,r5
000384  f8ad0020          STRH     r0,[sp,#0x20]
;;;340              /* Break when all other columns are outside the drawing area */
;;;341              if (Rect.x0 > ClipRect.x1) {
000388  f9bd202c          LDRSH    r2,[sp,#0x2c]
00038c  4290              CMP      r0,r2
00038e  dc55              BGT      |L1.1084|
;;;342                break;
;;;343              }
;;;344              Rect.x1 = xPos + Width - 1;
000390  eb050b01          ADD      r11,r5,r1
000394  f1ab0001          SUB      r0,r11,#1
000398  b200              SXTH     r0,r0
00039a  f8ad0024          STRH     r0,[sp,#0x24]
;;;345              /* Make sure that we draw only when column is in drawing area */
;;;346              if (Rect.x1 >= ClipRect.x0) {
00039e  f9bd1028          LDRSH    r1,[sp,#0x28]
0003a2  4288              CMP      r0,r1
0003a4  db46              BLT      |L1.1076|
;;;347                LISTVIEW_COLUMN* pColumn;
;;;348                LISTVIEW_CELL* pCell;
;;;349                pCell = (LISTVIEW_CELL*)GUI_ARRAY_GetpItem(&pRow->CellArray, j);
0003a6  4639              MOV      r1,r7
0003a8  980c              LDR      r0,[sp,#0x30]
0003aa  f7fffffe          BL       GUI_ARRAY_GetpItem
0003ae  4605              MOV      r5,r0
;;;350                if (pCell) {
0003b0  b3cd              CBZ      r5,|L1.1062|
;;;351                  if (pCell->hCellInfo) {
0003b2  f9b50000          LDRSH    r0,[r5,#0]
0003b6  b180              CBZ      r0,|L1.986|
;;;352                    LISTVIEW_CELL_INFO* pCellInfo;
;;;353                    pCellInfo = (LISTVIEW_CELL_INFO*) GUI_ALLOC_h2p(pCell->hCellInfo);
0003b8  f7fffffe          BL       GUI_ALLOC_h2p
0003bc  9001              STR      r0,[sp,#4]
;;;354                    LCD_SetBkColor(pCellInfo->aBkColor[ColorIndex]);
0003be  9801              LDR      r0,[sp,#4]
0003c0  f8500026          LDR      r0,[r0,r6,LSL #2]
0003c4  f7fffffe          BL       LCD_SetBkColor
;;;355                    LCD_SetColor(pCellInfo->aTextColor[ColorIndex]);
0003c8  9801              LDR      r0,[sp,#4]
0003ca  eb000086          ADD      r0,r0,r6,LSL #2
0003ce  6900              LDR      r0,[r0,#0x10]
0003d0  f7fffffe          BL       LCD_SetColor
;;;356                  } else {
0003d4  e005              B        |L1.994|
                  |L1.982|
0003d6  e09d              B        |L1.1300|
                  |L1.984|
0003d8  e042              B        |L1.1120|
                  |L1.986|
;;;357                    LCD_SetColor(pObj->Props.aTextColor[ColorIndex]);
0003da  f8d90044          LDR      r0,[r9,#0x44]
0003de  f7fffffe          BL       LCD_SetColor
                  |L1.994|
;;;358                  }
;;;359                  /* Clear background */
;;;360                  GUI_ClearRect(Rect.x0, Rect.y0, Rect.x1, Rect.y1);
0003e2  f9bd3026          LDRSH    r3,[sp,#0x26]
0003e6  f9bd2024          LDRSH    r2,[sp,#0x24]
0003ea  f9bd1022          LDRSH    r1,[sp,#0x22]
0003ee  f9bd0020          LDRSH    r0,[sp,#0x20]
0003f2  f7fffffe          BL       GUI_ClearRect
;;;361                  /* Draw text */
;;;362                  Rect.x0 += LBorder;
0003f6  f8bd1020          LDRH     r1,[sp,#0x20]
0003fa  9806              LDR      r0,[sp,#0x18]
0003fc  4408              ADD      r0,r0,r1
0003fe  f8ad0020          STRH     r0,[sp,#0x20]
;;;363                  Rect.x1 -= RBorder;
000402  f8bd1024          LDRH     r1,[sp,#0x24]
000406  9805              LDR      r0,[sp,#0x14]
000408  1a08              SUBS     r0,r1,r0
00040a  f8ad0024          STRH     r0,[sp,#0x24]
;;;364                  pColumn = (LISTVIEW_COLUMN*) GUI_ARRAY_GetpItem(&pObj->ColumnArray, j);
00040e  4639              MOV      r1,r7
000410  f104002e          ADD      r0,r4,#0x2e
000414  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;365                  Align = pColumn->Align;
000418  7802              LDRB     r2,[r0,#0]
;;;366                  GUI_DispStringInRect(pCell->acText, &Rect, Align);
00041a  a908              ADD      r1,sp,#0x20
00041c  1ca8              ADDS     r0,r5,#2
00041e  f7fffffe          BL       GUI_DispStringInRect
;;;367                  if (pCell->hCellInfo) {
000422  e001              B        |L1.1064|
                  |L1.1060|
000424  e015              B        |L1.1106|
                  |L1.1062|
000426  e005              B        |L1.1076|
                  |L1.1064|
000428  8828              LDRH     r0,[r5,#0]
00042a  b118              CBZ      r0,|L1.1076|
;;;368                    LCD_SetBkColor(pObj->Props.aBkColor[ColorIndex]);
00042c  f8d90034          LDR      r0,[r9,#0x34]
000430  f7fffffe          BL       LCD_SetBkColor
                  |L1.1076|
;;;369                  }
;;;370                }
;;;371              }
;;;372              xPos += Width;
000434  465d              MOV      r5,r11
000436  1c7f              ADDS     r7,r7,#1              ;337
000438  4557              CMP      r7,r10                ;337
00043a  db9a              BLT      |L1.882|
                  |L1.1084|
;;;373            }
;;;374            /* Clear unused area to the right of items */
;;;375            if (xPos <= ClipRect.x1) {
00043c  f9bd202c          LDRSH    r2,[sp,#0x2c]
000440  42aa              CMP      r2,r5
000442  db06              BLT      |L1.1106|
;;;376              GUI_ClearRect(xPos, Rect.y0, ClipRect.x1, Rect.y1);
000444  f9bd3026          LDRSH    r3,[sp,#0x26]
000448  f9bd1022          LDRSH    r1,[sp,#0x22]
00044c  4628              MOV      r0,r5
00044e  f7fffffe          BL       GUI_ClearRect
                  |L1.1106|
;;;377            }
;;;378          }
;;;379          yPos += RowDistY;
000452  9d0d              LDR      r5,[sp,#0x34]
                  |L1.1108|
000454  f1080801          ADD      r8,r8,#1              ;311
000458  9802              LDR      r0,[sp,#8]            ;311
00045a  4580              CMP      r8,r0                 ;311
00045c  f6ffaf4a          BLT      |L1.756|
                  |L1.1120|
;;;380        }
;;;381      }
;;;382      /* Clear unused area below items */
;;;383      if (yPos <= ClipRect.y1) {
000460  f9bd002e          LDRSH    r0,[sp,#0x2e]
000464  42a8              CMP      r0,r5
000466  db0b              BLT      |L1.1152|
;;;384        LCD_SetBkColor(pObj->Props.aBkColor[0]);
000468  6b60              LDR      r0,[r4,#0x34]
00046a  f7fffffe          BL       LCD_SetBkColor
;;;385        GUI_ClearRect(ClipRect.x0, yPos, ClipRect.x1, ClipRect.y1);
00046e  f9bd302e          LDRSH    r3,[sp,#0x2e]
000472  f9bd202c          LDRSH    r2,[sp,#0x2c]
000476  f9bd0028          LDRSH    r0,[sp,#0x28]
00047a  4629              MOV      r1,r5
00047c  f7fffffe          BL       GUI_ClearRect
                  |L1.1152|
;;;386      }
;;;387      /* Draw grid */
;;;388      if (pObj->ShowGrid) {
000480  6e60              LDR      r0,[r4,#0x64]
000482  b3f0              CBZ      r0,|L1.1282|
;;;389        LCD_SetColor(pObj->Props.GridColor);
000484  6d60              LDR      r0,[r4,#0x54]
000486  f7fffffe          BL       LCD_SetColor
;;;390        yPos = HEADER_GetHeight(pObj->hHeader) + EffectSize - 1;
00048a  f9b40028          LDRSH    r0,[r4,#0x28]
00048e  f7fffffe          BL       HEADER_GetHeight
000492  9904              LDR      r1,[sp,#0x10]
000494  4408              ADD      r0,r0,r1
000496  1e45              SUBS     r5,r0,#1
;;;391        for (i = 0; i < NumVisRows; i++) {
000498  2600              MOVS     r6,#0
00049a  9807              LDR      r0,[sp,#0x1c]
00049c  2800              CMP      r0,#0
00049e  dd14              BLE      |L1.1226|
                  |L1.1184|
;;;392          yPos += RowDistY;
0004a0  9803              LDR      r0,[sp,#0xc]
0004a2  4405              ADD      r5,r5,r0
;;;393          /* Break when all other rows are outside the drawing area */
;;;394          if (yPos > ClipRect.y1) {
0004a4  f9bd002e          LDRSH    r0,[sp,#0x2e]
0004a8  42a8              CMP      r0,r5
0004aa  db0e              BLT      |L1.1226|
;;;395            break;
;;;396          }
;;;397          /* Make sure that we draw only when row is in drawing area */
;;;398          if (yPos >= ClipRect.y0) {
0004ac  f9bd002a          LDRSH    r0,[sp,#0x2a]
0004b0  42a8              CMP      r0,r5
0004b2  dc06              BGT      |L1.1218|
;;;399            GUI_DrawHLine(yPos, ClipRect.x0, ClipRect.x1);
0004b4  f9bd202c          LDRSH    r2,[sp,#0x2c]
0004b8  f9bd1028          LDRSH    r1,[sp,#0x28]
0004bc  4628              MOV      r0,r5
0004be  f7fffffe          BL       GUI_DrawHLine
                  |L1.1218|
0004c2  1c76              ADDS     r6,r6,#1              ;391
0004c4  9807              LDR      r0,[sp,#0x1c]         ;391
0004c6  4286              CMP      r6,r0                 ;391
0004c8  dbea              BLT      |L1.1184|
                  |L1.1226|
;;;400          }
;;;401        }
;;;402        xPos = EffectSize - pObj->ScrollStateH.v;
0004ca  f8d41088          LDR      r1,[r4,#0x88]
0004ce  9804              LDR      r0,[sp,#0x10]
0004d0  1a45              SUBS     r5,r0,r1
;;;403        for (i = 0; i < NumColumns; i++) {
0004d2  2600              MOVS     r6,#0
0004d4  f1ba0f00          CMP      r10,#0
0004d8  dd19              BLE      |L1.1294|
                  |L1.1242|
;;;404          xPos += HEADER_GetItemWidth(pObj->hHeader, i);
0004da  f9b40028          LDRSH    r0,[r4,#0x28]
0004de  4631              MOV      r1,r6
0004e0  f7fffffe          BL       HEADER_GetItemWidth
0004e4  4405              ADD      r5,r5,r0
;;;405          /* Break when all other columns are outside the drawing area */
;;;406          if (xPos > ClipRect.x1) {
0004e6  f9bd002c          LDRSH    r0,[sp,#0x2c]
0004ea  42a8              CMP      r0,r5
0004ec  db0f              BLT      |L1.1294|
;;;407            break;
;;;408          }
;;;409          /* Make sure that we draw only when column is in drawing area */
;;;410          if (xPos >= ClipRect.x0) {
0004ee  f9bd0028          LDRSH    r0,[sp,#0x28]
0004f2  42a8              CMP      r0,r5
0004f4  dc08              BGT      |L1.1288|
;;;411            GUI_DrawVLine(xPos, ClipRect.y0, ClipRect.y1);
0004f6  f9bd202e          LDRSH    r2,[sp,#0x2e]
0004fa  f9bd102a          LDRSH    r1,[sp,#0x2a]
0004fe  4628              MOV      r0,r5
000500  e000              B        |L1.1284|
                  |L1.1282|
000502  e004              B        |L1.1294|
                  |L1.1284|
000504  f7fffffe          BL       GUI_DrawVLine
                  |L1.1288|
000508  1c76              ADDS     r6,r6,#1              ;403
00050a  4556              CMP      r6,r10                ;403
00050c  dbe5              BLT      |L1.1242|
                  |L1.1294|
;;;412          }
;;;413        }
;;;414      }
;;;415      /* Draw the effect */
;;;416      WIDGET__EFFECT_DrawDown(&pObj->Widget);
00050e  4620              MOV      r0,r4
000510  f7fffffe          BL       WIDGET__EFFECT_DrawDown
                  |L1.1300|
;;;417    }
000514  b00f              ADD      sp,sp,#0x3c
000516  e8bd8ff0          POP      {r4-r11,pc}
;;;418    
                          ENDP

                  _SetSelFromPos PROC
;;;452    */
;;;453    static void _SetSelFromPos(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, const GUI_PID_STATE* pState) {
00051a  b5f0              PUSH     {r4-r7,lr}
00051c  b083              SUB      sp,sp,#0xc
00051e  4607              MOV      r7,r0
000520  460d              MOV      r5,r1
000522  4614              MOV      r4,r2
;;;454      GUI_RECT Rect;
;;;455      int x, y, HeaderHeight;
;;;456      HeaderHeight = HEADER_GetHeight(pObj->hHeader);
000524  f9b50028          LDRSH    r0,[r5,#0x28]
000528  f7fffffe          BL       HEADER_GetHeight
00052c  4606              MOV      r6,r0
;;;457      WM_GetInsideRectExScrollbar(hObj, &Rect);
00052e  4669              MOV      r1,sp
000530  4638              MOV      r0,r7
000532  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;458      x = pState->x - Rect.x0;
000536  f9bdc000          LDRSH    r12,[sp,#0]
00053a  6820              LDR      r0,[r4,#0]
00053c  eba0030c          SUB      r3,r0,r12
;;;459      y = pState->y - Rect.y0 - HeaderHeight;
000540  f9bd2002          LDRSH    r2,[sp,#2]
000544  6860              LDR      r0,[r4,#4]
000546  1a80              SUBS     r0,r0,r2
000548  1b84              SUBS     r4,r0,r6
;;;460      Rect.x1 -= Rect.x0;
00054a  f8bd0004          LDRH     r0,[sp,#4]
00054e  eba0000c          SUB      r0,r0,r12
000552  fa0ffc80          SXTH     r12,r0
000556  f8adc004          STRH     r12,[sp,#4]
;;;461      Rect.y1 -= Rect.y0;
00055a  f8bd0006          LDRH     r0,[sp,#6]
00055e  1a80              SUBS     r0,r0,r2
000560  b200              SXTH     r0,r0
000562  f8ad0006          STRH     r0,[sp,#6]
;;;462      if ((x >= 0) && (x <= Rect.x1) && (y >= 0) && (y <= (Rect.y1 - HeaderHeight))) {
000566  2b00              CMP      r3,#0
000568  db17              BLT      |L1.1434|
00056a  459c              CMP      r12,r3
00056c  db15              BLT      |L1.1434|
00056e  2c00              CMP      r4,#0
000570  db13              BLT      |L1.1434|
000572  1b80              SUBS     r0,r0,r6
000574  42a0              CMP      r0,r4
000576  db10              BLT      |L1.1434|
;;;463        unsigned Sel;
;;;464        Sel = (y / LISTVIEW__GetRowDistY(pObj)) + pObj->ScrollStateV.v;
000578  4628              MOV      r0,r5
00057a  f7fffffe          BL       LISTVIEW__GetRowDistY
00057e  fbb4f0f0          UDIV     r0,r4,r0
000582  6fe9              LDR      r1,[r5,#0x7c]
000584  1844              ADDS     r4,r0,r1
;;;465        if (Sel < LISTVIEW__GetNumRows(pObj)) {
000586  4628              MOV      r0,r5
000588  f7fffffe          BL       LISTVIEW__GetNumRows
00058c  42a0              CMP      r0,r4
00058e  d904              BLS      |L1.1434|
;;;466          LISTVIEW__SetSel(hObj, pObj, Sel);
000590  4622              MOV      r2,r4
000592  4629              MOV      r1,r5
000594  4638              MOV      r0,r7
000596  f7fffffe          BL       LISTVIEW__SetSel
                  |L1.1434|
;;;467        }
;;;468      }
;;;469    }
00059a  b003              ADD      sp,sp,#0xc
00059c  bdf0              POP      {r4-r7,pc}
;;;470    
                          ENDP

                  _NotifyOwner PROC
;;;478    */
;;;479    static void _NotifyOwner(WM_HWIN hObj, int Notification) {
00059e  b530              PUSH     {r4,r5,lr}
0005a0  b083              SUB      sp,sp,#0xc
0005a2  4604              MOV      r4,r0
0005a4  460d              MOV      r5,r1
;;;480      WM_MESSAGE Msg = {0};
0005a6  2000              MOVS     r0,#0
0005a8  9000              STR      r0,[sp,#0]
0005aa  9001              STR      r0,[sp,#4]
0005ac  9002              STR      r0,[sp,#8]
;;;481      WM_HWIN hOwner;
;;;482      LISTVIEW_Obj* pObj    = LISTVIEW_H2P(hObj);
0005ae  4620              MOV      r0,r4
0005b0  f7fffffe          BL       GUI_ALLOC_h2p
;;;483      hOwner = pObj->hOwner ? pObj->hOwner : WM_GetParent(hObj);
0005b4  f9b00090          LDRSH    r0,[r0,#0x90]
0005b8  b910              CBNZ     r0,|L1.1472|
0005ba  4620              MOV      r0,r4
0005bc  f7fffffe          BL       WM_GetParent
                  |L1.1472|
;;;484      Msg.MsgId   = WM_NOTIFY_PARENT;
0005c0  2126              MOVS     r1,#0x26
0005c2  9100              STR      r1,[sp,#0]
;;;485      Msg.Data.v  = Notification;
0005c4  9502              STR      r5,[sp,#8]
;;;486      Msg.hWinSrc = hObj;
0005c6  f8ad4006          STRH     r4,[sp,#6]
;;;487      WM__SendMessage(hOwner, &Msg);
0005ca  4669              MOV      r1,sp
0005cc  f7fffffe          BL       WM__SendMessage
;;;488    }
0005d0  b003              ADD      sp,sp,#0xc
0005d2  bd30              POP      {r4,r5,pc}
;;;489    
                          ENDP

                  _OnTouch PROC
;;;493    */
;;;494    static void _OnTouch(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, WM_MESSAGE*pMsg) {
0005d4  b570              PUSH     {r4-r6,lr}
0005d6  4605              MOV      r5,r0
;;;495      int Notification;
;;;496      const GUI_PID_STATE* pState = (const GUI_PID_STATE*)pMsg->Data.p;
0005d8  6892              LDR      r2,[r2,#8]
;;;497      GUI_USE_PARA(pObj);
;;;498      if (pMsg->Data.p) {  /* Something happened in our area (pressed or released) */
0005da  b15a              CBZ      r2,|L1.1524|
;;;499        if (pState->Pressed) {
0005dc  7a10              LDRB     r0,[r2,#8]
0005de  b138              CBZ      r0,|L1.1520|
;;;500          _SetSelFromPos(hObj, pObj, pState);
0005e0  4628              MOV      r0,r5
0005e2  f7fffffe          BL       _SetSelFromPos
;;;501          Notification = WM_NOTIFICATION_CLICKED;
0005e6  2401              MOVS     r4,#1
;;;502          WM_SetFocus(hObj);
0005e8  4628              MOV      r0,r5
0005ea  f7fffffe          BL       WM_SetFocus
0005ee  e002              B        |L1.1526|
                  |L1.1520|
;;;503        } else {
;;;504          Notification = WM_NOTIFICATION_RELEASED;
0005f0  2402              MOVS     r4,#2
0005f2  e000              B        |L1.1526|
                  |L1.1524|
;;;505        }
;;;506      } else {
;;;507        Notification = WM_NOTIFICATION_MOVED_OUT;
0005f4  2403              MOVS     r4,#3
                  |L1.1526|
;;;508      }
;;;509      _NotifyOwner(hObj, Notification);
0005f6  4621              MOV      r1,r4
0005f8  4628              MOV      r0,r5
0005fa  e8bd4070          POP      {r4-r6,lr}
0005fe  e7fe              B        _NotifyOwner
;;;510    }
;;;511    
                          ENDP

                  _GetXSize PROC
;;;518    */
;;;519    static int _GetXSize(LISTVIEW_Handle hObj) {
000600  b500              PUSH     {lr}
000602  b083              SUB      sp,sp,#0xc
;;;520      GUI_RECT Rect;
;;;521      WM_GetInsideRectExScrollbar(hObj, &Rect);
000604  4669              MOV      r1,sp
000606  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;522      return Rect.x1 - Rect.x0 + 1;
00060a  f9bd0004          LDRSH    r0,[sp,#4]
00060e  f9bd1000          LDRSH    r1,[sp,#0]
;;;523    }
000612  b003              ADD      sp,sp,#0xc
000614  1a40              SUBS     r0,r0,r1              ;522
000616  1c40              ADDS     r0,r0,#1              ;522
000618  bd00              POP      {pc}
;;;524    
                          ENDP

                  _GetHeaderWidth PROC
;;;535    */
;;;536    static int _GetHeaderWidth(LISTVIEW_Obj * pObj) {
00061a  e92d41f0          PUSH     {r4-r8,lr}
00061e  4607              MOV      r7,r0
;;;537      int NumItems, i, r = 1;
000620  2501              MOVS     r5,#1
;;;538      NumItems = HEADER_GetNumItems(pObj->hHeader);
000622  f9b70028          LDRSH    r0,[r7,#0x28]
000626  f7fffffe          BL       HEADER_GetNumItems
00062a  4606              MOV      r6,r0
;;;539      if (NumItems) {
00062c  2e00              CMP      r6,#0
00062e  d00c              BEQ      |L1.1610|
;;;540        for (i = 0, r = 0; i < NumItems; i++) {
000630  f04f0400          MOV      r4,#0
000634  4625              MOV      r5,r4
000636  dd08              BLE      |L1.1610|
                  |L1.1592|
;;;541          r += HEADER_GetItemWidth(pObj->hHeader, i);
000638  f9b70028          LDRSH    r0,[r7,#0x28]
00063c  4621              MOV      r1,r4
00063e  f7fffffe          BL       HEADER_GetItemWidth
000642  4405              ADD      r5,r5,r0
000644  1c64              ADDS     r4,r4,#1              ;540
000646  42b4              CMP      r4,r6                 ;540
000648  dbf6              BLT      |L1.1592|
                  |L1.1610|
;;;542        }
;;;543      }
;;;544      return r;
00064a  4628              MOV      r0,r5
;;;545    }
00064c  e8bd81f0          POP      {r4-r8,pc}
;;;546    
                          ENDP

                  LISTVIEW__UpdateScrollParas PROC
;;;580    */
;;;581    int LISTVIEW__UpdateScrollParas(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj) {
000650  e92d41f0          PUSH     {r4-r8,lr}
000654  4680              MOV      r8,r0
000656  460c              MOV      r4,r1
;;;582      int NumRows, IsRequired;
;;;583      int xSize, xSizeHeader;
;;;584      unsigned NumVisibleRows;
;;;585      NumVisibleRows = _GetNumVisibleRows(hObj, pObj);
000658  4621              MOV      r1,r4
00065a  4640              MOV      r0,r8
00065c  f7fffffe          BL       _GetNumVisibleRows
000660  4605              MOV      r5,r0
;;;586      xSize          = _GetXSize(hObj);
000662  4640              MOV      r0,r8
000664  f7fffffe          BL       _GetXSize
000668  4606              MOV      r6,r0
;;;587      xSizeHeader    = _GetHeaderWidth(pObj);
00066a  4620              MOV      r0,r4
00066c  f7fffffe          BL       _GetHeaderWidth
000670  4607              MOV      r7,r0
;;;588      if (pObj->Flags & LISTVIEW_SF_AUTOSCROLLBAR_V) {
000672  f8940097          LDRB     r0,[r4,#0x97]
000676  f0100f02          TST      r0,#2
00067a  d00b              BEQ      |L1.1684|
;;;589        IsRequired = (NumVisibleRows < GUI_ARRAY_GetNumItems(&pObj->RowArray));
00067c  f104002a          ADD      r0,r4,#0x2a
000680  f7fffffe          BL       GUI_ARRAY_GetNumItems
000684  42a8              CMP      r0,r5
000686  d901              BLS      |L1.1676|
000688  2101              MOVS     r1,#1
00068a  e000              B        |L1.1678|
                  |L1.1676|
00068c  2100              MOVS     r1,#0
                  |L1.1678|
;;;590        WM_SetScrollbarV(hObj, IsRequired);
00068e  4640              MOV      r0,r8
000690  f7fffffe          BL       WM_SetScrollbarV
                  |L1.1684|
;;;591      }
;;;592      if (pObj->Flags & LISTVIEW_SF_AUTOSCROLLBAR_H) {
000694  f8940097          LDRB     r0,[r4,#0x97]
000698  f0100f01          TST      r0,#1
00069c  d00c              BEQ      |L1.1720|
;;;593        IsRequired  = (xSizeHeader > xSize);
00069e  42b7              CMP      r7,r6
0006a0  dd01              BLE      |L1.1702|
0006a2  2101              MOVS     r1,#1
0006a4  e000              B        |L1.1704|
                  |L1.1702|
0006a6  2100              MOVS     r1,#0
                  |L1.1704|
;;;594        WM_SetScrollbarH(hObj, IsRequired);
0006a8  4640              MOV      r0,r8
0006aa  f7fffffe          BL       WM_SetScrollbarH
;;;595        NumVisibleRows = _GetNumVisibleRows(hObj, pObj);
0006ae  4621              MOV      r1,r4
0006b0  4640              MOV      r0,r8
0006b2  f7fffffe          BL       _GetNumVisibleRows
0006b6  4605              MOV      r5,r0
                  |L1.1720|
;;;596      }
;;;597      NumRows = LISTVIEW__GetNumRows(pObj);
0006b8  4620              MOV      r0,r4
0006ba  f7fffffe          BL       LISTVIEW__GetNumRows
;;;598      /* update vertical scrollbar */
;;;599      pObj->ScrollStateV.PageSize = NumVisibleRows;
0006be  f8c45080          STR      r5,[r4,#0x80]
;;;600      pObj->ScrollStateV.NumItems = (NumRows) ? NumRows : 1;
0006c2  b900              CBNZ     r0,|L1.1734|
0006c4  2001              MOVS     r0,#1
                  |L1.1734|
0006c6  67a0              STR      r0,[r4,#0x78]
;;;601      /* update horizontal scrollbar */
;;;602      pObj->ScrollStateH.PageSize = xSize;
0006c8  f8c4608c          STR      r6,[r4,#0x8c]
;;;603      pObj->ScrollStateH.NumItems = xSizeHeader;
0006cc  f8c47084          STR      r7,[r4,#0x84]
;;;604      return LISTVIEW__UpdateScrollPos(hObj, pObj);
0006d0  4621              MOV      r1,r4
0006d2  4640              MOV      r0,r8
0006d4  e8bd41f0          POP      {r4-r8,lr}
0006d8  e7fe              B        LISTVIEW__UpdateScrollPos
;;;605    }
;;;606    
                          ENDP

                  _FreeAttached PROC
;;;613    */
;;;614    static void _FreeAttached(LISTVIEW_Obj * pObj) {
0006da  e92d47f0          PUSH     {r4-r10,lr}
0006de  4606              MOV      r6,r0
;;;615      int i, j, NumRows, NumColumns;
;;;616      NumRows    = LISTVIEW__GetNumRows(pObj);
0006e0  4630              MOV      r0,r6
0006e2  f7fffffe          BL       LISTVIEW__GetNumRows
0006e6  4680              MOV      r8,r0
;;;617      NumColumns = LISTVIEW__GetNumColumns(pObj);
0006e8  4630              MOV      r0,r6
0006ea  f7fffffe          BL       LISTVIEW__GetNumColumns
0006ee  4607              MOV      r7,r0
;;;618      for (i = 0; i < NumRows; i++) {
0006f0  2500              MOVS     r5,#0
0006f2  f1b80f00          CMP      r8,#0
0006f6  dd1b              BLE      |L1.1840|
                  |L1.1784|
;;;619        LISTVIEW_ROW* pRow;
;;;620        pRow = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, i);
0006f8  4629              MOV      r1,r5
0006fa  f106002a          ADD      r0,r6,#0x2a
0006fe  f7fffffe          BL       GUI_ARRAY_GetpItem
000702  4681              MOV      r9,r0
;;;621        /* Delete attached info items */
;;;622        for (j = 0; j < NumColumns; j++) {
000704  2400              MOVS     r4,#0
000706  2f00              CMP      r7,#0
000708  dd0c              BLE      |L1.1828|
                  |L1.1802|
;;;623          LISTVIEW_CELL* pCell;
;;;624          pCell = (LISTVIEW_CELL*) GUI_ARRAY_GetpItem(&pRow->CellArray, j);
00070a  4621              MOV      r1,r4
00070c  4648              MOV      r0,r9
00070e  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;625          if (pCell) {
000712  b120              CBZ      r0,|L1.1822|
;;;626            if (pCell->hCellInfo) {
000714  f9b00000          LDRSH    r0,[r0,#0]
000718  b108              CBZ      r0,|L1.1822|
;;;627              GUI_ALLOC_Free(pCell->hCellInfo);
00071a  f7fffffe          BL       GUI_ALLOC_Free
                  |L1.1822|
00071e  1c64              ADDS     r4,r4,#1              ;622
000720  42bc              CMP      r4,r7                 ;622
000722  dbf2              BLT      |L1.1802|
                  |L1.1828|
;;;628            }
;;;629          }
;;;630        }
;;;631        /* Delete row */
;;;632        GUI_ARRAY_Delete(&pRow->CellArray);
000724  4648              MOV      r0,r9
000726  f7fffffe          BL       GUI_ARRAY_Delete
00072a  1c6d              ADDS     r5,r5,#1              ;618
00072c  4545              CMP      r5,r8                 ;618
00072e  dbe3              BLT      |L1.1784|
                  |L1.1840|
;;;633      }
;;;634      /* Delete sort object */
;;;635      if (pObj->hSort) {
000730  f9b60092          LDRSH    r0,[r6,#0x92]
000734  b128              CBZ      r0,|L1.1858|
;;;636        ((LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort))->fpFree(pObj->hSort);
000736  f7fffffe          BL       GUI_ALLOC_h2p
00073a  6881              LDR      r1,[r0,#8]
00073c  f9b60092          LDRSH    r0,[r6,#0x92]
000740  4788              BLX      r1
                  |L1.1858|
;;;637      }
;;;638      GUI_ARRAY_Delete(&pObj->ColumnArray);
000742  f106002e          ADD      r0,r6,#0x2e
000746  f7fffffe          BL       GUI_ARRAY_Delete
;;;639      GUI_ARRAY_Delete(&pObj->RowArray);
00074a  f106002a          ADD      r0,r6,#0x2a
00074e  e8bd47f0          POP      {r4-r10,lr}
000752  f7ffbffe          B.W      GUI_ARRAY_Delete
;;;640    }
;;;641    
                          ENDP

                  _OnPage PROC
;;;658    */
;;;659    static void _OnPage(LISTVIEW_Handle hObj, LISTVIEW_Obj * pObj, int Dir) {
000756  b570              PUSH     {r4-r6,lr}
000758  460c              MOV      r4,r1
00075a  4605              MOV      r5,r0
00075c  4611              MOV      r1,r2
;;;660      if (Dir < 0) {
;;;661        /* Check if cursor is already on top row of the page */
;;;662        if (pObj->Sel != pObj->ScrollStateV.v) {
00075e  6fe2              LDR      r2,[r4,#0x7c]
000760  6e20              LDR      r0,[r4,#0x60]         ;660
000762  2900              CMP      r1,#0                 ;660
000764  da16              BGE      |L1.1940|
000766  4290              CMP      r0,r2
000768  d004              BEQ      |L1.1908|
;;;663          /* If not, set cursor on top row */
;;;664          LISTVIEW__SetSel(hObj, pObj, pObj->ScrollStateV.v);
00076a  4621              MOV      r1,r4
00076c  4628              MOV      r0,r5
00076e  e8bd4070          POP      {r4-r6,lr}
000772  e7fe              B        LISTVIEW__SetSel
                  |L1.1908|
;;;665        } else {
;;;666          /* Check if current selection is >= one page size */
;;;667          if (pObj->Sel >= pObj->ScrollStateV.PageSize) {
000774  f8d41080          LDR      r1,[r4,#0x80]
000778  4288              CMP      r0,r1
00077a  db05              BLT      |L1.1928|
;;;668            /* Move selection one page up */
;;;669            LISTVIEW__MoveSel(hObj, pObj, -pObj->ScrollStateV.PageSize);
00077c  424a              RSBS     r2,r1,#0
00077e  4621              MOV      r1,r4
000780  4628              MOV      r0,r5
000782  e8bd4070          POP      {r4-r6,lr}
000786  e7fe              B        LISTVIEW__MoveSel
                  |L1.1928|
;;;670          } else {
;;;671            /* Set selection on top row */
;;;672            LISTVIEW__SetSel(hObj, pObj, 0);
000788  4621              MOV      r1,r4
00078a  4628              MOV      r0,r5
00078c  e8bd4070          POP      {r4-r6,lr}
000790  2200              MOVS     r2,#0
000792  e7fe              B        LISTVIEW__SetSel
                  |L1.1940|
;;;673          }
;;;674        }
;;;675      } else {
;;;676        int Pos;
;;;677        /* Check if cursor is already on bottom row of the page */
;;;678        Pos = pObj->ScrollStateV.v + pObj->ScrollStateV.PageSize - 1;
000794  f8d41080          LDR      r1,[r4,#0x80]
000798  4411              ADD      r1,r1,r2
00079a  1e4a              SUBS     r2,r1,#1
;;;679        if (pObj->Sel != Pos) {
00079c  4290              CMP      r0,r2
00079e  d004              BEQ      |L1.1962|
;;;680          /* If not, set cursor on bottom row */
;;;681          LISTVIEW__SetSel(hObj, pObj, Pos);
0007a0  4621              MOV      r1,r4
0007a2  4628              MOV      r0,r5
0007a4  e8bd4070          POP      {r4-r6,lr}
0007a8  e7fe              B        LISTVIEW__SetSel
                  |L1.1962|
;;;682        } else {
;;;683          int NumItems;
;;;684          /* Check if current selection is <= (NumItems - PageSize - 1) */
;;;685          NumItems = LISTVIEW__GetNumRows(pObj);
0007aa  4620              MOV      r0,r4
0007ac  f7fffffe          BL       LISTVIEW__GetNumRows
;;;686          if (pObj->Sel < (NumItems - pObj->ScrollStateV.PageSize - 1)) {
0007b0  f8d42080          LDR      r2,[r4,#0x80]
0007b4  6e21              LDR      r1,[r4,#0x60]
0007b6  1a83              SUBS     r3,r0,r2
0007b8  1e5b              SUBS     r3,r3,#1
0007ba  4299              CMP      r1,r3
0007bc  da04              BGE      |L1.1992|
;;;687            /* Move selection one page down */
;;;688            LISTVIEW__MoveSel(hObj, pObj, pObj->ScrollStateV.PageSize);
0007be  4621              MOV      r1,r4
0007c0  4628              MOV      r0,r5
0007c2  e8bd4070          POP      {r4-r6,lr}
0007c6  e7fe              B        LISTVIEW__MoveSel
                  |L1.1992|
;;;689          } else {
;;;690            /* Set selection on bottom row */
;;;691            LISTVIEW__SetSel(hObj, pObj, NumItems - 1);
0007c8  1e42              SUBS     r2,r0,#1
0007ca  4621              MOV      r1,r4
0007cc  4628              MOV      r0,r5
0007ce  e8bd4070          POP      {r4-r6,lr}
0007d2  e7fe              B        LISTVIEW__SetSel
;;;692          }
;;;693        }
;;;694      }
;;;695    }
;;;696    
                          ENDP

                  _AddKey PROC
;;;703    */
;;;704    static int _AddKey(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int Key) {
0007d4  b570              PUSH     {r4-r6,lr}
0007d6  4605              MOV      r5,r0
0007d8  460c              MOV      r4,r1
;;;705      switch (Key) {
0007da  2a17              CMP      r2,#0x17
0007dc  d02f              BEQ      |L1.2110|
0007de  dc08              BGT      |L1.2034|
0007e0  2a10              CMP      r2,#0x10
0007e2  d051              BEQ      |L1.2184|
0007e4  2a11              CMP      r2,#0x11
0007e6  d01a              BEQ      |L1.2078|
0007e8  2a12              CMP      r2,#0x12
0007ea  d039              BEQ      |L1.2144|
0007ec  2a13              CMP      r2,#0x13
0007ee  d106              BNE      |L1.2046|
0007f0  e007              B        |L1.2050|
                  |L1.2034|
0007f2  2a18              CMP      r2,#0x18
0007f4  d02a              BEQ      |L1.2124|
0007f6  2a21              CMP      r2,#0x21
0007f8  d019              BEQ      |L1.2094|
0007fa  2a22              CMP      r2,#0x22
0007fc  d008              BEQ      |L1.2064|
                  |L1.2046|
;;;706      case GUI_KEY_DOWN:
;;;707        LISTVIEW__MoveSel(hObj, pObj, 1);
;;;708        return 1;               /* Key has been consumed */
;;;709      case GUI_KEY_PGDOWN:
;;;710        _OnPage(hObj, pObj, 1);
;;;711        return 1;               /* Key has been consumed */
;;;712      case GUI_KEY_UP:
;;;713        LISTVIEW__MoveSel(hObj, pObj, -1);
;;;714        return 1;               /* Key has been consumed */
;;;715      case GUI_KEY_PGUP:
;;;716        _OnPage(hObj, pObj, -1);
;;;717        return 1;               /* Key has been consumed */
;;;718      case GUI_KEY_HOME:
;;;719        LISTVIEW__SetSel(hObj, pObj, 0);
;;;720        return 1;               /* Key has been consumed */
;;;721      case GUI_KEY_END:
;;;722        LISTVIEW__SetSel(hObj, pObj, LISTVIEW__GetNumRows(pObj) - 1);
;;;723        return 1;               /* Key has been consumed */
;;;724      case GUI_KEY_RIGHT:
;;;725        if (WM_SetScrollValue(&pObj->ScrollStateH, pObj->ScrollStateH.v + pObj->Props.ScrollStepH)) {
;;;726          LISTVIEW__UpdateScrollPos(hObj, pObj);
;;;727          LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;728        }
;;;729        return 1;               /* Key has been consumed */
;;;730      case GUI_KEY_LEFT:
;;;731        if (WM_SetScrollValue(&pObj->ScrollStateH, pObj->ScrollStateH.v - pObj->Props.ScrollStepH)) {
;;;732          LISTVIEW__UpdateScrollPos(hObj, pObj);
;;;733          LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;734        }
;;;735        return 1;               /* Key has been consumed */
;;;736      }
;;;737      return 0;                 /* Key has NOT been consumed */
0007fe  2000              MOVS     r0,#0
;;;738    }
000800  bd70              POP      {r4-r6,pc}
                  |L1.2050|
000802  2201              MOVS     r2,#1                 ;707
000804  4621              MOV      r1,r4                 ;707
000806  4628              MOV      r0,r5                 ;707
000808  f7fffffe          BL       LISTVIEW__MoveSel
00080c  2001              MOVS     r0,#1                 ;708
00080e  bd70              POP      {r4-r6,pc}
                  |L1.2064|
000810  2201              MOVS     r2,#1                 ;710
000812  4621              MOV      r1,r4                 ;710
000814  4628              MOV      r0,r5                 ;710
000816  f7fffffe          BL       _OnPage
00081a  2001              MOVS     r0,#1                 ;711
00081c  bd70              POP      {r4-r6,pc}
                  |L1.2078|
00081e  f04f32ff          MOV      r2,#0xffffffff        ;713
000822  4621              MOV      r1,r4                 ;713
000824  4628              MOV      r0,r5                 ;713
000826  f7fffffe          BL       LISTVIEW__MoveSel
00082a  2001              MOVS     r0,#1                 ;714
00082c  bd70              POP      {r4-r6,pc}
                  |L1.2094|
00082e  f04f32ff          MOV      r2,#0xffffffff        ;716
000832  4621              MOV      r1,r4                 ;716
000834  4628              MOV      r0,r5                 ;716
000836  f7fffffe          BL       _OnPage
00083a  2001              MOVS     r0,#1                 ;717
00083c  bd70              POP      {r4-r6,pc}
                  |L1.2110|
00083e  2200              MOVS     r2,#0                 ;719
000840  4621              MOV      r1,r4                 ;719
000842  4628              MOV      r0,r5                 ;719
000844  f7fffffe          BL       LISTVIEW__SetSel
000848  2001              MOVS     r0,#1                 ;720
00084a  bd70              POP      {r4-r6,pc}
                  |L1.2124|
00084c  4620              MOV      r0,r4                 ;722
00084e  f7fffffe          BL       LISTVIEW__GetNumRows
000852  1e42              SUBS     r2,r0,#1              ;722
000854  4621              MOV      r1,r4                 ;722
000856  4628              MOV      r0,r5                 ;722
000858  f7fffffe          BL       LISTVIEW__SetSel
00085c  2001              MOVS     r0,#1                 ;723
00085e  bd70              POP      {r4-r6,pc}
                  |L1.2144|
000860  f8b4105c          LDRH     r1,[r4,#0x5c]         ;725
000864  f8d40088          LDR      r0,[r4,#0x88]         ;725
000868  4401              ADD      r1,r1,r0              ;725
00086a  f1040084          ADD      r0,r4,#0x84           ;725
00086e  f7fffffe          BL       WM_SetScrollValue
000872  b138              CBZ      r0,|L1.2180|
000874  4621              MOV      r1,r4                 ;726
000876  4628              MOV      r0,r5                 ;726
000878  f7fffffe          BL       LISTVIEW__UpdateScrollPos
00087c  4621              MOV      r1,r4                 ;727
00087e  4628              MOV      r0,r5                 ;727
000880  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
                  |L1.2180|
000884  2001              MOVS     r0,#1                 ;729
000886  bd70              POP      {r4-r6,pc}
                  |L1.2184|
000888  f8b4105c          LDRH     r1,[r4,#0x5c]         ;731
00088c  f8d40088          LDR      r0,[r4,#0x88]         ;731
000890  1a41              SUBS     r1,r0,r1              ;731
000892  f1040084          ADD      r0,r4,#0x84           ;731
000896  f7fffffe          BL       WM_SetScrollValue
00089a  b138              CBZ      r0,|L1.2220|
00089c  4621              MOV      r1,r4                 ;732
00089e  4628              MOV      r0,r5                 ;732
0008a0  f7fffffe          BL       LISTVIEW__UpdateScrollPos
0008a4  4621              MOV      r1,r4                 ;733
0008a6  4628              MOV      r0,r5                 ;733
0008a8  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
                  |L1.2220|
0008ac  2001              MOVS     r0,#1                 ;735
0008ae  bd70              POP      {r4-r6,pc}
;;;739    
                          ENDP

                  LISTVIEW_Callback PROC
;;;772    */
;;;773    void LISTVIEW_Callback (WM_MESSAGE *pMsg) {
0008b0  b5f0              PUSH     {r4-r7,lr}
0008b2  b083              SUB      sp,sp,#0xc
0008b4  4605              MOV      r5,r0
;;;774      LISTVIEW_Handle hObj;
;;;775      LISTVIEW_Obj* pObj;
;;;776      WM_SCROLL_STATE ScrollState;
;;;777      hObj = pMsg->hWin;
0008b6  f9b56004          LDRSH    r6,[r5,#4]
;;;778      /* Let widget handle the standard messages */
;;;779      if (WIDGET_HandleActive(hObj, pMsg) == 0) {
0008ba  4629              MOV      r1,r5
0008bc  4630              MOV      r0,r6
0008be  f7fffffe          BL       WIDGET_HandleActive
0008c2  2800              CMP      r0,#0
0008c4  d021              BEQ      |L1.2314|
;;;780        return;
;;;781      }
;;;782      pObj = (LISTVIEW_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
0008c6  4630              MOV      r0,r6
0008c8  f7fffffe          BL       GUI_ALLOC_h2p
0008cc  4604              MOV      r4,r0
;;;783      switch (pMsg->MsgId) {
0008ce  6828              LDR      r0,[r5,#0]
0008d0  280e              CMP      r0,#0xe
0008d2  d07e              BEQ      |L1.2514|
0008d4  dc06              BGT      |L1.2276|
0008d6  2805              CMP      r0,#5
0008d8  d00b              BEQ      |L1.2290|
0008da  280b              CMP      r0,#0xb
0008dc  d07a              BEQ      |L1.2516|
0008de  280c              CMP      r0,#0xc
0008e0  d179              BNE      |L1.2518|
0008e2  e0a7              B        |L1.2612|
                  |L1.2276|
0008e4  280f              CMP      r0,#0xf
0008e6  d077              BEQ      |L1.2520|
0008e8  2825              CMP      r0,#0x25
0008ea  d002              BEQ      |L1.2290|
0008ec  2826              CMP      r0,#0x26
0008ee  d172              BNE      |L1.2518|
0008f0  e00d              B        |L1.2318|
                  |L1.2290|
;;;784      case WM_NOTIFY_CLIENTCHANGE:
;;;785      case WM_SIZE:
;;;786        if (pMsg->hWinSrc && (pMsg->hWinSrc == pObj->hHeader)) {
0008f2  f9b50006          LDRSH    r0,[r5,#6]
0008f6  2800              CMP      r0,#0
0008f8  d007              BEQ      |L1.2314|
0008fa  f9b41028          LDRSH    r1,[r4,#0x28]
0008fe  4288              CMP      r0,r1
000900  d103              BNE      |L1.2314|
;;;787          LISTVIEW__UpdateScrollParas(hObj, pObj);
000902  4621              MOV      r1,r4
000904  4630              MOV      r0,r6
000906  f7fffffe          BL       LISTVIEW__UpdateScrollParas
                  |L1.2314|
;;;788        }
;;;789        return;
;;;790      case WM_NOTIFY_PARENT:
;;;791        switch (pMsg->Data.v) {
;;;792        case WM_NOTIFICATION_CHILD_DELETED:
;;;793          /* make sure we do not send any messages to the header child once it has been deleted */
;;;794          if (pMsg->hWinSrc == pObj->hHeader) {
;;;795            pObj->hHeader = 0;
;;;796          }
;;;797          break;
;;;798        case WM_NOTIFICATION_VALUE_CHANGED:
;;;799          if (pMsg->hWinSrc == WM_GetScrollbarV(hObj)) {
;;;800            WM_GetScrollState(pMsg->hWinSrc, &ScrollState);
;;;801            pObj->ScrollStateV.v = ScrollState.v;
;;;802            LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;803            _NotifyOwner(hObj, WM_NOTIFICATION_SCROLL_CHANGED);
;;;804          } else if (pMsg->hWinSrc == WM_GetScrollbarH(hObj)) {
;;;805            WM_GetScrollState(pMsg->hWinSrc, &ScrollState);
;;;806            pObj->ScrollStateH.v = ScrollState.v;
;;;807            LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;808            HEADER_SetScrollPos(pObj->hHeader, pObj->ScrollStateH.v);
;;;809            _NotifyOwner(hObj, WM_NOTIFICATION_SCROLL_CHANGED);
;;;810          }
;;;811          break;
;;;812        case WM_NOTIFICATION_SCROLLBAR_ADDED:
;;;813          #if WIDGET_USE_PARENT_EFFECT
;;;814            WIDGET_SetEffect(pMsg->hWinSrc, pObj->Widget.pEffect);
;;;815          #endif
;;;816          LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;817          break;
;;;818        case WM_NOTIFICATION_RELEASED:
;;;819          if ((pMsg->hWinSrc == pObj->hHeader) && (pObj->hSort)) {
;;;820            int Column;
;;;821            LISTVIEW_SORT * pSort;
;;;822            LISTVIEW_COLUMN * pColumn;
;;;823            WM_SetFocus(hObj);
;;;824            Column = HEADER_GetSel(pObj->hHeader);
;;;825            if (Column >= 0) {
;;;826              pColumn = (LISTVIEW_COLUMN *)GUI_ARRAY_GetpItem(&pObj->ColumnArray, Column);
;;;827              if (pColumn->fpCompare) {
;;;828                pSort = (LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort);
;;;829                if (pSort) {
;;;830                  // ReverseSort
;;;831                  if (pObj->SortIndex == Column) {
;;;832                    pSort->Reverse   ^= 1;
;;;833                    pObj->ReverseSort = 1;
;;;834                    pObj->IsSorted    = 0;
;;;835                  } else {
;;;836                    pSort->Reverse    = 0;
;;;837                    pObj->SortIndex   = Column;
;;;838                    pObj->IsPresorted = 0;
;;;839                  }
;;;840                  /*
;;;841                  if (pObj->SortIndex == Column) {
;;;842                    pSort->Reverse ^= 1;
;;;843                  } else {
;;;844                    pSort->Reverse = 0;
;;;845                    pObj->SortIndex = Column;
;;;846                  }
;;;847                  pObj->IsPresorted = 0;
;;;848                  */
;;;849                  LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;850                }
;;;851              }
;;;852            }
;;;853          }
;;;854          break;
;;;855        }
;;;856        return;
;;;857      case WM_PAINT:
;;;858        _Paint(hObj, pObj, pMsg);
;;;859        return;
;;;860      case WM_TOUCH:
;;;861        _OnTouch(hObj, pObj, pMsg);
;;;862        return;        /* Important: message handled ! */
;;;863      case WM_KEY:
;;;864        if (((const WM_KEY_INFO*)(pMsg->Data.p))->PressedCnt > 0) {
;;;865          int Key;
;;;866          Key = ((const WM_KEY_INFO*)(pMsg->Data.p))->Key;
;;;867          if (_AddKey(hObj, pObj, Key)) {
;;;868            return;
;;;869          }
;;;870        }
;;;871        break;  /* No return here ... WM_DefaultProc needs to be called */
;;;872      case WM_DELETE:
;;;873        _FreeAttached(pObj);
;;;874        break;  /* No return here ... WM_DefaultProc needs to be called */
;;;875      }
;;;876      WM_DefaultProc(pMsg);
;;;877    }
00090a  b003              ADD      sp,sp,#0xc
00090c  bdf0              POP      {r4-r7,pc}
                  |L1.2318|
00090e  68a8              LDR      r0,[r5,#8]            ;791
000910  2700              MOVS     r7,#0                 ;786
000912  2802              CMP      r0,#2                 ;791
000914  d049              BEQ      |L1.2474|
000916  2805              CMP      r0,#5                 ;791
000918  d00c              BEQ      |L1.2356|
00091a  2806              CMP      r0,#6                 ;791
00091c  d03f              BEQ      |L1.2462|
00091e  2807              CMP      r0,#7                 ;791
000920  d1f3              BNE      |L1.2314|
000922  f9b50006          LDRSH    r0,[r5,#6]            ;794
000926  f9b41028          LDRSH    r1,[r4,#0x28]         ;794
00092a  4288              CMP      r0,r1                 ;794
00092c  d1ed              BNE      |L1.2314|
00092e  8527              STRH     r7,[r4,#0x28]         ;795
000930  b003              ADD      sp,sp,#0xc
000932  bdf0              POP      {r4-r7,pc}
                  |L1.2356|
000934  4630              MOV      r0,r6                 ;799
000936  f7fffffe          BL       WM_GetScrollbarV
00093a  4601              MOV      r1,r0                 ;799
00093c  f9b50006          LDRSH    r0,[r5,#6]            ;799
000940  4281              CMP      r1,r0                 ;799
000942  d10e              BNE      |L1.2402|
000944  4669              MOV      r1,sp                 ;800
000946  f7fffffe          BL       WM_GetScrollState
00094a  9801              LDR      r0,[sp,#4]            ;801
00094c  67e0              STR      r0,[r4,#0x7c]         ;801
00094e  4621              MOV      r1,r4                 ;802
000950  4630              MOV      r0,r6                 ;802
000952  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
000956  210a              MOVS     r1,#0xa               ;803
000958  4630              MOV      r0,r6                 ;803
00095a  f7fffffe          BL       _NotifyOwner
                  |L1.2398|
00095e  b003              ADD      sp,sp,#0xc
000960  bdf0              POP      {r4-r7,pc}
                  |L1.2402|
000962  4630              MOV      r0,r6                 ;804
000964  f7fffffe          BL       WM_GetScrollbarH
000968  4601              MOV      r1,r0                 ;804
00096a  f9b50006          LDRSH    r0,[r5,#6]            ;804
00096e  4281              CMP      r1,r0                 ;804
000970  d1f5              BNE      |L1.2398|
000972  4669              MOV      r1,sp                 ;805
000974  f7fffffe          BL       WM_GetScrollState
000978  9801              LDR      r0,[sp,#4]            ;806
00097a  f8c40088          STR      r0,[r4,#0x88]         ;806
00097e  4621              MOV      r1,r4                 ;807
000980  4630              MOV      r0,r6                 ;807
000982  f7fffffe          BL       LISTVIEW__UpdateScrollParas
000986  f9b40028          LDRSH    r0,[r4,#0x28]         ;808
00098a  f8d41088          LDR      r1,[r4,#0x88]         ;808
00098e  f7fffffe          BL       HEADER_SetScrollPos
000992  210a              MOVS     r1,#0xa               ;809
000994  4630              MOV      r0,r6                 ;809
000996  f7fffffe          BL       _NotifyOwner
00099a  b003              ADD      sp,sp,#0xc
00099c  bdf0              POP      {r4-r7,pc}
                  |L1.2462|
00099e  4621              MOV      r1,r4                 ;816
0009a0  4630              MOV      r0,r6                 ;816
0009a2  f7fffffe          BL       LISTVIEW__UpdateScrollParas
                  |L1.2470|
0009a6  b003              ADD      sp,sp,#0xc
0009a8  bdf0              POP      {r4-r7,pc}
                  |L1.2474|
0009aa  f9b50006          LDRSH    r0,[r5,#6]            ;819
0009ae  f9b41028          LDRSH    r1,[r4,#0x28]         ;819
0009b2  4288              CMP      r0,r1                 ;819
0009b4  d1f7              BNE      |L1.2470|
0009b6  f8b40092          LDRH     r0,[r4,#0x92]         ;819
0009ba  2800              CMP      r0,#0                 ;819
0009bc  d0f3              BEQ      |L1.2470|
0009be  4630              MOV      r0,r6                 ;823
0009c0  f7fffffe          BL       WM_SetFocus
0009c4  f9b40028          LDRSH    r0,[r4,#0x28]         ;824
0009c8  f7fffffe          BL       HEADER_GetSel
0009cc  4605              MOV      r5,r0                 ;824
0009ce  2d00              CMP      r5,#0                 ;825
0009d0  e003              B        |L1.2522|
                  |L1.2514|
0009d2  e036              B        |L1.2626|
                  |L1.2516|
0009d4  e041              B        |L1.2650|
                  |L1.2518|
0009d6  e043              B        |L1.2656|
                  |L1.2520|
0009d8  e025              B        |L1.2598|
                  |L1.2522|
0009da  dbe4              BLT      |L1.2470|
0009dc  4629              MOV      r1,r5                 ;826
0009de  f104002e          ADD      r0,r4,#0x2e           ;826
0009e2  f7fffffe          BL       GUI_ARRAY_GetpItem
0009e6  6840              LDR      r0,[r0,#4]            ;827
0009e8  2800              CMP      r0,#0                 ;827
0009ea  d0dc              BEQ      |L1.2470|
0009ec  f9b40092          LDRSH    r0,[r4,#0x92]         ;828
0009f0  f7fffffe          BL       GUI_ALLOC_h2p
0009f4  2800              CMP      r0,#0                 ;829
0009f6  d0d6              BEQ      |L1.2470|
0009f8  6ea1              LDR      r1,[r4,#0x68]         ;831
0009fa  42a9              CMP      r1,r5                 ;831
0009fc  d109              BNE      |L1.2578|
0009fe  7b01              LDRB     r1,[r0,#0xc]          ;832
000a00  f0810101          EOR      r1,r1,#1              ;832
000a04  7301              STRB     r1,[r0,#0xc]          ;832
000a06  2001              MOVS     r0,#1                 ;833
000a08  f8840096          STRB     r0,[r4,#0x96]         ;833
000a0c  f8847094          STRB     r7,[r4,#0x94]         ;834
000a10  e003              B        |L1.2586|
                  |L1.2578|
000a12  7307              STRB     r7,[r0,#0xc]          ;836
000a14  66a5              STR      r5,[r4,#0x68]         ;837
000a16  f8847095          STRB     r7,[r4,#0x95]         ;838
                  |L1.2586|
000a1a  4621              MOV      r1,r4                 ;849
000a1c  4630              MOV      r0,r6                 ;849
000a1e  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
000a22  b003              ADD      sp,sp,#0xc
000a24  bdf0              POP      {r4-r7,pc}
                  |L1.2598|
000a26  462a              MOV      r2,r5                 ;858
000a28  4621              MOV      r1,r4                 ;858
000a2a  4630              MOV      r0,r6                 ;858
000a2c  f7fffffe          BL       _Paint
000a30  b003              ADD      sp,sp,#0xc
000a32  bdf0              POP      {r4-r7,pc}
                  |L1.2612|
000a34  462a              MOV      r2,r5                 ;861
000a36  4621              MOV      r1,r4                 ;861
000a38  4630              MOV      r0,r6                 ;861
000a3a  f7fffffe          BL       _OnTouch
                  |L1.2622|
000a3e  b003              ADD      sp,sp,#0xc
000a40  bdf0              POP      {r4-r7,pc}
                  |L1.2626|
000a42  68a8              LDR      r0,[r5,#8]            ;864
000a44  6841              LDR      r1,[r0,#4]            ;864
000a46  2900              CMP      r1,#0                 ;864
000a48  dd0a              BLE      |L1.2656|
000a4a  6802              LDR      r2,[r0,#0]            ;866
000a4c  4621              MOV      r1,r4                 ;867
000a4e  4630              MOV      r0,r6                 ;867
000a50  f7fffffe          BL       _AddKey
000a54  2800              CMP      r0,#0                 ;867
000a56  d1f2              BNE      |L1.2622|
000a58  e002              B        |L1.2656|
                  |L1.2650|
000a5a  4620              MOV      r0,r4                 ;873
000a5c  f7fffffe          BL       _FreeAttached
                  |L1.2656|
000a60  4628              MOV      r0,r5                 ;876
000a62  f7fffffe          BL       WM_DefaultProc
000a66  b003              ADD      sp,sp,#0xc
000a68  bdf0              POP      {r4-r7,pc}
;;;878    
                          ENDP

                  LISTVIEW_CreateEx PROC
;;;892    */
;;;893    LISTVIEW_Handle LISTVIEW_CreateEx(int x0, int y0, int xsize, int ysize, WM_HWIN hParent,
000a6a  e92d47f0          PUSH     {r4-r10,lr}
;;;894                                      int WinFlags, int ExFlags, int Id)
;;;895    {
000a6e  b084              SUB      sp,sp,#0x10
000a70  4680              MOV      r8,r0
000a72  4689              MOV      r9,r1
000a74  4614              MOV      r4,r2
000a76  461d              MOV      r5,r3
000a78  f8dda030          LDR      r10,[sp,#0x30]
000a7c  9f0f              LDR      r7,[sp,#0x3c]
000a7e  9e0d              LDR      r6,[sp,#0x34]
;;;896      LISTVIEW_Handle hObj;
;;;897      GUI_USE_PARA(ExFlags);
;;;898      WM_LOCK();
000a80  f7fffffe          BL       GUI_Lock
;;;899      /* Create the window */
;;;900      if ((xsize == 0) && (ysize == 0) && (x0 == 0) && (y0 == 0)) {
000a84  ea440005          ORR      r0,r4,r5
000a88  ea400008          ORR      r0,r0,r8
000a8c  ea500009          ORRS     r0,r0,r9
000a90  d10f              BNE      |L1.2738|
;;;901        GUI_RECT Rect;
;;;902        WM_GetClientRectEx(hParent, &Rect);
000a92  a902              ADD      r1,sp,#8
000a94  4650              MOV      r0,r10
000a96  f7fffffe          BL       WM_GetClientRectEx
;;;903        xsize = Rect.x1 - Rect.x0 + 1;
000a9a  f9bd000c          LDRSH    r0,[sp,#0xc]
000a9e  f9bd1008          LDRSH    r1,[sp,#8]
000aa2  1a40              SUBS     r0,r0,r1
000aa4  1c44              ADDS     r4,r0,#1
;;;904        ysize = Rect.y1 - Rect.y0 + 1;
000aa6  f9bd000e          LDRSH    r0,[sp,#0xe]
000aaa  f9bd100a          LDRSH    r1,[sp,#0xa]
000aae  1a40              SUBS     r0,r0,r1
000ab0  1c45              ADDS     r5,r0,#1
                  |L1.2738|
;;;905      }
;;;906      hObj = WM_CreateWindowAsChild(x0, y0, xsize, ysize, hParent, WinFlags, &LISTVIEW_Callback,
000ab2  2378              MOVS     r3,#0x78
000ab4  f2af2207          ADR      r2,LISTVIEW_Callback + 1
000ab8  b2b1              UXTH     r1,r6
000aba  9303              STR      r3,[sp,#0xc]
000abc  9202              STR      r2,[sp,#8]
000abe  9101              STR      r1,[sp,#4]
000ac0  f8cda000          STR      r10,[sp,#0]
000ac4  462b              MOV      r3,r5
000ac6  4622              MOV      r2,r4
000ac8  4649              MOV      r1,r9
000aca  4640              MOV      r0,r8
000acc  f7fffffe          BL       WM_CreateWindowAsChild
000ad0  4605              MOV      r5,r0
;;;907                                    sizeof(LISTVIEW_Obj) - sizeof(WM_Obj));
;;;908      if (hObj) {
000ad2  b3e5              CBZ      r5,|L1.2894|
;;;909        LISTVIEW_Obj* pObj;
;;;910        pObj = (LISTVIEW_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
000ad4  4628              MOV      r0,r5
000ad6  f7fffffe          BL       GUI_ALLOC_h2p
000ada  4604              MOV      r4,r0
;;;911        /* Init sub-classes */
;;;912        GUI_ARRAY_CREATE(&pObj->RowArray);
;;;913        GUI_ARRAY_CREATE(&pObj->ColumnArray);
;;;914        /* Init widget specific variables */
;;;915        WIDGET__Init(&pObj->Widget, Id, WIDGET_STATE_FOCUSSABLE);
000adc  2210              MOVS     r2,#0x10
000ade  4639              MOV      r1,r7
000ae0  4620              MOV      r0,r4
000ae2  f7fffffe          BL       WIDGET__Init
;;;916        /* Init member variables */
;;;917        LISTVIEW_INIT_ID(pObj);
;;;918        pObj->Props     = LISTVIEW_DefaultProps;
000ae6  4a95              LDR      r2,|L1.3388|
000ae8  4620              MOV      r0,r4
000aea  f8d2c008          LDR      r12,[r2,#8]  ; LISTVIEW_DefaultProps
000aee  68d6              LDR      r6,[r2,#0xc]  ; LISTVIEW_DefaultProps
000af0  6853              LDR      r3,[r2,#4]  ; LISTVIEW_DefaultProps
000af2  6811              LDR      r1,[r2,#0]  ; LISTVIEW_DefaultProps
000af4  f8c4c03c          STR      r12,[r4,#0x3c]
000af8  6426              STR      r6,[r4,#0x40]
000afa  63a3              STR      r3,[r4,#0x38]
000afc  6361              STR      r1,[r4,#0x34]
000afe  f8d2c018          LDR      r12,[r2,#0x18]  ; LISTVIEW_DefaultProps
000b02  69d6              LDR      r6,[r2,#0x1c]  ; LISTVIEW_DefaultProps
000b04  6953              LDR      r3,[r2,#0x14]  ; LISTVIEW_DefaultProps
000b06  6911              LDR      r1,[r2,#0x10]  ; LISTVIEW_DefaultProps
000b08  f8c4c04c          STR      r12,[r4,#0x4c]
000b0c  64a3              STR      r3,[r4,#0x48]
000b0e  6461              STR      r1,[r4,#0x44]
000b10  6506              STR      r6,[r0,#0x50]
000b12  6a53              LDR      r3,[r2,#0x24]  ; LISTVIEW_DefaultProps
000b14  6a11              LDR      r1,[r2,#0x20]  ; LISTVIEW_DefaultProps
000b16  6a92              LDR      r2,[r2,#0x28]  ; LISTVIEW_DefaultProps
000b18  6583              STR      r3,[r0,#0x58]
000b1a  65c2              STR      r2,[r0,#0x5c]
000b1c  6541              STR      r1,[r0,#0x54]
;;;919        pObj->ShowGrid  = 0;
000b1e  2100              MOVS     r1,#0
000b20  6661              STR      r1,[r4,#0x64]
;;;920        pObj->RowDistY  = 0;
000b22  66e1              STR      r1,[r4,#0x6c]
;;;921        pObj->Sel       = -1;
000b24  1e48              SUBS     r0,r1,#1
000b26  6620              STR      r0,[r4,#0x60]
;;;922        pObj->LBorder   = 1;
000b28  2101              MOVS     r1,#1
000b2a  6721              STR      r1,[r4,#0x70]
;;;923        pObj->RBorder   = 1;
000b2c  6761              STR      r1,[r4,#0x74]
;;;924        pObj->hHeader   = HEADER_CreateEx(0, 0, 0, 0, hObj, WM_CF_SHOW, 0, 0);
000b2e  2300              MOVS     r3,#0
000b30  2102              MOVS     r1,#2
000b32  9101              STR      r1,[sp,#4]
000b34  9302              STR      r3,[sp,#8]
000b36  461a              MOV      r2,r3
000b38  9500              STR      r5,[sp,#0]
000b3a  9303              STR      r3,[sp,#0xc]
000b3c  4619              MOV      r1,r3
000b3e  4618              MOV      r0,r3
000b40  f7fffffe          BL       HEADER_CreateEx
000b44  8520              STRH     r0,[r4,#0x28]
;;;925        LISTVIEW__UpdateScrollParas(hObj, pObj);
000b46  4621              MOV      r1,r4
000b48  4628              MOV      r0,r5
000b4a  f7fffffe          BL       LISTVIEW__UpdateScrollParas
                  |L1.2894|
;;;926      } else {
;;;927        GUI_DEBUG_ERROROUT_IF(hObj==0, "LISTVIEW_Create failed")
;;;928      }
;;;929      WM_UNLOCK();
000b4e  f7fffffe          BL       GUI_Unlock
;;;930      return hObj;
;;;931    }
000b52  b004              ADD      sp,sp,#0x10
000b54  4628              MOV      r0,r5                 ;930
000b56  e8bd87f0          POP      {r4-r10,pc}
;;;932    
                          ENDP

                  LISTVIEW_IncSel PROC
;;;942    */
;;;943    void LISTVIEW_IncSel(LISTVIEW_Handle hObj) {
000b5a  b510              PUSH     {r4,lr}
000b5c  4604              MOV      r4,r0
;;;944      if (hObj) {
000b5e  2c00              CMP      r4,#0
000b60  d00d              BEQ      |L1.2942|
;;;945        LISTVIEW_Obj* pObj;
;;;946        WM_LOCK();
000b62  f7fffffe          BL       GUI_Lock
;;;947        pObj = LISTVIEW_H2P(hObj);
000b66  4620              MOV      r0,r4
000b68  f7fffffe          BL       GUI_ALLOC_h2p
;;;948        LISTVIEW__MoveSel(hObj, pObj, 1);
000b6c  4601              MOV      r1,r0
000b6e  2201              MOVS     r2,#1
000b70  4620              MOV      r0,r4
000b72  f7fffffe          BL       LISTVIEW__MoveSel
;;;949        WM_UNLOCK();
000b76  e8bd4010          POP      {r4,lr}
000b7a  f7ffbffe          B.W      GUI_Unlock
                  |L1.2942|
;;;950      }
;;;951    }
000b7e  bd10              POP      {r4,pc}
;;;952    
                          ENDP

                  LISTVIEW_DecSel PROC
;;;956    */
;;;957    void LISTVIEW_DecSel(LISTVIEW_Handle hObj) {
000b80  b510              PUSH     {r4,lr}
000b82  4604              MOV      r4,r0
;;;958      if (hObj) {
000b84  2c00              CMP      r4,#0
000b86  d00e              BEQ      |L1.2982|
;;;959        LISTVIEW_Obj* pObj;
;;;960        WM_LOCK();
000b88  f7fffffe          BL       GUI_Lock
;;;961        pObj = LISTVIEW_H2P(hObj);
000b8c  4620              MOV      r0,r4
000b8e  f7fffffe          BL       GUI_ALLOC_h2p
;;;962        LISTVIEW__MoveSel(hObj, pObj, -1);
000b92  4601              MOV      r1,r0
000b94  f04f32ff          MOV      r2,#0xffffffff
000b98  4620              MOV      r0,r4
000b9a  f7fffffe          BL       LISTVIEW__MoveSel
;;;963        WM_UNLOCK();
000b9e  e8bd4010          POP      {r4,lr}
000ba2  f7ffbffe          B.W      GUI_Unlock
                  |L1.2982|
;;;964      }
;;;965    }
000ba6  bd10              POP      {r4,pc}
;;;966    
                          ENDP

                  LISTVIEW_AddColumn PROC
;;;970    */
;;;971    int LISTVIEW_AddColumn(LISTVIEW_Handle hObj, int Width, const char * s, int Align) {
000ba8  e92d43f0          PUSH     {r4-r9,lr}
000bac  b083              SUB      sp,sp,#0xc
000bae  4680              MOV      r8,r0
000bb0  460e              MOV      r6,r1
000bb2  4691              MOV      r9,r2
000bb4  461d              MOV      r5,r3
;;;972      int r = 0;
000bb6  2700              MOVS     r7,#0
;;;973      if (hObj) {
000bb8  f1b80f00          CMP      r8,#0
000bbc  d040              BEQ      |L1.3136|
;;;974        LISTVIEW_Obj* pObj;
;;;975        LISTVIEW_COLUMN Column = {0};
000bbe  2000              MOVS     r0,#0
000bc0  9000              STR      r0,[sp,#0]
000bc2  9001              STR      r0,[sp,#4]
;;;976        unsigned NumRows;
;;;977        WM_LOCK();
000bc4  f7fffffe          BL       GUI_Lock
;;;978        pObj = LISTVIEW_H2P(hObj);
000bc8  4640              MOV      r0,r8
000bca  f7fffffe          BL       GUI_ALLOC_h2p
000bce  4604              MOV      r4,r0
;;;979        HEADER_AddItem(pObj->hHeader, Width, s, Align);
000bd0  462b              MOV      r3,r5
000bd2  f9b40028          LDRSH    r0,[r4,#0x28]
000bd6  464a              MOV      r2,r9
000bd8  4631              MOV      r1,r6
000bda  f7fffffe          BL       HEADER_AddItem
;;;980        Column.Align = Align;
000bde  f88d5000          STRB     r5,[sp,#0]
;;;981        GUI_ARRAY_AddItem(&pObj->ColumnArray, &Column, sizeof(LISTVIEW_COLUMN));
000be2  2208              MOVS     r2,#8
000be4  4669              MOV      r1,sp
000be6  f104002e          ADD      r0,r4,#0x2e
000bea  f7fffffe          BL       GUI_ARRAY_AddItem
;;;982        pObj = LISTVIEW_H2P(hObj); /* Restore after allocating memory */
000bee  4640              MOV      r0,r8
000bf0  f7fffffe          BL       GUI_ALLOC_h2p
000bf4  4605              MOV      r5,r0
;;;983        NumRows = LISTVIEW__GetNumRows(pObj);
000bf6  4628              MOV      r0,r5
000bf8  f7fffffe          BL       LISTVIEW__GetNumRows
000bfc  4606              MOV      r6,r0
;;;984        if (NumRows) {
000bfe  2e00              CMP      r6,#0
000c00  d014              BEQ      |L1.3116|
;;;985          LISTVIEW_ROW* pRow;
;;;986          unsigned i;
;;;987          for (i = 0; i < NumRows; i++) {
000c02  463c              MOV      r4,r7
000c04  d912              BLS      |L1.3116|
                  |L1.3078|
;;;988            pRow = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, i);
000c06  4621              MOV      r1,r4
000c08  f105002a          ADD      r0,r5,#0x2a
000c0c  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;989            if (GUI_ARRAY_AddItem(&pRow->CellArray, NULL, sizeof(LISTVIEW_CELL))) {
000c10  2204              MOVS     r2,#4
000c12  2100              MOVS     r1,#0
000c14  f7fffffe          BL       GUI_ARRAY_AddItem
000c18  b108              CBZ      r0,|L1.3102|
;;;990              r = 1;
000c1a  2701              MOVS     r7,#1
;;;991              break;
000c1c  e006              B        |L1.3116|
                  |L1.3102|
;;;992            }
;;;993            pObj = LISTVIEW_H2P(hObj); /* Restore after allocating memory */
000c1e  4640              MOV      r0,r8
000c20  f7fffffe          BL       GUI_ALLOC_h2p
000c24  4605              MOV      r5,r0
000c26  1c64              ADDS     r4,r4,#1              ;987
000c28  42b4              CMP      r4,r6                 ;987
000c2a  d3ec              BCC      |L1.3078|
                  |L1.3116|
;;;994          }
;;;995        }
;;;996        LISTVIEW__UpdateScrollParas(hObj, pObj);
000c2c  4629              MOV      r1,r5
000c2e  4640              MOV      r0,r8
000c30  f7fffffe          BL       LISTVIEW__UpdateScrollParas
;;;997        LISTVIEW__InvalidateInsideArea(hObj, pObj);
000c34  4629              MOV      r1,r5
000c36  4640              MOV      r0,r8
000c38  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
;;;998        WM_UNLOCK();
000c3c  f7fffffe          BL       GUI_Unlock
                  |L1.3136|
;;;999      }
;;;1000     return r;
;;;1001   }
000c40  b003              ADD      sp,sp,#0xc
000c42  4638              MOV      r0,r7                 ;1000
000c44  e8bd83f0          POP      {r4-r9,pc}
;;;1002   
                          ENDP

                  LISTVIEW_AddRow PROC
;;;1006   */
;;;1007   int LISTVIEW_AddRow(LISTVIEW_Handle hObj, const GUI_ConstString* ppText) {
000c48  e92d4ff0          PUSH     {r4-r11,lr}
000c4c  b083              SUB      sp,sp,#0xc
000c4e  4683              MOV      r11,r0
000c50  460c              MOV      r4,r1
;;;1008     int r = 0;
000c52  f04f0900          MOV      r9,#0
;;;1009     if (hObj) {
000c56  f1bb0f00          CMP      r11,#0
000c5a  d00e              BEQ      |L1.3194|
;;;1010       LISTVIEW_Obj* pObj;
;;;1011       WM_LOCK();
000c5c  f7fffffe          BL       GUI_Lock
;;;1012       pObj = LISTVIEW_H2P(hObj);
000c60  4658              MOV      r0,r11
000c62  f7fffffe          BL       GUI_ALLOC_h2p
;;;1013       /* Add row item to the GUI_ARRAY */
;;;1014       if (GUI_ARRAY_AddItem(&pObj->RowArray, NULL, sizeof(LISTVIEW_ROW)) == 0) {
000c66  220c              MOVS     r2,#0xc
000c68  2100              MOVS     r1,#0
000c6a  302a              ADDS     r0,r0,#0x2a
000c6c  f7fffffe          BL       GUI_ARRAY_AddItem
000c70  b138              CBZ      r0,|L1.3202|
;;;1015         LISTVIEW_ROW* pRow;
;;;1016         int i, RowIndex, NumColumns, NumBytes;
;;;1017         const char* s;
;;;1018         pObj       = LISTVIEW_H2P(hObj);                                         /* Restore after allocating memory */
;;;1019         RowIndex   = LISTVIEW__GetNumRows(pObj) - 1;
;;;1020         NumColumns = LISTVIEW__GetNumColumns(pObj);
;;;1021         pRow       = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, RowIndex);
;;;1022         GUI_ARRAY_CREATE(&pRow->CellArray);
;;;1023         /* Add columns for the new row */
;;;1024         for (i = 0; i < NumColumns; i++) {
;;;1025           LISTVIEW_CELL* pCell;
;;;1026           s = (ppText) ? *ppText++ : 0;
;;;1027           if (s == 0) {
;;;1028             ppText = 0;
;;;1029           }
;;;1030           NumBytes = GUI__strlen(s) + 1;     /* 0 if no string is specified (s == NULL) */
;;;1031           if (GUI_ARRAY_AddItem(&pRow->CellArray, NULL, sizeof(LISTVIEW_CELL) + NumBytes)) {
;;;1032             r = 1;
;;;1033             break;
;;;1034           }
;;;1035           pObj  = LISTVIEW_H2P(hObj);                                            /* Restore after allocating memory */
;;;1036           pRow  = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, RowIndex); /* Restore after allocating memory */
;;;1037           pCell = (LISTVIEW_CELL*) GUI_ARRAY_GetpItem(&pRow->CellArray, i);
;;;1038           if (NumBytes > 1) {
;;;1039             strcpy(pCell->acText, s);
;;;1040           }
;;;1041         }
;;;1042         pObj->IsSorted = 0;
;;;1043         LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;1044         if (pObj->hSort && (pObj->SortIndex >= 0)) {
;;;1045           LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;1046         } else {
;;;1047           LISTVIEW__InvalidateRow(hObj, pObj, RowIndex);
;;;1048         }
;;;1049       } else {
;;;1050         r = 1;
000c72  f04f0901          MOV      r9,#1
                  |L1.3190|
;;;1051       }
;;;1052       WM_UNLOCK();
000c76  f7fffffe          BL       GUI_Unlock
                  |L1.3194|
;;;1053     }
;;;1054     return r;
;;;1055   }
000c7a  b003              ADD      sp,sp,#0xc
000c7c  4648              MOV      r0,r9                 ;1054
000c7e  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.3202|
000c82  4658              MOV      r0,r11                ;1018
000c84  f7fffffe          BL       GUI_ALLOC_h2p
000c88  4606              MOV      r6,r0                 ;1018
000c8a  4630              MOV      r0,r6                 ;1019
000c8c  f7fffffe          BL       LISTVIEW__GetNumRows
000c90  1e40              SUBS     r0,r0,#1              ;1019
000c92  9001              STR      r0,[sp,#4]            ;1019
000c94  4630              MOV      r0,r6                 ;1020
000c96  f7fffffe          BL       LISTVIEW__GetNumColumns
000c9a  4682              MOV      r10,r0                ;1020
000c9c  f106002a          ADD      r0,r6,#0x2a           ;1021
000ca0  9901              LDR      r1,[sp,#4]            ;1021
000ca2  f7fffffe          BL       GUI_ARRAY_GetpItem
000ca6  9002              STR      r0,[sp,#8]            ;1021
000ca8  2500              MOVS     r5,#0                 ;1024
000caa  f1ba0f00          CMP      r10,#0                ;1024
000cae  dd2d              BLE      |L1.3340|
                  |L1.3248|
000cb0  b114              CBZ      r4,|L1.3256|
000cb2  f8548b04          LDR      r8,[r4],#4            ;1026
000cb6  e001              B        |L1.3260|
                  |L1.3256|
000cb8  f04f0800          MOV      r8,#0                 ;1026
                  |L1.3260|
000cbc  f1b80f00          CMP      r8,#0                 ;1027
000cc0  d100              BNE      |L1.3268|
000cc2  2400              MOVS     r4,#0                 ;1028
                  |L1.3268|
000cc4  4640              MOV      r0,r8                 ;1030
000cc6  f7fffffe          BL       GUI__strlen
000cca  1c47              ADDS     r7,r0,#1              ;1030
000ccc  1d3a              ADDS     r2,r7,#4              ;1031
000cce  2100              MOVS     r1,#0                 ;1031
000cd0  9802              LDR      r0,[sp,#8]            ;1031
000cd2  f7fffffe          BL       GUI_ARRAY_AddItem
000cd6  b110              CBZ      r0,|L1.3294|
000cd8  f04f0901          MOV      r9,#1                 ;1032
000cdc  e016              B        |L1.3340|
                  |L1.3294|
000cde  4658              MOV      r0,r11                ;1035
000ce0  f7fffffe          BL       GUI_ALLOC_h2p
000ce4  4606              MOV      r6,r0                 ;1035
000ce6  f106002a          ADD      r0,r6,#0x2a           ;1036
000cea  9901              LDR      r1,[sp,#4]            ;1036
000cec  f7fffffe          BL       GUI_ARRAY_GetpItem
000cf0  9002              STR      r0,[sp,#8]            ;1036
000cf2  4629              MOV      r1,r5                 ;1037
000cf4  9802              LDR      r0,[sp,#8]            ;1037
000cf6  f7fffffe          BL       GUI_ARRAY_GetpItem
000cfa  2f01              CMP      r7,#1                 ;1038
000cfc  dd03              BLE      |L1.3334|
000cfe  4641              MOV      r1,r8                 ;1039
000d00  1c80              ADDS     r0,r0,#2              ;1039
000d02  f7fffffe          BL       strcpy
                  |L1.3334|
000d06  1c6d              ADDS     r5,r5,#1              ;1024
000d08  4555              CMP      r5,r10                ;1024
000d0a  dbd1              BLT      |L1.3248|
                  |L1.3340|
000d0c  2000              MOVS     r0,#0                 ;1042
000d0e  f8860094          STRB     r0,[r6,#0x94]         ;1042
000d12  4631              MOV      r1,r6                 ;1043
000d14  4658              MOV      r0,r11                ;1043
000d16  f7fffffe          BL       LISTVIEW__UpdateScrollParas
000d1a  f8b60092          LDRH     r0,[r6,#0x92]         ;1044
000d1e  b138              CBZ      r0,|L1.3376|
000d20  6eb0              LDR      r0,[r6,#0x68]         ;1044
000d22  2800              CMP      r0,#0                 ;1044
000d24  db04              BLT      |L1.3376|
000d26  4631              MOV      r1,r6                 ;1045
000d28  4658              MOV      r0,r11                ;1045
000d2a  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
000d2e  e7a2              B        |L1.3190|
                  |L1.3376|
000d30  4631              MOV      r1,r6                 ;1047
000d32  4658              MOV      r0,r11                ;1047
000d34  9a01              LDR      r2,[sp,#4]            ;1047
000d36  f7fffffe          BL       LISTVIEW__InvalidateRow
000d3a  e79c              B        |L1.3190|
;;;1056   
                          ENDP

                  |L1.3388|
                          DCD      ||.data||

                          AREA ||.data||, DATA, ALIGN=2

                  LISTVIEW_DefaultProps
                          DCD      0x00ffffff
                          DCD      0x00808080
                          DCD      0x00ff0000
                          DCD      0x00d3d3d3
                          DCD      0x00000000
                          DCD      0x00ffffff
                          DCD      0x00ffffff
                          DCD      0x00808080
                          DCD      0x00d3d3d3
                          DCD      GUI_Font13_1
000028  000a              DCW      0x000a
00002a  0000              DCB      0x00,0x00
