; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\progbar.o --depend=.\rvmdk\progbar.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\progbar.crf ..\..\..\..\..\uCGUI\GUI\Widget\PROGBAR.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  _Value2Pos PROC
;;;81     */
;;;82     static int _Value2Pos(const PROGBAR_Obj* pObj, int v) {
000000  b430              PUSH     {r4,r5}
;;;83       int IsVertical = pObj->Flags & PROGBAR_CF_VERTICAL;
000002  f8902050          LDRB     r2,[r0,#0x50]
000006  f0020c01          AND      r12,r2,#1
;;;84       int EffectSize = pObj->Widget.pEffect->EffectSize;
00000a  6a02              LDR      r2,[r0,#0x20]
00000c  6953              LDR      r3,[r2,#0x14]
;;;85       int Size  = IsVertical ? pObj->Widget.Win.Rect.y1 - pObj->Widget.Win.Rect.y0 + 1 : pObj->Widget.Win.Rect.x1 - pObj->Widget.Win.Rect.x0 + 1;
00000e  f1bc0f00          CMP      r12,#0
000012  d006              BEQ      |L1.34|
000014  f9b02006          LDRSH    r2,[r0,#6]
000018  f9b04002          LDRSH    r4,[r0,#2]
00001c  1b12              SUBS     r2,r2,r4
00001e  1c54              ADDS     r4,r2,#1
000020  e005              B        |L1.46|
                  |L1.34|
000022  f9b02004          LDRSH    r2,[r0,#4]
000026  f9b04000          LDRSH    r4,[r0,#0]
00002a  1b12              SUBS     r2,r2,r4
00002c  1c54              ADDS     r4,r2,#1
                  |L1.46|
;;;86       int Min   = pObj->Min;
00002e  6b42              LDR      r2,[r0,#0x34]
;;;87       int Max   = pObj->Max;
000030  6b80              LDR      r0,[r0,#0x38]
;;;88       if (v < Min) {
000032  4291              CMP      r1,r2
000034  da00              BGE      |L1.56|
;;;89     	  v = Min;
000036  4611              MOV      r1,r2
                  |L1.56|
;;;90       }
;;;91       if (v > Max) {
000038  4281              CMP      r1,r0
00003a  dd00              BLE      |L1.62|
;;;92     	  v = Max;
00003c  4601              MOV      r1,r0
                  |L1.62|
;;;93       }
;;;94       return EffectSize + ((Size - 2 * EffectSize) * (I32)(IsVertical ? Max - v : v - Min)) / (Max - Min);
00003e  425d              RSBS     r5,r3,#0
000040  eb040445          ADD      r4,r4,r5,LSL #1
000044  f1bc0f00          CMP      r12,#0
000048  d001              BEQ      |L1.78|
00004a  1a41              SUBS     r1,r0,r1
00004c  e000              B        |L1.80|
                  |L1.78|
00004e  1a89              SUBS     r1,r1,r2
                  |L1.80|
000050  4361              MULS     r1,r4,r1
000052  1a80              SUBS     r0,r0,r2
000054  fb91f0f0          SDIV     r0,r1,r0
;;;95     }
000058  bc30              POP      {r4,r5}
00005a  4418              ADD      r0,r0,r3              ;94
00005c  4770              BX       lr
;;;96     
                          ENDP

                  _DrawPart PROC
;;;100    */
;;;101    static void _DrawPart(const PROGBAR_Obj* pObj, int Index,
00005e  e92d41f0          PUSH     {r4-r8,lr}
;;;102    										  int xText, int yText, const char* pText) {
000062  4616              MOV      r6,r2
000064  9d06              LDR      r5,[sp,#0x18]
000066  461f              MOV      r7,r3
;;;103      LCD_SetBkColor(pObj->Props.aBarColor[Index]);
000068  eb000481          ADD      r4,r0,r1,LSL #2
00006c  6c20              LDR      r0,[r4,#0x40]
00006e  f7fffffe          BL       LCD_SetBkColor
;;;104      LCD_SetColor(pObj->Props.aTextColor[Index]);
000072  6ca0              LDR      r0,[r4,#0x48]
000074  f7fffffe          BL       LCD_SetColor
;;;105      GUI_Clear();
000078  f7fffffe          BL       GUI_Clear
;;;106      if (pText) {
00007c  2d00              CMP      r5,#0
00007e  d008              BEQ      |L1.146|
;;;107        GUI_GotoXY(xText, yText);
000080  4639              MOV      r1,r7
000082  4630              MOV      r0,r6
000084  f7fffffe          BL       GUI_GotoXY
;;;108        GUI_DispString(pText);
000088  4628              MOV      r0,r5
00008a  e8bd41f0          POP      {r4-r8,lr}
00008e  f7ffbffe          B.W      GUI_DispString
                  |L1.146|
;;;109      }
;;;110    }
000092  e8bd81f0          POP      {r4-r8,pc}
;;;111    
                          ENDP

                  PROGBAR__GetTextRect PROC
;;;216    */
;;;217    void PROGBAR__GetTextRect(const PROGBAR_Obj* pObj, GUI_RECT* pRect, const char* pText) {
000096  e92d41f0          PUSH     {r4-r8,lr}
00009a  4605              MOV      r5,r0
00009c  460c              MOV      r4,r1
;;;218      int xSize      = pObj->Widget.Win.Rect.x1 - pObj->Widget.Win.Rect.x0 + 1;
00009e  f9b50004          LDRSH    r0,[r5,#4]
0000a2  f9b51000          LDRSH    r1,[r5,#0]
0000a6  1a40              SUBS     r0,r0,r1
0000a8  1c47              ADDS     r7,r0,#1
;;;219      int ySize      = pObj->Widget.Win.Rect.y1 - pObj->Widget.Win.Rect.y0 + 1;
0000aa  f9b50006          LDRSH    r0,[r5,#6]
0000ae  f9b51002          LDRSH    r1,[r5,#2]
0000b2  1a40              SUBS     r0,r0,r1
0000b4  f1000801          ADD      r8,r0,#1
;;;220      int TextWidth  = GUI_GetStringDistX(pText);
0000b8  4610              MOV      r0,r2
0000ba  f7fffffe          BL       GUI_GetStringDistX
0000be  4606              MOV      r6,r0
;;;221      int TextHeight = GUI_GetFontSizeY();
0000c0  f7fffffe          BL       GUI_GetFontSizeY
0000c4  4602              MOV      r2,r0
;;;222      int EffectSize = pObj->Widget.pEffect->EffectSize;
0000c6  6a28              LDR      r0,[r5,#0x20]
0000c8  6940              LDR      r0,[r0,#0x14]
;;;223      switch (pObj->TextAlign & GUI_TA_HORIZONTAL) {
0000ca  8e69              LDRH     r1,[r5,#0x32]
0000cc  f0010103          AND      r1,r1,#3
0000d0  2901              CMP      r1,#1
0000d2  d01d              BEQ      |L1.272|
0000d4  2902              CMP      r1,#2
0000d6  d015              BEQ      |L1.260|
;;;224      case GUI_TA_CENTER:
;;;225        pRect->x0 = (xSize - TextWidth) / 2;
;;;226    		break;
;;;227      case GUI_TA_RIGHT:
;;;228        pRect->x0 = xSize - TextWidth - 1 - EffectSize;
;;;229    		break;
;;;230      default:
;;;231        pRect->x0 = EffectSize;
0000d8  8020              STRH     r0,[r4,#0]
                  |L1.218|
;;;232    	}
;;;233      pRect->y0  = (ySize - TextHeight) / 2;
0000da  eba80002          SUB      r0,r8,r2
0000de  eb0070d0          ADD      r0,r0,r0,LSR #31
0000e2  1041              ASRS     r1,r0,#1
0000e4  8061              STRH     r1,[r4,#2]
;;;234      pRect->x0 += pObj->XOff;
0000e6  8820              LDRH     r0,[r4,#0]
0000e8  8deb              LDRH     r3,[r5,#0x2e]
0000ea  4418              ADD      r0,r0,r3
0000ec  8020              STRH     r0,[r4,#0]
;;;235      pRect->y0 += pObj->YOff;
0000ee  8e2b              LDRH     r3,[r5,#0x30]
0000f0  4419              ADD      r1,r1,r3
0000f2  8061              STRH     r1,[r4,#2]
;;;236      pRect->x1  = pRect->x0 + TextWidth  - 1;
0000f4  1e73              SUBS     r3,r6,#1
0000f6  4418              ADD      r0,r0,r3
0000f8  80a0              STRH     r0,[r4,#4]
;;;237      pRect->y1  = pRect->y0 + TextHeight - 1;
0000fa  1e50              SUBS     r0,r2,#1
0000fc  4408              ADD      r0,r0,r1
0000fe  80e0              STRH     r0,[r4,#6]
;;;238    }
000100  e8bd81f0          POP      {r4-r8,pc}
                  |L1.260|
000104  1bb8              SUBS     r0,r7,r6              ;225
000106  eb0070d0          ADD      r0,r0,r0,LSR #31      ;225
00010a  1040              ASRS     r0,r0,#1              ;225
00010c  8020              STRH     r0,[r4,#0]            ;225
00010e  e7e4              B        |L1.218|
                  |L1.272|
000110  1bb9              SUBS     r1,r7,r6              ;228
000112  1a08              SUBS     r0,r1,r0              ;228
000114  1e40              SUBS     r0,r0,#1              ;228
000116  8020              STRH     r0,[r4,#0]            ;228
000118  e7df              B        |L1.218|
;;;239    
                          ENDP

                  PROGBAR__GetText PROC
;;;199    */
;;;200    const char * PROGBAR__GetText(const PROGBAR_Obj* pObj, char* pBuffer) {
00011a  b513              PUSH     {r0,r1,r4,lr}
;;;201      char* pText;
;;;202      if (pObj->hpText) {
00011c  f9b0102c          LDRSH    r1,[r0,#0x2c]
000120  b121              CBZ      r1,|L1.300|
;;;203        pText = (char*) GUI_ALLOC_h2p(pObj->hpText);
000122  4608              MOV      r0,r1
000124  f7fffffe          BL       GUI_ALLOC_h2p
000128  4604              MOV      r4,r0
00012a  e013              B        |L1.340|
                  |L1.300|
;;;204      } else {
;;;205        pText = pBuffer;
00012c  9c01              LDR      r4,[sp,#4]
;;;206        GUI_AddDecMin((100 * (I32)(pObj->v - pObj->Min)) / (pObj->Max - pObj->Min), &pBuffer);
00012e  6a82              LDR      r2,[r0,#0x28]
000130  6b41              LDR      r1,[r0,#0x34]
000132  6b80              LDR      r0,[r0,#0x38]
000134  1a52              SUBS     r2,r2,r1
000136  2364              MOVS     r3,#0x64
000138  1a40              SUBS     r0,r0,r1
00013a  435a              MULS     r2,r3,r2
00013c  fb92f0f0          SDIV     r0,r2,r0
000140  a901              ADD      r1,sp,#4
000142  f7fffffe          BL       GUI_AddDecMin
;;;207        *pBuffer++ = '%';
000146  9801              LDR      r0,[sp,#4]
000148  2125              MOVS     r1,#0x25
00014a  f8001b01          STRB     r1,[r0],#1
00014e  9001              STR      r0,[sp,#4]
;;;208    		*pBuffer   = 0;
000150  2100              MOVS     r1,#0
000152  7001              STRB     r1,[r0,#0]
                  |L1.340|
;;;209    	}
;;;210      return (const char*)pText;
;;;211    }
000154  b002              ADD      sp,sp,#8
000156  4620              MOV      r0,r4                 ;210
000158  bd10              POP      {r4,pc}
;;;212    
                          ENDP

                  _Paint PROC
;;;115    */
;;;116    static void _Paint(PROGBAR_Obj * pObj) {
00015a  b5f0              PUSH     {r4-r7,lr}
00015c  b08d              SUB      sp,sp,#0x34
00015e  4604              MOV      r4,r0
;;;117      GUI_RECT r, rInside, rClient, rText;
;;;118      const char* pText;
;;;119      char ac[5];
;;;120      int tm, Pos;
;;;121      WM_GetClientRect(&rClient);
000160  a806              ADD      r0,sp,#0x18
000162  f7fffffe          BL       WM_GetClientRect
;;;122      GUI__ReduceRect(&rInside, &rClient, pObj->Widget.pEffect->EffectSize);
000166  6a20              LDR      r0,[r4,#0x20]
000168  a906              ADD      r1,sp,#0x18
00016a  6942              LDR      r2,[r0,#0x14]
00016c  a808              ADD      r0,sp,#0x20
00016e  f7fffffe          BL       GUI__ReduceRect
;;;123      Pos  = _Value2Pos(pObj, pObj->v);
000172  4620              MOV      r0,r4
000174  6aa1              LDR      r1,[r4,#0x28]
000176  f7fffffe          BL       _Value2Pos
00017a  4605              MOV      r5,r0
;;;124      if (pObj->Flags & PROGBAR_CF_VERTICAL) {
00017c  f8940050          LDRB     r0,[r4,#0x50]
000180  f0100f01          TST      r0,#1
000184  d021              BEQ      |L1.458|
;;;125        /* Draw lower part */
;;;126        r    = rInside;
000186  9909              LDR      r1,[sp,#0x24]
000188  9808              LDR      r0,[sp,#0x20]
00018a  910b              STR      r1,[sp,#0x2c]
00018c  900a              STR      r0,[sp,#0x28]
;;;127        r.y0 = Pos;
00018e  f8ad502a          STRH     r5,[sp,#0x2a]
;;;128        WM_SetUserClipArea(&r);
000192  a80a              ADD      r0,sp,#0x28
000194  f7fffffe          BL       WM_SetUserClipRect
;;;129        _DrawPart(pObj, 0, 0, 0, 0);
000198  2300              MOVS     r3,#0
00019a  461a              MOV      r2,r3
00019c  4619              MOV      r1,r3
00019e  4620              MOV      r0,r4
0001a0  9300              STR      r3,[sp,#0]
0001a2  f7fffffe          BL       _DrawPart
;;;130        /* Draw upper part */
;;;131        r    = rInside;
0001a6  9909              LDR      r1,[sp,#0x24]
0001a8  9808              LDR      r0,[sp,#0x20]
0001aa  910b              STR      r1,[sp,#0x2c]
0001ac  900a              STR      r0,[sp,#0x28]
;;;132        r.y1 = Pos - 1;
0001ae  1e68              SUBS     r0,r5,#1
0001b0  f8ad002e          STRH     r0,[sp,#0x2e]
;;;133        WM_SetUserClipArea(&r);
0001b4  a80a              ADD      r0,sp,#0x28
0001b6  f7fffffe          BL       WM_SetUserClipRect
;;;134        _DrawPart(pObj, 1, 0, 0, 0);
0001ba  2300              MOVS     r3,#0
0001bc  461a              MOV      r2,r3
0001be  2101              MOVS     r1,#1
0001c0  4620              MOV      r0,r4
0001c2  9300              STR      r3,[sp,#0]
0001c4  f7fffffe          BL       _DrawPart
0001c8  e035              B        |L1.566|
                  |L1.458|
;;;135      } else {
;;;136        pText = PROGBAR__GetText(pObj, ac);
0001ca  a902              ADD      r1,sp,#8
0001cc  4620              MOV      r0,r4
0001ce  f7fffffe          BL       PROGBAR__GetText
0001d2  4606              MOV      r6,r0
;;;137        GUI_SetFont(pObj->Props.pFont);
0001d4  6be0              LDR      r0,[r4,#0x3c]
0001d6  f7fffffe          BL       GUI_SetFont
;;;138        PROGBAR__GetTextRect(pObj, &rText, pText);
0001da  4632              MOV      r2,r6
0001dc  a904              ADD      r1,sp,#0x10
0001de  4620              MOV      r0,r4
0001e0  f7fffffe          BL       PROGBAR__GetTextRect
;;;139        tm = GUI_SetTextMode(GUI_TM_TRANS);
0001e4  2002              MOVS     r0,#2
0001e6  f7fffffe          BL       GUI_SetTextMode
0001ea  4607              MOV      r7,r0
;;;140        /* Draw left bar */
;;;141        r    = rInside;
0001ec  9909              LDR      r1,[sp,#0x24]
0001ee  9808              LDR      r0,[sp,#0x20]
0001f0  910b              STR      r1,[sp,#0x2c]
0001f2  900a              STR      r0,[sp,#0x28]
;;;142        r.x1 = Pos - 1;
0001f4  1e68              SUBS     r0,r5,#1
0001f6  f8ad002c          STRH     r0,[sp,#0x2c]
;;;143        WM_SetUserClipArea(&r);
0001fa  a80a              ADD      r0,sp,#0x28
0001fc  f7fffffe          BL       WM_SetUserClipRect
;;;144        _DrawPart(pObj, 0, rText.x0, rText.y0, pText);
000200  9600              STR      r6,[sp,#0]
000202  f9bd3012          LDRSH    r3,[sp,#0x12]
000206  f9bd2010          LDRSH    r2,[sp,#0x10]
00020a  2100              MOVS     r1,#0
00020c  4620              MOV      r0,r4
00020e  f7fffffe          BL       _DrawPart
;;;145        /* Draw right bar */
;;;146        r    = rInside;
000212  9909              LDR      r1,[sp,#0x24]
000214  9808              LDR      r0,[sp,#0x20]
000216  910b              STR      r1,[sp,#0x2c]
000218  900a              STR      r0,[sp,#0x28]
;;;147        r.x0 = Pos;
00021a  f8ad5028          STRH     r5,[sp,#0x28]
;;;148        WM_SetUserClipArea(&r);
00021e  a80a              ADD      r0,sp,#0x28
000220  f7fffffe          BL       WM_SetUserClipRect
;;;149        _DrawPart(pObj, 1, rText.x0, rText.y0, pText);
000224  9600              STR      r6,[sp,#0]
000226  f9bd3012          LDRSH    r3,[sp,#0x12]
00022a  f9bd2010          LDRSH    r2,[sp,#0x10]
00022e  2101              MOVS     r1,#1
000230  4620              MOV      r0,r4
000232  f7fffffe          BL       _DrawPart
                  |L1.566|
;;;150      }
;;;151      WM_SetUserClipArea(NULL);
000236  2000              MOVS     r0,#0
000238  f7fffffe          BL       WM_SetUserClipRect
;;;152      GUI_SetTextMode(tm);
00023c  4638              MOV      r0,r7
00023e  f7fffffe          BL       GUI_SetTextMode
;;;153      WIDGET__EFFECT_DrawDownRect(&pObj->Widget, &rClient);
000242  a906              ADD      r1,sp,#0x18
000244  4620              MOV      r0,r4
000246  f7fffffe          BL       WIDGET__EFFECT_DrawDownRect
;;;154    }
00024a  b00d              ADD      sp,sp,#0x34
00024c  bdf0              POP      {r4-r7,pc}
;;;155    
                          ENDP

                  PROGBAR__FreeText PROC
;;;190    */
;;;191    void PROGBAR__FreeText(PROGBAR_Handle hObj) {
00024e  b510              PUSH     {r4,lr}
;;;192      PROGBAR_Obj* pObj = PROGBAR_H2P(hObj);
000250  f7fffffe          BL       GUI_ALLOC_h2p
;;;193      GUI_ALLOC_FreePtr(&pObj->hpText);
000254  e8bd4010          POP      {r4,lr}
000258  302c              ADDS     r0,r0,#0x2c
00025a  f7ffbffe          B.W      GUI_ALLOC_FreePtr
;;;194    }
;;;195    
                          ENDP

                  _Delete PROC
;;;159    */
;;;160    static void _Delete(PROGBAR_Handle hObj) {
00025e  e7fe              B        PROGBAR__FreeText
;;;161      PROGBAR__FreeText(hObj);
;;;162    }
;;;163    
                          ENDP

                  PROGBAR_Callback PROC
;;;249    */
;;;250    void PROGBAR_Callback(WM_MESSAGE * pMsg) {
000260  b570              PUSH     {r4-r6,lr}
000262  4604              MOV      r4,r0
;;;251      PROGBAR_Handle hObj;
;;;252      PROGBAR_Obj * pObj;
;;;253      hObj = pMsg->hWin;
000264  f9b45004          LDRSH    r5,[r4,#4]
;;;254      pObj = (PROGBAR_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
000268  4628              MOV      r0,r5
00026a  f7fffffe          BL       GUI_ALLOC_h2p
00026e  4606              MOV      r6,r0
;;;255      /* Let widget handle the standard messages */
;;;256      if (WIDGET_HandleActive(hObj, pMsg) == 0) {
000270  4621              MOV      r1,r4
000272  4628              MOV      r0,r5
000274  f7fffffe          BL       WIDGET_HandleActive
000278  2800              CMP      r0,#0
00027a  d010              BEQ      |L1.670|
;;;257        return;
;;;258      }
;;;259      switch (pMsg->MsgId) {
00027c  6822              LDR      r2,[r4,#0]
00027e  2a0b              CMP      r2,#0xb
000280  d005              BEQ      |L1.654|
000282  2a0f              CMP      r2,#0xf
000284  d106              BNE      |L1.660|
;;;260      case WM_PAINT:
;;;261        _Paint(pObj);
000286  4630              MOV      r0,r6
000288  e8bd4070          POP      {r4-r6,lr}
00028c  e7fe              B        _Paint
                  |L1.654|
;;;262        return;
;;;263      case WM_DELETE:
;;;264        _Delete(hObj);
00028e  4628              MOV      r0,r5
000290  f7fffffe          BL       _Delete
                  |L1.660|
;;;265        break;
;;;266      }
;;;267      WM_DefaultProc(pMsg);
000294  4620              MOV      r0,r4
000296  e8bd4070          POP      {r4-r6,lr}
00029a  f7ffbffe          B.W      WM_DefaultProc
                  |L1.670|
;;;268    }
00029e  bd70              POP      {r4-r6,pc}
;;;269    
                          ENDP

                  PROGBAR_CreateEx PROC
;;;279    */
;;;280    PROGBAR_Handle PROGBAR_CreateEx(int x0, int y0, int xsize, int ysize, WM_HWIN hParent,
0002a0  e92d4ff0          PUSH     {r4-r11,lr}
;;;281                                    int WinFlags, int ExFlags, int Id)
;;;282    {
0002a4  b085              SUB      sp,sp,#0x14
0002a6  4680              MOV      r8,r0
0002a8  4689              MOV      r9,r1
0002aa  4692              MOV      r10,r2
0002ac  469b              MOV      r11,r3
0002ae  9f11              LDR      r7,[sp,#0x44]
0002b0  9e10              LDR      r6,[sp,#0x40]
0002b2  9d0e              LDR      r5,[sp,#0x38]
0002b4  9c0f              LDR      r4,[sp,#0x3c]
;;;283      PROGBAR_Handle hObj;
;;;284      WM_LOCK();
0002b6  f7fffffe          BL       GUI_Lock
;;;285      hObj = WM_CreateWindowAsChild(x0, y0, xsize, ysize, hParent, WinFlags, PROGBAR_Callback,
0002ba  2334              MOVS     r3,#0x34
0002bc  f2af025f          ADR      r2,PROGBAR_Callback + 1
0002c0  b2a1              UXTH     r1,r4
0002c2  9303              STR      r3,[sp,#0xc]
0002c4  9202              STR      r2,[sp,#8]
0002c6  9101              STR      r1,[sp,#4]
0002c8  9500              STR      r5,[sp,#0]
0002ca  465b              MOV      r3,r11
0002cc  4652              MOV      r2,r10
0002ce  4649              MOV      r1,r9
0002d0  4640              MOV      r0,r8
0002d2  f7fffffe          BL       WM_CreateWindowAsChild
0002d6  4605              MOV      r5,r0
;;;286                                    sizeof(PROGBAR_Obj) - sizeof(WM_Obj));
;;;287      if (hObj) {
0002d8  b30d              CBZ      r5,|L1.798|
;;;288        PROGBAR_Obj* pObj;
;;;289        pObj = (PROGBAR_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
0002da  4628              MOV      r0,r5
0002dc  f7fffffe          BL       GUI_ALLOC_h2p
0002e0  4604              MOV      r4,r0
;;;290        /* init widget specific variables */
;;;291        WIDGET__Init(&pObj->Widget, Id, 0);
0002e2  2200              MOVS     r2,#0
0002e4  4639              MOV      r1,r7
0002e6  4620              MOV      r0,r4
0002e8  f7fffffe          BL       WIDGET__Init
;;;292        WIDGET_SetEffect(hObj, &WIDGET_Effect_None); /* Standard effect for progbar: None */
0002ec  495a              LDR      r1,|L1.1112|
0002ee  4628              MOV      r0,r5
0002f0  f7fffffe          BL       WIDGET_SetEffect
;;;293        PROGBAR_INIT_ID(pObj);
;;;294        /* init member variables */
;;;295        pObj->Props        = PROGBAR_DefaultProps;
0002f4  4959              LDR      r1,|L1.1116|
0002f6  f8d1c008          LDR      r12,[r1,#8]  ; PROGBAR_DefaultProps
0002fa  68cf              LDR      r7,[r1,#0xc]  ; PROGBAR_DefaultProps
0002fc  684b              LDR      r3,[r1,#4]  ; PROGBAR_DefaultProps
0002fe  680a              LDR      r2,[r1,#0]  ; PROGBAR_DefaultProps
000300  f8c4c044          STR      r12,[r4,#0x44]
000304  64a7              STR      r7,[r4,#0x48]
000306  6423              STR      r3,[r4,#0x40]
000308  63e2              STR      r2,[r4,#0x3c]
00030a  6909              LDR      r1,[r1,#0x10]  ; PROGBAR_DefaultProps
00030c  64e1              STR      r1,[r4,#0x4c]
;;;296        pObj->TextAlign    = GUI_TA_CENTER;
00030e  2002              MOVS     r0,#2
000310  8660              STRH     r0,[r4,#0x32]
;;;297        pObj->Max          = 100;
000312  2064              MOVS     r0,#0x64
000314  63a0              STR      r0,[r4,#0x38]
;;;298        pObj->Min          = 0;
000316  2000              MOVS     r0,#0
000318  6360              STR      r0,[r4,#0x34]
;;;299        pObj->Flags        = ExFlags;
00031a  f8846050          STRB     r6,[r4,#0x50]
                  |L1.798|
;;;300      }
;;;301      WM_UNLOCK();
00031e  f7fffffe          BL       GUI_Unlock
;;;302      return hObj;
;;;303    }
000322  b005              ADD      sp,sp,#0x14
000324  4628              MOV      r0,r5                 ;302
000326  e8bd8ff0          POP      {r4-r11,pc}
;;;304    
                          ENDP

                  PROGBAR_SetValue PROC
;;;314    */
;;;315    void PROGBAR_SetValue(PROGBAR_Handle hObj, int v) {
00032a  e92d41f0          PUSH     {r4-r8,lr}
00032e  b086              SUB      sp,sp,#0x18
000330  4606              MOV      r6,r0
000332  460d              MOV      r5,r1
;;;316      if (hObj) {
000334  2e00              CMP      r6,#0
000336  d07e              BEQ      |L1.1078|
;;;317        PROGBAR_Obj* pObj;
;;;318        WM_LOCK();
000338  f7fffffe          BL       GUI_Lock
;;;319        pObj= PROGBAR_H2P(hObj);
00033c  4630              MOV      r0,r6
00033e  f7fffffe          BL       GUI_ALLOC_h2p
000342  4604              MOV      r4,r0
;;;320        /* Put v into legal range */
;;;321        if (v < pObj->Min) {
000344  6b60              LDR      r0,[r4,#0x34]
000346  42a8              CMP      r0,r5
000348  dd00              BLE      |L1.844|
;;;322    	    v = pObj->Min;
00034a  4605              MOV      r5,r0
                  |L1.844|
;;;323        }
;;;324        if (v > pObj->Max) {
00034c  6ba0              LDR      r0,[r4,#0x38]
00034e  42a8              CMP      r0,r5
000350  da00              BGE      |L1.852|
;;;325    	    v = pObj->Max;
000352  4605              MOV      r5,r0
                  |L1.852|
;;;326        }
;;;327        if (pObj->v != v) {
000354  6aa0              LDR      r0,[r4,#0x28]
000356  42a8              CMP      r0,r5
000358  d04f              BEQ      |L1.1018|
;;;328          GUI_RECT r;
;;;329          if (pObj->Flags & PROGBAR_CF_VERTICAL) {
00035a  f8940050          LDRB     r0,[r4,#0x50]
00035e  f04f0700          MOV      r7,#0                 ;315
000362  f0100f01          TST      r0,#1
;;;330            /* Get y values */
;;;331            if (v < pObj->v) {
;;;332              r.y1 = _Value2Pos(pObj, v);
;;;333              r.y0 = _Value2Pos(pObj, pObj->v);
;;;334            } else {
;;;335              r.y1 = _Value2Pos(pObj, pObj->v);
;;;336              r.y0 = _Value2Pos(pObj, v);
;;;337            }
;;;338    		    r.x0    = 0;
;;;339    		    r.x1    = 4095;
000366  f64078ff          MOV      r8,#0xfff
00036a  d020              BEQ      |L1.942|
00036c  6aa1              LDR      r1,[r4,#0x28]         ;331
00036e  42a9              CMP      r1,r5                 ;331
000370  dd0c              BLE      |L1.908|
000372  4629              MOV      r1,r5                 ;332
000374  4620              MOV      r0,r4                 ;332
000376  f7fffffe          BL       _Value2Pos
00037a  f8ad0016          STRH     r0,[sp,#0x16]         ;332
00037e  4620              MOV      r0,r4                 ;333
000380  6aa1              LDR      r1,[r4,#0x28]         ;333
000382  f7fffffe          BL       _Value2Pos
000386  f8ad0012          STRH     r0,[sp,#0x12]         ;333
00038a  e00a              B        |L1.930|
                  |L1.908|
00038c  4620              MOV      r0,r4                 ;335
00038e  f7fffffe          BL       _Value2Pos
000392  f8ad0016          STRH     r0,[sp,#0x16]         ;335
000396  4629              MOV      r1,r5                 ;336
000398  4620              MOV      r0,r4                 ;336
00039a  f7fffffe          BL       _Value2Pos
00039e  f8ad0012          STRH     r0,[sp,#0x12]         ;336
                  |L1.930|
0003a2  f8ad7010          STRH     r7,[sp,#0x10]         ;338
0003a6  f8ad8014          STRH     r8,[sp,#0x14]
;;;340            pObj->v = v;
0003aa  62a5              STR      r5,[r4,#0x28]
0003ac  e021              B        |L1.1010|
                  |L1.942|
;;;341          } else {
;;;342            /* Get x values */
;;;343            if (v < pObj->v) {
0003ae  6aa1              LDR      r1,[r4,#0x28]
0003b0  42a9              CMP      r1,r5
0003b2  dd0c              BLE      |L1.974|
;;;344              r.x0 = _Value2Pos(pObj, v);
0003b4  4629              MOV      r1,r5
0003b6  4620              MOV      r0,r4
0003b8  f7fffffe          BL       _Value2Pos
0003bc  f8ad0010          STRH     r0,[sp,#0x10]
;;;345              r.x1 = _Value2Pos(pObj, pObj->v);
0003c0  4620              MOV      r0,r4
0003c2  6aa1              LDR      r1,[r4,#0x28]
0003c4  f7fffffe          BL       _Value2Pos
0003c8  f8ad0014          STRH     r0,[sp,#0x14]
0003cc  e00a              B        |L1.996|
                  |L1.974|
;;;346            } else {
;;;347              r.x0 = _Value2Pos(pObj, pObj->v);
0003ce  4620              MOV      r0,r4
0003d0  f7fffffe          BL       _Value2Pos
0003d4  f8ad0010          STRH     r0,[sp,#0x10]
;;;348              r.x1 = _Value2Pos(pObj, v);
0003d8  4629              MOV      r1,r5
0003da  4620              MOV      r0,r4
0003dc  f7fffffe          BL       _Value2Pos
0003e0  f8ad0014          STRH     r0,[sp,#0x14]
                  |L1.996|
;;;349            }
;;;350    		    r.y0    = 0;
0003e4  f8ad7012          STRH     r7,[sp,#0x12]
;;;351    		    r.y1    = 4095;
0003e8  f8ad8016          STRH     r8,[sp,#0x16]
;;;352            if (pObj->hpText == 0) {
0003ec  8da0              LDRH     r0,[r4,#0x2c]
0003ee  b148              CBZ      r0,|L1.1028|
;;;353              const GUI_FONT GUI_UNI_PTR * pOldFont;
;;;354              char acBuffer[5];
;;;355              GUI_RECT rText;
;;;356              pOldFont = GUI_SetFont(pObj->Props.pFont);
;;;357              PROGBAR__GetTextRect(pObj, &rText, PROGBAR__GetText(pObj, acBuffer));
;;;358              GUI_MergeRect(&r, &r, &rText);
;;;359              pObj->v = v;
;;;360              PROGBAR__GetTextRect(pObj, &rText, PROGBAR__GetText(pObj, acBuffer));
;;;361              GUI_MergeRect(&r, &r, &rText);
;;;362              GUI_SetFont(pOldFont);
;;;363            } else {
;;;364              pObj->v = v;
0003f0  62a5              STR      r5,[r4,#0x28]
                  |L1.1010|
;;;365            }
;;;366          }
;;;367          WM_InvalidateRect(hObj, &r);
0003f2  a904              ADD      r1,sp,#0x10
0003f4  4630              MOV      r0,r6
0003f6  f7fffffe          BL       WM_InvalidateRect
                  |L1.1018|
;;;368        }
;;;369        WM_UNLOCK();
0003fa  b006              ADD      sp,sp,#0x18
0003fc  e8bd41f0          POP      {r4-r8,lr}
000400  f7ffbffe          B.W      GUI_Unlock
                  |L1.1028|
000404  6be0              LDR      r0,[r4,#0x3c]         ;356
000406  f7fffffe          BL       GUI_SetFont
00040a  4607              MOV      r7,r0                 ;356
00040c  a902              ADD      r1,sp,#8              ;357
00040e  4620              MOV      r0,r4                 ;357
000410  f7fffffe          BL       PROGBAR__GetText
000414  4602              MOV      r2,r0                 ;357
000416  4669              MOV      r1,sp                 ;357
000418  4620              MOV      r0,r4                 ;357
00041a  f7fffffe          BL       PROGBAR__GetTextRect
00041e  466a              MOV      r2,sp                 ;358
000420  a904              ADD      r1,sp,#0x10           ;358
000422  a804              ADD      r0,sp,#0x10           ;358
000424  f7fffffe          BL       GUI_MergeRect
000428  62a5              STR      r5,[r4,#0x28]         ;359
00042a  a902              ADD      r1,sp,#8              ;360
00042c  4620              MOV      r0,r4                 ;360
00042e  f7fffffe          BL       PROGBAR__GetText
000432  4602              MOV      r2,r0                 ;360
000434  e000              B        |L1.1080|
                  |L1.1078|
000436  e00c              B        |L1.1106|
                  |L1.1080|
000438  4669              MOV      r1,sp                 ;360
00043a  4620              MOV      r0,r4                 ;360
00043c  f7fffffe          BL       PROGBAR__GetTextRect
000440  466a              MOV      r2,sp                 ;361
000442  a904              ADD      r1,sp,#0x10           ;361
000444  a804              ADD      r0,sp,#0x10           ;361
000446  f7fffffe          BL       GUI_MergeRect
00044a  4638              MOV      r0,r7                 ;362
00044c  f7fffffe          BL       GUI_SetFont
000450  e7cf              B        |L1.1010|
                  |L1.1106|
;;;370      }
;;;371    }
000452  b006              ADD      sp,sp,#0x18
000454  e8bd81f0          POP      {r4-r8,pc}
;;;372    
                          ENDP

                  |L1.1112|
                          DCD      WIDGET_Effect_None
                  |L1.1116|
                          DCD      ||.data||

                          AREA ||.data||, DATA, ALIGN=2

                  PROGBAR_DefaultProps
                          DCD      GUI_Font6x8
                          DCD      0x00555555
                          DCD      0x00aaaaaa
                          DCD      0x00ffffff
                          DCD      0x00000000
