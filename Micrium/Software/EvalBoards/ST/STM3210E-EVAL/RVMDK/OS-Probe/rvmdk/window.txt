; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\rvmdk\window.o --depend=.\rvmdk\window.d --cpu=Cortex-M3 --apcs=interwork -O1 -Otime -I. -I..\BSP -I..\..\..\..\..\uCOS-II\Ports\arm-cortex-m3\Generic\RealView -I..\..\..\..\..\uCOS-II\Source -I..\..\..\..\..\CPU\ST\STM32\inc -I..\..\..\..\..\uC-CPU -I..\..\..\..\..\uC-CPU\Arm-Cortex-M3\RealView -I..\..\..\..\..\uC-LIB -I..\..\..\..\..\uC-Probe\Target\Plugins\uCOS-II -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\Source -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Ports\ST\STM32 -I..\..\..\..\..\uC-Probe\Target\Communication\Generic\RS-232\Source -I..\..\..\..\..\User\inc -I..\..\..\..\..\uCGUI\Config -I..\..\..\..\..\uCGUI\GUIDemo -I..\..\..\..\..\uCGUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\AntiAlias -I..\..\..\..\..\uCGUI\GUI\ConvertColor -I..\..\..\..\..\uCGUI\GUI\ConvertMono -I..\..\..\..\..\uCGUI\GUI\Core -I..\..\..\..\..\uCGUI\GUI\Font -I..\..\..\..\..\uCGUI\GUI\LCDDriver -I..\..\..\..\..\uCGUI\GUI\MemDev -I..\..\..\..\..\uCGUI\GUI\MultiLayer -I..\..\..\..\..\uCGUI\GUI\Widget -I..\..\..\..\..\uCGUI\GUI\WM -Id:\Keil-stm32\ARM\INC -Id:\Keil-stm32\ARM\INC\ST\STM32F10x -D__MICROLIB --omf_browse=.\rvmdk\window.crf ..\..\..\..\..\uCGUI\GUI\Widget\WINDOW.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  _OnChildHasFocus PROC
;;;71     */
;;;72     static void _OnChildHasFocus(WM_HWIN hWin, WINDOW_OBJ* pObj, const WM_MESSAGE* pMsg) {
000000  b570              PUSH     {r4-r6,lr}
000002  4606              MOV      r6,r0
000004  460d              MOV      r5,r1
;;;73       if (pMsg->Data.p) {
000006  6894              LDR      r4,[r2,#8]
000008  2c00              CMP      r4,#0
00000a  d00f              BEQ      |L1.44|
;;;74         const WM_NOTIFY_CHILD_HAS_FOCUS_INFO * pInfo = (const WM_NOTIFY_CHILD_HAS_FOCUS_INFO *)pMsg->Data.p;
;;;75         int IsDesc = WM__IsAncestorOrSelf(pInfo->hNew, hWin);
00000c  f9b40002          LDRSH    r0,[r4,#2]
000010  4631              MOV      r1,r6
000012  f7fffffe          BL       WM__IsAncestorOrSelf
;;;76         if (!IsDesc) {  /* A child has received the focus, Framewindow needs to be activated */
000016  2800              CMP      r0,#0
000018  d108              BNE      |L1.44|
;;;77           /* Remember the child which had the focus so we can reactive this child */
;;;78           if (WM__IsAncestor(pInfo->hOld, hWin)) {
00001a  f9b40000          LDRSH    r0,[r4,#0]
00001e  4631              MOV      r1,r6
000020  f7fffffe          BL       WM__IsAncestor
000024  2800              CMP      r0,#0
000026  d001              BEQ      |L1.44|
;;;79             pObj->hFocussedChild = pInfo->hOld;
000028  8820              LDRH     r0,[r4,#0]
00002a  85a8              STRH     r0,[r5,#0x2c]
                  |L1.44|
;;;80           }
;;;81         }
;;;82       }
;;;83     }
00002c  bd70              POP      {r4-r6,pc}
;;;84     
                          ENDP

                  WINDOW_Callback PROC
;;;94     */
;;;95     void WINDOW_Callback(WM_MESSAGE* pMsg) {
00002e  e92d41f0          PUSH     {r4-r8,lr}
000032  4604              MOV      r4,r0
;;;96       WM_HWIN hObj;
;;;97       WINDOW_OBJ* pObj;
;;;98       WM_CALLBACK* cb;
;;;99       hObj = pMsg->hWin;
000034  f9b47004          LDRSH    r7,[r4,#4]
;;;100      pObj = WINDOW_H2P(hObj);
000038  4638              MOV      r0,r7
00003a  f7fffffe          BL       GUI_ALLOC_h2p
00003e  4605              MOV      r5,r0
;;;101      cb   = pObj->cb;
000040  6aae              LDR      r6,[r5,#0x28]
;;;102      switch (pMsg->MsgId) {
000042  6820              LDR      r0,[r4,#0]
;;;103      case WM_HANDLE_DIALOG_STATUS:
;;;104        if (pMsg->Data.p) {                           /* set pointer to Dialog status */
;;;105          pObj->pDialogStatus = (WM_DIALOG_STATUS*)pMsg->Data.p;
;;;106        } else {                                      /* return pointer to Dialog status */
;;;107          pMsg->Data.p = pObj->pDialogStatus;      
;;;108        }
;;;109        return;
;;;110      case WM_SET_FOCUS:
;;;111        if (pMsg->Data.v) {   /* Focus received */
;;;112          if (pObj->hFocussedChild && (pObj->hFocussedChild != hObj)) {
;;;113            WM_SetFocus(pObj->hFocussedChild);
;;;114          } else {
;;;115            pObj->hFocussedChild = WM_SetFocusOnNextChild(hObj);
;;;116          }
;;;117          pMsg->Data.v = 0;   /* Focus change accepted */
;;;118        }
;;;119        return;
;;;120      case WM_GET_ACCEPT_FOCUS:
;;;121        WIDGET_HandleActive(hObj, pMsg);
;;;122        return;
;;;123      case WM_NOTIFY_CHILD_HAS_FOCUS:
;;;124        _OnChildHasFocus(hObj, pObj, pMsg);
;;;125        return;
;;;126      case WM_KEY:
;;;127        if (((const WM_KEY_INFO*)(pMsg->Data.p))->PressedCnt > 0) {
;;;128          int Key = ((const WM_KEY_INFO*)(pMsg->Data.p))->Key;
;;;129          switch (Key) {
;;;130          case GUI_KEY_BACKTAB:
;;;131            pObj->hFocussedChild = WM_SetFocusOnPrevChild(hObj);
;;;132            break;                    /* Send to parent by not doing anything */
;;;133          case GUI_KEY_TAB:
;;;134            pObj->hFocussedChild = WM_SetFocusOnNextChild(hObj);
;;;135            break;                    /* Send to parent by not doing anything */
;;;136          }
;;;137        }
;;;138        break;
;;;139      case WM_PAINT:
;;;140        LCD_SetBkColor(WINDOW__DefaultBkColor);
000044  4949              LDR      r1,|L1.364|
000046  281f              CMP      r0,#0x1f              ;102
000048  d029              BEQ      |L1.158|
00004a  dc06              BGT      |L1.90|
00004c  280e              CMP      r0,#0xe               ;102
00004e  d032              BEQ      |L1.182|
000050  280f              CMP      r0,#0xf               ;102
000052  d043              BEQ      |L1.220|
000054  281e              CMP      r0,#0x1e              ;102
000056  d146              BNE      |L1.230|
000058  e00e              B        |L1.120|
                  |L1.90|
00005a  2820              CMP      r0,#0x20              ;102
00005c  d025              BEQ      |L1.170|
00005e  2822              CMP      r0,#0x22              ;102
000060  d047              BEQ      |L1.242|
000062  282a              CMP      r0,#0x2a              ;102
000064  d13f              BNE      |L1.230|
000066  68a0              LDR      r0,[r4,#8]            ;104
000068  b110              CBZ      r0,|L1.112|
00006a  6328              STR      r0,[r5,#0x30]         ;105
;;;141        GUI_Clear();
;;;142        break;
;;;143      case WM_GET_BKCOLOR:
;;;144        pMsg->Data.Color = WINDOW__DefaultBkColor;
;;;145        return;                       /* Message handled */
;;;146      }  
;;;147      if (cb) {
;;;148        (*cb)(pMsg);
;;;149      } else {
;;;150        WM_DefaultProc(pMsg);
;;;151      }
;;;152    }
00006c  e8bd81f0          POP      {r4-r8,pc}
                  |L1.112|
000070  6b28              LDR      r0,[r5,#0x30]         ;107
000072  60a0              STR      r0,[r4,#8]            ;107
                  |L1.116|
000074  e8bd81f0          POP      {r4-r8,pc}
                  |L1.120|
000078  68a0              LDR      r0,[r4,#8]            ;111
00007a  2800              CMP      r0,#0                 ;111
00007c  d0fa              BEQ      |L1.116|
00007e  f9b5002c          LDRSH    r0,[r5,#0x2c]         ;112
000082  b120              CBZ      r0,|L1.142|
000084  42b8              CMP      r0,r7                 ;112
000086  d002              BEQ      |L1.142|
000088  f7fffffe          BL       WM_SetFocus
00008c  e003              B        |L1.150|
                  |L1.142|
00008e  4638              MOV      r0,r7                 ;115
000090  f7fffffe          BL       WM_SetFocusOnNextChild
000094  85a8              STRH     r0,[r5,#0x2c]         ;115
                  |L1.150|
000096  2000              MOVS     r0,#0                 ;117
000098  60a0              STR      r0,[r4,#8]            ;117
00009a  e8bd81f0          POP      {r4-r8,pc}
                  |L1.158|
00009e  4621              MOV      r1,r4                 ;121
0000a0  4638              MOV      r0,r7                 ;121
0000a2  e8bd41f0          POP      {r4-r8,lr}            ;121
0000a6  f7ffbffe          B.W      WIDGET_HandleActive
                  |L1.170|
0000aa  4622              MOV      r2,r4                 ;124
0000ac  4629              MOV      r1,r5                 ;124
0000ae  4638              MOV      r0,r7                 ;124
0000b0  e8bd41f0          POP      {r4-r8,lr}            ;124
0000b4  e7fe              B        _OnChildHasFocus
                  |L1.182|
0000b6  68a0              LDR      r0,[r4,#8]            ;127
0000b8  6841              LDR      r1,[r0,#4]            ;127
0000ba  2900              CMP      r1,#0                 ;127
0000bc  dd13              BLE      |L1.230|
0000be  6800              LDR      r0,[r0,#0]            ;128
0000c0  2809              CMP      r0,#9                 ;129
0000c2  d006              BEQ      |L1.210|
0000c4  280a              CMP      r0,#0xa               ;129
0000c6  d10e              BNE      |L1.230|
0000c8  4638              MOV      r0,r7                 ;131
0000ca  f7fffffe          BL       WM_SetFocusOnPrevChild
0000ce  85a8              STRH     r0,[r5,#0x2c]         ;131
0000d0  e009              B        |L1.230|
                  |L1.210|
0000d2  4638              MOV      r0,r7                 ;134
0000d4  f7fffffe          BL       WM_SetFocusOnNextChild
0000d8  85a8              STRH     r0,[r5,#0x2c]         ;134
0000da  e004              B        |L1.230|
                  |L1.220|
0000dc  6808              LDR      r0,[r1,#0]            ;140  ; WINDOW__DefaultBkColor
0000de  f7fffffe          BL       LCD_SetBkColor
0000e2  f7fffffe          BL       GUI_Clear
                  |L1.230|
0000e6  b146              CBZ      r6,|L1.250|
0000e8  4620              MOV      r0,r4                 ;148
0000ea  46b4              MOV      r12,r6                ;148
0000ec  e8bd41f0          POP      {r4-r8,lr}            ;148
0000f0  4760              BX       r12                   ;148
                  |L1.242|
0000f2  6808              LDR      r0,[r1,#0]            ;144  ; WINDOW__DefaultBkColor
0000f4  60a0              STR      r0,[r4,#8]            ;144
0000f6  e8bd81f0          POP      {r4-r8,pc}
                  |L1.250|
0000fa  4620              MOV      r0,r4                 ;150
0000fc  e8bd41f0          POP      {r4-r8,lr}            ;150
000100  f7ffbffe          B.W      WM_DefaultProc
;;;153    
                          ENDP

                  WINDOW_CreateIndirect PROC
;;;157    */
;;;158    WM_HWIN WINDOW_CreateIndirect(const GUI_WIDGET_CREATE_INFO* pCreateInfo, WM_HWIN hWinParent, int x0, int y0, WM_CALLBACK* cb) {
000104  e92d41f0          PUSH     {r4-r8,lr}
000108  b084              SUB      sp,sp,#0x10
00010a  4604              MOV      r4,r0
00010c  4688              MOV      r8,r1
00010e  4615              MOV      r5,r2
000110  461e              MOV      r6,r3
000112  9f0a              LDR      r7,[sp,#0x28]
;;;159      WM_HWIN hObj;
;;;160      WM_LOCK();
000114  f7fffffe          BL       GUI_Lock
;;;161      hObj = WM_CreateWindowAsChild(
000118  2314              MOVS     r3,#0x14
00011a  f2af02ed          ADR      r2,WINDOW_Callback + 1
00011e  8a61              LDRH     r1,[r4,#0x12]
000120  f8cd8000          STR      r8,[sp,#0]
000124  9303              STR      r3,[sp,#0xc]
000126  9202              STR      r2,[sp,#8]
000128  9101              STR      r1,[sp,#4]
00012a  f9b4000c          LDRSH    r0,[r4,#0xc]
00012e  f9b43010          LDRSH    r3,[r4,#0x10]
000132  1981              ADDS     r1,r0,r6
000134  f9b4000a          LDRSH    r0,[r4,#0xa]
000138  f9b4200e          LDRSH    r2,[r4,#0xe]
00013c  4428              ADD      r0,r0,r5
00013e  f7fffffe          BL       WM_CreateWindowAsChild
000142  4606              MOV      r6,r0
;;;162        pCreateInfo->x0 + x0, pCreateInfo->y0 + y0, pCreateInfo->xSize, pCreateInfo->ySize, hWinParent,
;;;163        pCreateInfo->Flags, WINDOW_Callback, sizeof(WINDOW_OBJ) - sizeof(WM_Obj));
;;;164      if (hObj) {
000144  b166              CBZ      r6,|L1.352|
;;;165        WINDOW_OBJ* pObj;
;;;166        pObj = WINDOW_H2P(hObj);
000146  4630              MOV      r0,r6
000148  f7fffffe          BL       GUI_ALLOC_h2p
00014c  4605              MOV      r5,r0
;;;167        WIDGET__Init(&pObj->Widget, pCreateInfo->Id, WIDGET_STATE_FOCUSSABLE);
00014e  f9b41008          LDRSH    r1,[r4,#8]
000152  2210              MOVS     r2,#0x10
000154  4628              MOV      r0,r5
000156  f7fffffe          BL       WIDGET__Init
;;;168        pObj->cb             = cb;
00015a  62af              STR      r7,[r5,#0x28]
;;;169        pObj->hFocussedChild = 0;
00015c  2000              MOVS     r0,#0
00015e  85a8              STRH     r0,[r5,#0x2c]
                  |L1.352|
;;;170      }
;;;171      WM_UNLOCK();
000160  f7fffffe          BL       GUI_Unlock
;;;172      return hObj;
;;;173    }
000164  b004              ADD      sp,sp,#0x10
000166  4630              MOV      r0,r6                 ;172
000168  e8bd81f0          POP      {r4-r8,pc}
;;;174    
                          ENDP

                  |L1.364|
                          DCD      ||.data||

                          AREA ||.data||, DATA, ALIGN=2

                  WINDOW__DefaultBkColor
                          DCD      0x00c0c0c0
